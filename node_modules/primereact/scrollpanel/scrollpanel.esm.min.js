import*as e from"react";import{useMountEffect as r,useUnmountEffect as t}from"primereact/hooks";import{mergeProps as n,classNames as l,DomHandler as c}from"primereact/utils";import{ComponentBase as o}from"primereact/componentbase";import{PrimeReactContext as a}from"primereact/api";var u=o.extend({defaultProps:{__TYPE:"ScrollPanel",id:null,style:null,className:null,children:void 0}}),s=e.forwardRef((function(o,s){var i=e.useContext(a),p=u.getProps(o,i),d=u.setMetaData({props:p}).ptm,m=e.useRef(null),f=e.useRef(null),h=e.useRef(null),g=e.useRef(null),v=e.useRef(!1),b=e.useRef(!1),w=e.useRef(null),x=e.useRef(null),E=e.useRef(null),C=e.useRef(null),y=e.useRef(null),R=e.useRef(!1),L=function(){var e=f.current.scrollWidth,r=-1*(m.current.clientHeight-h.current.clientHeight);E.current=f.current.clientWidth/e;var t=f.current.scrollHeight,n=-1*(m.current.clientWidth-g.current.clientWidth);C.current=f.current.clientHeight/t,y.current=window.requestAnimationFrame((function(){E.current>=1?c.addClass(h.current,"p-scrollpanel-hidden"):(c.removeClass(h.current,"p-scrollpanel-hidden"),h.current.style.cssText="width:"+Math.max(100*E.current,10)+"%; left:"+f.current.scrollLeft/e*100+"%;bottom:"+r+"px;"),C.current>=1?c.addClass(g.current,"p-scrollpanel-hidden"):(c.removeClass(g.current,"p-scrollpanel-hidden"),g.current.style.cssText="height:"+Math.max(100*C.current,10)+"%; top: calc("+f.current.scrollTop/t*100+"% - "+h.current.clientHeight+"px);right:"+n+"px;")}))},H=function(e){v.current?F(e):(b.current||F(e),N(e))},F=function(e){var r=e.pageX-w.current;w.current=e.pageX,y.current=window.requestAnimationFrame((function(){f.current.scrollLeft+=r/E.current}))},N=function(e){var r=e.pageY-x.current;x.current=e.pageY,y.current=window.requestAnimationFrame((function(){f.current.scrollTop+=r/C.current}))},T=function e(r){c.removeClass(g.current,"p-scrollpanel-grabbed"),c.removeClass(h.current,"p-scrollpanel-grabbed"),c.removeClass(document.body,"p-scrollpanel-grabbed"),document.removeEventListener("mousemove",H),document.removeEventListener("mouseup",e),v.current=!1,b.current=!1},M=function(){L()};r((function(){var e,r,t;L(),window.addEventListener("resize",L),e=getComputedStyle(m.current),r=getComputedStyle(h.current),t=c.getHeight(m.current)-parseInt(r.height,10),"none"!==e["max-height"]&&0===t&&(m.current.style.height=f.current.offsetHeight+parseInt(r.height,10)>parseInt(e["max-height"],10)?e["max-height"]:f.current.offsetHeight+parseFloat(e.paddingTop)+parseFloat(e.paddingBottom)+parseFloat(e.borderTopWidth)+parseFloat(e.borderBottomWidth)+"px"),R.current=!0})),t((function(){R.current&&window.removeEventListener("resize",L),y.current&&window.cancelAnimationFrame(y.current)})),e.useImperativeHandle(s,(function(){return{props:p,refresh:M,getElement:function(){return m.current},getContent:function(){return f.current},getXBar:function(){return h.current},getYBar:function(){return g.current}}}));var P=n({id:p.id,ref:m,style:p.style,className:l("p-scrollpanel p-component",p.className)},u.getOtherProps(p),d("root")),W=n({className:"p-scrollpanel-wrapper"},d("wrapper")),D=n({className:"p-scrollpanel-content",ref:f,onScroll:L,onMouseEnter:L},d("content")),S=n({ref:h,className:"p-scrollpanel-bar p-scrollpanel-bar-x",onMouseDown:function(e){v.current=!0,w.current=e.pageX,c.addClass(h.current,"p-scrollpanel-grabbed"),c.addClass(document.body,"p-scrollpanel-grabbed"),document.addEventListener("mousemove",H),document.addEventListener("mouseup",T),e.preventDefault()}},d("barx")),Y=n({ref:g,className:"p-scrollpanel-bar p-scrollpanel-bar-y",onMouseDown:function(e){b.current=!0,x.current=e.pageY,c.addClass(g.current,"p-scrollpanel-grabbed"),c.addClass(document.body,"p-scrollpanel-grabbed"),document.addEventListener("mousemove",H),document.addEventListener("mouseup",T),e.preventDefault()}},d("bary"));return e.createElement("div",P,e.createElement("div",W,e.createElement("div",D,p.children)),e.createElement("div",S),e.createElement("div",Y))}));s.displayName="ScrollPanel";export{s as ScrollPanel};
