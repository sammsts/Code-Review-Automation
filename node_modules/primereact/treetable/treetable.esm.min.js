import*as e from"react";import t,{FilterMatchMode as n,ariaLabel as r,localeOption as l,PrimeReactContext as o,FilterService as a}from"primereact/api";import{ComponentBase as i}from"primereact/componentbase";import{ObjectUtils as c,DomHandler as u,classNames as s,mergeProps as f,IconUtils as p}from"primereact/utils";import{useEventListener as d,useUnmountEffect as m,useMountEffect as g}from"primereact/hooks";import{ArrowDownIcon as y}from"primereact/icons/arrowdown";import{ArrowUpIcon as b}from"primereact/icons/arrowup";import{SpinnerIcon as h}from"primereact/icons/spinner";import{Paginator as v}from"primereact/paginator";import{Ripple as C}from"primereact/ripple";import{OverlayService as S}from"primereact/overlayservice";import{ChevronDownIcon as w}from"primereact/icons/chevrondown";import{ChevronRightIcon as E}from"primereact/icons/chevronright";import{CheckIcon as x}from"primereact/icons/check";import{MinusIcon as k}from"primereact/icons/minus";import{InputText as M}from"primereact/inputtext";import{Tooltip as O}from"primereact/tooltip";import{SortAltIcon as P}from"primereact/icons/sortalt";import{SortAmountDownIcon as N}from"primereact/icons/sortamountdown";import{SortAmountUpAltIcon as R}from"primereact/icons/sortamountupalt";function I(){return I=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},I.apply(this,arguments)}function D(e){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},D(e)}function T(e,t){if("object"!==D(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==D(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function K(e){var t=T(e,"string");return"symbol"===D(t)?t:String(t)}function F(e,t,n){return(t=K(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function j(e){if(Array.isArray(e))return z(e)}function A(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function U(e,t){if(e){if("string"==typeof e)return z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?z(e,t):void 0}}function L(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function H(e){return j(e)||A(e)||U(e)||L()}function W(e){if(Array.isArray(e))return e}function G(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,l,o,a,i=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(i.push(r.value),i.length!==t);c=!0);}catch(e){u=!0,l=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw l}}return i}}function B(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function X(e,t){return W(e)||G(e,t)||U(e,t)||B()}var _=i.extend({defaultProps:{__TYPE:"Column",align:null,alignFrozen:"left",alignHeader:null,body:null,bodyClassName:null,bodyStyle:null,cellEditValidator:null,cellEditValidatorEvent:"click",className:null,colSpan:null,columnKey:null,dataType:"text",editor:null,excludeGlobalFilter:!1,expander:!1,exportField:null,exportable:!0,field:null,filter:!1,filterApply:null,filterClear:null,filterElement:null,filterField:null,filterFooter:null,filterFunction:null,filterHeader:null,filterHeaderClassName:null,filterHeaderStyle:null,filterMatchMode:null,filterMatchModeOptions:null,filterMaxLength:null,filterMenuClassName:null,filterMenuStyle:null,filterPlaceholder:null,filterType:"text",footer:null,footerClassName:null,footerStyle:null,frozen:!1,header:null,headerClassName:null,headerStyle:null,headerTooltip:null,headerTooltipOptions:null,hidden:!1,maxConstraints:2,onBeforeCellEditHide:null,onBeforeCellEditShow:null,onCellEditCancel:null,onCellEditComplete:null,onCellEditInit:null,onFilterApplyClick:null,onFilterClear:null,onFilterConstraintAdd:null,onFilterConstraintRemove:null,onFilterMatchModeChange:null,onFilterOperatorChange:null,reorderable:!0,resizeable:!0,rowEditor:!1,rowReorder:!1,rowReorderIcon:null,rowSpan:null,selectionMode:null,showAddButton:!0,showApplyButton:!0,showClearButton:!0,showFilterMatchModes:!0,showFilterMenu:!0,showFilterMenuOptions:!0,showFilterOperator:!0,sortField:null,sortFunction:null,sortable:!1,sortableDisabled:!1,style:null,children:void 0},getCProp:function(e,t){return c.getComponentProp(e,t,_.defaultProps)},getCProps:function(e){return c.getComponentProps(e,_.defaultProps)},getCOtherProps:function(e){return c.getComponentDiffProps(e,_.defaultProps)}}),J=i.extend({defaultProps:{__TYPE:"TreeTable",alwaysShowPaginator:!0,checkboxIcon:null,className:null,columnResizeMode:"fit",contextMenuSelectionKey:null,currentPageReportTemplate:"({currentPage} of {totalPages})",defaultSortOrder:1,emptyMessage:null,expandedKeys:null,filterDelay:300,filterLocale:void 0,filterMode:"lenient",filters:null,first:null,footer:null,footerColumnGroup:null,frozenFooterColumnGroup:null,frozenHeaderColumnGroup:null,frozenWidth:null,globalFilter:null,globalFilterMatchMode:n.CONTAINS,header:null,headerColumnGroup:null,id:null,lazy:!1,loading:!1,loadingIcon:null,metaKeySelection:!0,multiSortMeta:null,onColReorder:null,onCollapse:null,onColumnResizeEnd:null,onContextMenu:null,onContextMenuSelectionChange:null,onExpand:null,onFilter:null,onPage:null,onRowClick:null,onRowMouseEnter:null,onRowMouseLeave:null,onSelect:null,onSelectionChange:null,onSort:null,onToggle:null,onUnselect:null,pageLinkSize:5,paginator:!1,paginatorClassName:null,paginatorDropdownAppendTo:null,paginatorLeft:null,paginatorPosition:"bottom",paginatorRight:null,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown",propagateSelectionDown:!0,propagateSelectionUp:!0,removableSort:!1,reorderableColumns:!1,reorderIndicatorDownIcon:null,reorderIndicatorUpIcon:null,resizableColumns:!1,rowClassName:null,rowHover:!1,rows:null,rowsPerPageOptions:null,scrollHeight:null,scrollable:!1,selectOnEdit:!0,selectionKeys:null,selectionMode:null,showGridlines:!1,sortField:null,sortMode:"single",sortIcon:null,sortOrder:null,stripedRows:!1,style:null,tabIndex:0,tableClassName:null,tableStyle:null,totalRecords:null,value:null,children:void 0}}),V=function(t){var n=X(e.useState(!1),2),r=n[0],l=n[1],o=e.useRef(null),a=e.useRef(null),i=e.useRef(!1),p=e.useRef(null),g=e.useRef(null),y=function(e){var n=_.getCProps(t.column);return t.ptCallbacks.ptmo(_.getCProp(t.column,"pt"),e,{props:n,parent:t.metaData,state:{editing:r}})},b=X(d({type:"click",listener:function(e){!i.current&&w(e.target)&&x(e),i.current=!1}}),2),h=b[0],v=b[1],C=function(){t.editor&&!r&&(t.selectOnEdit||!t.selectOnEdit&&t.selected)&&(i.current=!0,l(!0),h(),p.current=function(e){w(e.target)||(i.current=!0)},S.on("overlay-click",p.current))},w=function(e){return o.current&&!(o.current.isSameNode(e)||o.current.contains(e))},E=function(){setTimeout((function(){l(!1),v(),S.off("overlay-click",p.current),p.current=null}),1)},x=function(e){t.cellEditValidator?t.cellEditValidator({originalEvent:e,columnProps:t})&&E():E()};e.useEffect((function(){if(o.current&&t.editor)if(clearTimeout(g.current),r){var e=u.findSingle(o.current,"input");e&&document.activeElement!==e&&!e.hasAttribute("data-isCellEditing")&&(e.setAttribute("data-isCellEditing",!0),e.focus()),a.current.tabIndex=-1}else g.current=setTimeout((function(){a.current&&a.current.setAttribute("tabindex",0)}),50)})),m((function(){p.current&&(S.off("overlay-click",p.current),p.current=null)}));var k,M=c.getPropValue(t.bodyClassName,t.node.data,{field:t.field,rowIndex:t.rowIndex,props:t}),O=s(M||t.className,{"p-editable-column":t.editor,"p-cell-editing":!!t.editor&&r}),P=t.bodyStyle||t.style;if(r){if(!t.editor)throw new Error("Editor is not found on column.");k=c.getJSXElement(t.editor,{node:t.node,rowData:t.node.data,value:c.resolveFieldData(t.node.data,t.field),field:t.field,rowIndex:t.rowIndex,props:t})}else k=t.body?c.getJSXElement(t.body,t.node,{field:t.field,rowIndex:t.rowIndex,props:t}):c.resolveFieldData(t.node.data,t.field);var N=f({tabIndex:0,ref:a,className:"p-cell-editor-key-helper p-hidden-accessible",onFocus:function(e){C()}},y("editorKeyHelperLabel")),R=f(y("editorKeyHelper")),I=t.editor&&e.createElement("a",N,e.createElement("span",R)),D=f({ref:o,className:O,style:P,onClick:function(e){return C()},onKeyDown:function(e){var t;13!==(t=e).which&&9!==t.which||x(t)}},y("bodyCell"),y("root"));return e.createElement("td",D,t.children,I,k)};function Y(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=$(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,l=function(){};return{s:l,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:l}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){i=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(i)throw o}}}}function $(e,t){if(e){if("string"==typeof e)return q(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?q(e,t):void 0}}function q(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(n),!0).forEach((function(t){F(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}V.displayName="TreeTableBodyCell";var ee=e.memo((function(t){var n=e.useRef(null),l=e.useRef(null),o=e.useRef(null),a=e.useRef(!1),i=!!t.expandedKeys&&void 0!==t.expandedKeys[t.node.key],d=function(e){return _.getCProps(e)},m=function(e,n){return t.ptCallbacks.ptmo(_.getCProp(e,"pt"),n,{props:d(e),parent:t.metaData})},g=function(e,n){return t.ptCallbacks.ptmo(_.getCProp(e,"pt"),n,{props:d(e),parent:t.metaData,context:{checked:T(),partialChecked:K()}})},y=function(e,t){return _.getCProp(e,t)},b=function(e){i?v(e):h(e),e.preventDefault(),e.stopPropagation()},h=function(e){var n=t.expandedKeys?Z({},t.expandedKeys):{};n[t.node.key]=!0,t.onToggle({originalEvent:e,value:n}),S(e,!0)},v=function(e){var n=Z({},t.expandedKeys);delete n[t.node.key],t.onToggle({originalEvent:e,value:n}),S(e,!1)},S=function(e,n){n?t.onExpand&&t.onExpand({originalEvent:e,node:t.node}):t.onCollapse&&t.onCollapse({originalEvent:e,node:t.node})},M=function(e){t.onRowClick&&t.onRowClick(e,t.node),a.current=!1},O=function(e){var n=T(),r=t.selectionKeys?Z({},t.selectionKeys):{};n?(t.propagateSelectionDown?N(t.node,!1,r):delete r[t.node.key],t.propagateSelectionUp&&t.onPropagateUp&&t.onPropagateUp({originalEvent:e,check:!1,selectionKeys:r}),t.onUnselect&&t.onUnselect({originalEvent:e,node:t.node})):(t.propagateSelectionDown?N(t.node,!0,r):r[t.node.key]={checked:!0},t.propagateSelectionUp&&t.onPropagateUp&&t.onPropagateUp({originalEvent:e,check:!0,selectionKeys:r}),t.onSelect&&t.onSelect({originalEvent:e,node:t.node})),t.onSelectionChange&&t.onSelectionChange({originalEvent:e,value:r}),u.clearSelection()},P=function(e){var n,r=e.check,l=e.selectionKeys,o=0,a=!1,i=Y(t.node.children);try{for(i.s();!(n=i.n()).done;){var c=n.value;l[c.key]&&l[c.key].checked?o++:l[c.key]&&l[c.key].partialChecked&&(a=!0)}}catch(e){i.e(e)}finally{i.f()}r&&o===t.node.children.length?l[t.node.key]={checked:!0,partialChecked:!1}:(r||delete l[t.node.key],l[t.node.key]=a||o>0&&o!==t.node.children.length?{checked:!1,partialChecked:!0}:{checked:!1,partialChecked:!1}),t.propagateSelectionUp&&t.onPropagateUp&&t.onPropagateUp(e)},N=function e(t,n,r){if(n?r[t.key]={checked:!0,partialChecked:!1}:delete r[t.key],t.children&&t.children.length)for(var l=0;l<t.children.length;l++)e(t.children[l],n,r)},R=function(e){if(e.target===n.current){var t=e.currentTarget;switch(e.which){case 40:var r=t.nextElementSibling;r&&r.focus(),e.preventDefault();break;case 38:var l=t.previousElementSibling;l&&l.focus(),e.preventDefault();break;case 39:i||h(e),e.preventDefault();break;case 37:i&&v(e),e.preventDefault();break;case 13:M(e),e.preventDefault()}}},D=function(){return!("single"!==t.selectionMode&&"multiple"!==t.selectionMode||!t.selectionKeys)&&("single"===t.selectionMode?t.selectionKeys===t.node.key:void 0!==t.selectionKeys[t.node.key])},T=function(){return!!t.selectionKeys&&(t.selectionKeys[t.node.key]&&t.selectionKeys[t.node.key].checked)},K=function(){return!!t.selectionKeys&&(t.selectionKeys[t.node.key]&&t.selectionKeys[t.node.key].partialChecked)},F=function(n){var l=r(i?"collapseLabel":"expandLabel"),o=f({className:"p-treetable-toggler-icon","aria-hidden":!0},m(n,"rowTogglerIcon")),a=p.getJSXIcon(t.togglerIcon||e.createElement(i?w:E,o),Z({},o),{props:t}),u={marginLeft:16*t.level+"px",visibility:!1===t.node.leaf||t.node.children&&t.node.children.length?"visible":"hidden"},s=f({type:"button",className:"p-treetable-toggler p-link p-unselectable-text",onClick:function(e){return b(e)},tabIndex:-1,style:u,"aria-label":l},m(n,"rowToggler")),d=e.createElement("button",s,a,e.createElement(C,null));t.togglerTemplate&&(d=c.getJSXElement(t.togglerTemplate,t.node,{onClick:b,containerClassName:"p-treetable-toggler p-link",iconClassName:"p-treetable-toggler-icon",element:d,props:t,expanded:i,buttonStyle:u}));return d},z=function(n){if("checkbox"===t.selectionMode&&!1!==t.node.selectable){var r=T(),a=K(),i=s("p-checkbox-box",{"p-highlight":r,"p-indeterminate":a}),c="p-checkbox-icon p-c",d=f({className:c},g(n,"checkboxIcon")),m=p.getJSXIcon(r?t.checkboxIcon||e.createElement(x,d):a?t.checkboxIcon||e.createElement(k,d):null,{className:c},{props:t,checked:r,partialChecked:a}),y=f({type:"checkbox",onFocus:function(e){return u.addClass(o.current,"p-focus"),void u.addClass(l.current,"p-checkbox-focused")},onBlur:function(e){return u.removeClass(o.current,"p-focus"),void u.removeClass(l.current,"p-checkbox-focused")}},g(n,"hiddenInput")),b=f({className:"p-checkbox p-treetable-checkbox p-component",ref:l,onClick:function(e){return O(e)},role:"checkbox","aria-checked":r},g(n,"checkboxWrapper")),h=f({className:"p-hidden-accessible"},g(n,"hiddenInputWrapper")),v=f({className:i,ref:o},g(n,"checkbox"));return e.createElement("div",b,e.createElement("div",h,e.createElement("input",y)),e.createElement("div",v,m))}return null},j=t.columns.map((function(n,r){var l,o;return y(n,"expander")&&(l=F(n),o=z(n)),e.createElement(V,I({key:"".concat(y(n,"columnKey")||y(n,"field"),"_").concat(r)},_.getCProps(n),{column:n,selectOnEdit:t.selectOnEdit,selected:D(),node:t.node,rowIndex:t.rowIndex,ptCallbacks:t.ptCallbacks,metaData:t.metaData}),l,o)})),A=i&&t.node.children?t.node.children.map((function(n,r){return e.createElement(ee,{key:"".concat(n.key||JSON.stringify(n.data),"_").concat(r),level:t.level+1,rowIndex:t.rowIndex+"_"+r,node:n,checkboxIcon:t.checkboxIcon,columns:t.columns,expandedKeys:t.expandedKeys,selectOnEdit:t.selectOnEdit,onToggle:t.onToggle,togglerTemplate:t.togglerTemplate,onExpand:t.onExpand,onCollapse:t.onCollapse,selectionMode:t.selectionMode,selectionKeys:t.selectionKeys,onSelectionChange:t.onSelectionChange,metaKeySelection:t.metaKeySelection,onRowClick:t.onRowClick,onRowMouseEnter:t.onRowMouseEnter,onRowMouseLeave:t.onRowMouseLeave,onSelect:t.onSelect,onUnselect:t.onUnselect,propagateSelectionUp:t.propagateSelectionUp,propagateSelectionDown:t.propagateSelectionDown,onPropagateUp:P,rowClassName:t.rowClassName,contextMenuSelectionKey:t.contextMenuSelectionKey,onContextMenuSelectionChange:t.onContextMenuSelectionChange,onContextMenu:t.onContextMenu,ptCallbacks:t.ptCallbacks,metaData:t.metaData})})):null,U={"p-highlight":D(),"p-highlight-contextmenu":t.contextMenuSelectionKey&&t.contextMenuSelectionKey===t.node.key,"p-row-odd":t.rowIndex%2!=0};if(t.rowClassName){var L=t.rowClassName(t.node);U=Z(Z({},U),L)}U=s(U,t.node.className);var H=f({ref:n,tabIndex:0,className:U,style:t.node.style,onClick:function(e){return M(e)},onTouchEnd:function(e){a.current=!0},onContextMenu:function(e){return n=e,u.clearSelection(),t.onContextMenuSelectionChange&&t.onContextMenuSelectionChange({originalEvent:n,value:t.node.key}),void(t.onContextMenu&&t.onContextMenu({originalEvent:n,node:t.node}));var n},onKeyDown:function(e){return R(e)},onMouseEnter:function(e){return n=e,void(t.onRowMouseEnter&&t.onRowMouseEnter({originalEvent:n,node:t.node,index:t.rowIndex}));var n},onMouseLeave:function(e){return n=e,void(t.onRowMouseLeave&&t.onRowMouseLeave({originalEvent:n,node:t.node,index:t.rowIndex}));var n}},t.ptCallbacks.ptm("row"));return e.createElement(e.Fragment,null,e.createElement("tr",H,j),A)}));function te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?te(Object(n),!0).forEach((function(t){F(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):te(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function re(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=le(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,l=function(){};return{s:l,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:l}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){i=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(i)throw o}}}}function le(e,t){if(e){if("string"==typeof e)return oe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?oe(e,t):void 0}}function oe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}ee.displayName="TreeTableRow";var ae=e.memo((function(t){var n="single"===t.selectionMode,r="multiple"===t.selectionMode,o=function e(n){var r,l=[],o=re(n=n||t.value);try{for(o.s();!(r=o.n()).done;){var i=r.value;l.push(i.key),a(i.key)&&(l=l.concat(e(i.children)))}}catch(e){o.e(e)}finally{o.f()}return l},a=function(e){return t.expandedKeys&&!!t.expandedKeys[e]},i=function(e,l){t.onRowClick&&t.onRowClick({originalEvent:e,node:l});var a=e.target.nodeName;if("INPUT"!==a&&"BUTTON"!==a&&"A"!==a&&!u.hasClass(e.target,"p-clickable")&&(n||r)&&!1!==l.selectable){var i,s=c(l),f=t.metaKeySelection,p=o(),d=p.findIndex((function(e){return e===l.key}));if(r&&e.shiftKey){u.clearSelection();var m=p.findIndex((function(e){return t.selectionKeys[e]})),g=Math.min(d,m),y=Math.max(d,m);i=ne({},t.selectionKeys);for(var b=g;b<=y;b++){i[p[b]]=!0}}else if(f){var h=e.metaKey||e.ctrlKey;s&&h?(n?i=null:delete(i=ne({},t.selectionKeys))[l.key],t.onUnselect&&t.onUnselect({originalEvent:e,node:l})):(n?i=l.key:r&&((i=h&&t.selectionKeys?ne({},t.selectionKeys):{})[l.key]=!0),t.onSelect&&t.onSelect({originalEvent:e,node:l}))}else n?s?(i=null,t.onUnselect&&t.onUnselect({originalEvent:e,node:l})):(i=l.key,t.onSelect&&t.onSelect({originalEvent:e,node:l})):s?(delete(i=ne({},t.selectionKeys))[l.key],t.onUnselect&&t.onUnselect({originalEvent:e,node:l})):((i=t.selectionKeys?ne({},t.selectionKeys):{})[l.key]=!0,t.onSelect&&t.onSelect({originalEvent:e,node:l}));t.onSelectionChange&&t.onSelectionChange({originalEvent:e,value:i})}},c=function(e){return!(!n&&!r||!t.selectionKeys)&&(n?t.selectionKeys===e.key:void 0!==t.selectionKeys[e.key])},s=function(n,r){return e.createElement(ee,{key:"".concat(n.key||JSON.stringify(n.data),"_").concat(r),level:0,rowIndex:r,selectOnEdit:t.selectOnEdit,node:n,checkboxIcon:t.checkboxIcon,columns:t.columns,expandedKeys:t.expandedKeys,onToggle:t.onToggle,togglerTemplate:t.togglerTemplate,onExpand:t.onExpand,onCollapse:t.onCollapse,selectionMode:t.selectionMode,selectionKeys:t.selectionKeys,onSelectionChange:t.onSelectionChange,metaKeySelection:t.metaKeySelection,onRowClick:i,onRowMouseEnter:t.onRowMouseEnter,onRowMouseLeave:t.onRowMouseLeave,onSelect:t.onSelect,onUnselect:t.onUnselect,propagateSelectionUp:t.propagateSelectionUp,propagateSelectionDown:t.propagateSelectionDown,rowClassName:t.rowClassName,contextMenuSelectionKey:t.contextMenuSelectionKey,onContextMenuSelectionChange:t.onContextMenuSelectionChange,onContextMenu:t.onContextMenu,ptCallbacks:t.ptCallbacks,metaData:t.metaData})},p=t.value&&t.value.length?function(){if(t.paginator&&!t.lazy){for(var e=t.first||0,n=e+(t.rows||0),r=[],l=e;l<n;l++){if(!t.value[l])break;r.push(s(t.value[l]))}return r}return t.value.map(s)}():function(){if(t.loading)return null;var n=t.columns?t.columns.length:null,r=t.emptyMessage||l("emptyMessage"),o=f({className:"p-treetable-emptymessage"},t.ptCallbacks.ptm("emptyMessage")),a=f({colSpan:n},t.ptCallbacks.ptm("bodyCell"));return e.createElement("tr",o,e.createElement("td",a,r))}(),d=f({className:"p-treetable-tbody"},t.ptCallbacks.ptm("tbody"));return e.createElement("tbody",d,p)}));ae.displayName="TreeTableBody";var ie=i.extend({defaultProps:{__TYPE:"ColumnGroup",children:void 0},getCProp:function(e,t){return c.getComponentProp(e,t,ie.defaultProps)},getCProps:function(e){return c.getComponentProps(e,ie.defaultProps)}}),ce=i.extend({defaultProps:{__TYPE:"Row",style:null,className:null,children:void 0},getCProp:function(e,t){return c.getComponentProp(e,t,ce.defaultProps)}}),ue=e.memo((function(t){var n=function(e,t){return _.getCProp(e,t)},r=function(e){return t.ptCallbacks.ptmo(_.getCProps(e))},l=function(e,l){return t.ptCallbacks.ptmo(n(e,"pt"),l,{props:r(e),parent:t.metaData})},o=function(t,r){var o=f({key:t.field||r,className:n(t,"footerClassName")||n(t,"className"),style:n(t,"footerStyle")||n(t,"style"),rowSpan:n(t,"rowSpan"),colSpan:n(t,"colSpan")},l(t,"footerCell"));return e.createElement("td",o,n(t,"footer"))},a=function(n,r){var l=e.Children.toArray(ce.getCProp(n,"children")).map(o),a=f(t.ptCallbacks.ptm("footerRow"));return e.createElement("tr",I({},a,{key:r}),l)},i=t.columnGroup?e.Children.toArray(ie.getCProp(t.columnGroup,"children")).map(a):function(n){if(n){var r=n.map(o),l=f(t.ptCallbacks.ptm("footerRow"));return e.createElement("tr",l,r)}return null}(t.columns);if(function(){if(t.columnGroup)return!0;for(var e=0;e<t.columns.length;e++)if(n(t.columns[e],"footer"))return!0;return!1}()){var c=f({className:"p-treetable-tfoot"},t.ptCallbacks.ptm("tfoot"));return e.createElement("tfoot",c,i)}return null}));function se(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=fe(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,l=function(){};return{s:l,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:l}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){i=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(i)throw o}}}}function fe(e,t){if(e){if("string"==typeof e)return pe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?pe(e,t):void 0}}function pe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}ue.displayName="TreeTableFooter";var de=e.memo((function(t){var n=e.useRef(null),r=function(e){return t.ptCallbacks.ptmo(_.getCProps(e))},l=function(e,n){return t.ptCallbacks.ptmo(_.getCProp(e,"pt"),n,{props:r(e),parent:t.metaData})},o=function(e,n){if(w(n,"sortable")){var r=e.target;(u.hasClass(r,"p-sortable-column")||u.hasClass(r,"p-column-title")||u.hasClass(r,"p-sortable-column-icon")||u.hasClass(r.parentElement,"p-sortable-column-icon"))&&(t.onSort({originalEvent:e,sortField:w(n,"sortField")||w(n,"field"),sortFunction:w(n,"sortFunction"),sortable:w(n,"sortable")}),u.clearSelection())}},a=function(e,n){t.reorderableColumns&&w(n,"reorderable")&&("INPUT"!==e.target.nodeName?e.currentTarget.draggable=!0:"INPUT"===e.target.nodeName&&(e.currentTarget.draggable=!1))},i=function(e,t){"Enter"===e.key&&(o(e,t),e.preventDefault())},d=function(e){if(t.multiSortMeta)for(var n=0;n<t.multiSortMeta.length;n++)if(t.multiSortMeta[n].field===w(e,"field"))return n;return-1},m=function(e,n){t.resizableColumns&&t.onResizeStart&&t.onResizeStart({originalEvent:e,columnEl:e.target.parentElement,column:n})},g=function(e,n){t.onDragStart&&t.onDragStart({originalEvent:e,column:n})},y=function(e,n){t.onDragOver&&t.onDragOver({originalEvent:e,column:n})},b=function(e,n){t.onDragLeave&&t.onDragLeave({originalEvent:e,column:n})},h=function(e,n){t.onDrop&&t.onDrop({originalEvent:e,column:n})},v=function(e,r){if(w(r,"filter")&&t.onFilter){n.current&&clearTimeout(n.current);var l=e.target.value;n.current=setTimeout((function(){t.onFilter({value:l,field:w(r,"field"),matchMode:w(r,"filterMatchMode")||"startsWith"}),n.current=null}),t.filterDelay)}},C=function(e){if(e){var t,n=se(e);try{for(n.s();!(t=n.n()).done;){if(w(t.value,"filter"))return!0}}catch(e){n.e(e)}finally{n.f()}}return!1},S=function(e,t,n){return w(e,"sortable")?t&&n<0?"descending":t&&n>0?"ascending":"none":null},w=function(e){return e?"string"==typeof(arguments.length<=1?void 0:arguments[1])?_.getCProp(e,arguments.length<=1?void 0:arguments[1]):_.getCProp((arguments.length<=1?void 0:arguments[1])||e,arguments.length<=2?void 0:arguments[2]):null},E=function(n,r,o){if(w(n,"sortable")){var a="p-sortable-column-icon",i=f({className:a},l(n,"sortIcon"));return p.getJSXIcon(t.sortIcon||e.createElement(r?o<0?N:R:P,i),{className:a},{props:t,sorted:r,sortOrder:o})}return null},x=function(n){if(t.resizableColumns){var r=f({className:"p-column-resizer p-clickable",onMouseDown:function(e){return m(e,n)}},l(n,"columnResizer"));return e.createElement("span",r)}return null},k=function(n,r){if(-1!==r&&t.multiSortMeta&&t.multiSortMeta.length>1){var o=f({className:"p-sortable-column-badge"},l(n,"sortBadge"));return e.createElement("span",o,r+1)}return null},D=function(t,n){var r=c.getJSXElement(w(t,"header"),{props:n}),o=f({className:"p-column-title"},l(t,"headerTitle"));return e.createElement("span",o,r)},T=function(n,r){var u;if(w(n,"filter")&&r.renderFilter&&(u=w(n,"filterElement")||e.createElement(M,{onInput:function(e){return v(e,n)},type:t.filterType,defaultValue:t.filters&&t.filters[w(n,"field")]?t.filters[w(n,"field")].value:null,className:"p-column-filter",placeholder:w(n,"filterPlaceholder"),maxLength:w(n,"filterMaxLength"),pt:l(n,"filterInput")})),r.filterOnly){var p=f({key:w(n,"columnKey")||w(n,"field")||r.index,className:s("p-filter-column",w(n,"filterHeaderClassName")),style:w(n,"filterHeaderStyle")||w(n,"style"),rowSpan:w(n,"rowSpan"),colSpan:w(n,"colSpan")},l(n,"headerCell"),l(n,"root"));return e.createElement("th",p,u)}var m=e.createRef(null),C=d(n),P=-1!==C?t.multiSortMeta[C]:null,N=w(n,"field")===t.sortField,R=null!==P,T=w(n,"sortable")&&(N||R),K=0;N?K=t.sortOrder:R&&(K=P.order);var F=E(n,T,K),z=S(n,T,K),j=k(n,C),A=s(w(n,"headerClassName")||w(n,"className"),{"p-sortable-column":w(n,"sortable"),"p-highlight":T,"p-resizable-column":t.resizableColumns&&w(n,"resizeable")}),U=w(n,"headerTooltip"),L=c.isNotEmpty(U),H=D(n,r),W=x(n),G=f({ref:m,className:A,style:w(n,"headerStyle")||w(n,"style"),tabIndex:w(n,"sortable")?t.tabIndex:null,onClick:function(e){return o(e,n)},onMouseDown:function(e){return a(e,n)},onKeyDown:function(e){return i(e,n)},rowSpan:w(n,"rowSpan"),colSpan:w(n,"colSpan"),"aria-sort":z,onDragStart:function(e){return g(e,n)},onDragOver:function(e){return y(e,n)},onDragLeave:function(e){return b(e,n)},onDrop:function(e){return h(e,n)}},l(n,"headerCell"),l(n,"root"));return e.createElement(e.Fragment,{key:n.columnKey||n.field||r.index},e.createElement("th",G,W,H,F,j,u),L&&e.createElement(O,I({target:m,content:U},w(n,"headerTooltipOptions"))))},K=function(n,r){var l=e.Children.toArray(ce.getCProp(n,"children")).map((function(e,t){return T(e,{index:t,filterOnly:!1,renderFilter:!0})})),o=f(t.ptCallbacks.ptm("headerRow"));return e.createElement("tr",I({},o,{key:r}),l)},F=t.columnGroup?e.Children.toArray(ie.getCProp(t.columnGroup,"children")).map(K):function(n){if(n){var r=f(t.ptCallbacks.ptm("headerRow"));return C(n)?e.createElement(e.Fragment,null,e.createElement("tr",r,n.map((function(e,t){return T(e,{index:t,filterOnly:!1,renderFilter:!1})}))),e.createElement("tr",r,n.map((function(e,t){return T(e,{index:t,filterOnly:!0,renderFilter:!0})})))):e.createElement("tr",r,n.map((function(e,t){return T(e,{index:t,filterOnly:!1,renderFilter:!1})})))}return null}(t.columns),z=f({className:"p-treetable-thead"},t.ptCallbacks.ptm("thead"));return e.createElement("thead",z,F)}));de.displayName="TreeTableHeader";var me=e.memo((function(t){var n=e.useRef(null),r=e.useRef(null),l=e.useRef(null),o=e.useRef(null),a=e.useRef(null),i=e.useRef(null),p=e.useRef(null),d=function(){if(t.scrollHeight)if(-1!==t.scrollHeight.indexOf("%")){var e=m(n.current);o.current.style.visibility="hidden",o.current.style.height="100px";var r=u.getOuterHeight(e),l=u.getOuterHeight(e.parentElement)*parseInt(t.scrollHeight,10)/100-(r-100);o.current.style.height="auto",o.current.style.maxHeight=l+"px",o.current.style.visibility="visible"}else o.current.style.maxHeight=t.scrollHeight},m=function(e){if(e){for(var t=e;t&&!u.hasClass(t,"p-treetable");)t=t.parentElement;return t}return null};g((function(){if(t.frozen)o.current.style.paddingBottom=u.calculateScrollbarWidth()+"px";else{var e=u.calculateScrollbarWidth();l.current.style.marginRight=e+"px",p.current&&(p.current.style.marginRight=e+"px")}})),e.useEffect((function(){d()}));var y=s("p-treetable-scrollable-view",{"p-treetable-frozen-view":t.frozen,"p-treetable-unfrozen-view":!t.frozen&&t.frozenWidth}),b=t.frozen?t.frozenWidth:"calc(100% - "+t.frozenWidth+")",h=t.frozen?null:t.frozenWidth,v=function(){if(c.isNotEmpty(t.columns)){var n=t.columns.map((function(t,n){return e.createElement("col",{key:t.field+"_"+n})})),r=f({className:"p-treetable-scrollable-colgroup"},t.ptCallbacks.ptm("scrollableColgroup"));return e.createElement("colgroup",r,n)}return null}(),C=!t.frozen&&t.scrollHeight?{overflowY:"scroll"}:null,S=f({className:y,style:{width:b,left:h},ref:n},t.ptCallbacks.ptm("scrollable")),w=f({className:"p-treetable-scrollable-header",ref:r,onScroll:function(e){r.current.scrollLeft=0}},t.ptCallbacks.ptm("scrollableHeader")),E=f({className:"p-treetable-scrollable-header-box",ref:l},t.ptCallbacks.ptm("scrollableHeaderBox")),x=f({className:"p-treetable-scrollable-header-table"},t.ptCallbacks.ptm("scrollableHeaderTable")),k=f({className:"p-treetable-scrollable-body",ref:o,style:C,onScroll:function(e){return(r=n.current.previousElementSibling)&&(t=u.findSingle(r,".p-treetable-scrollable-body")),l.current.style.marginLeft=-1*o.current.scrollLeft+"px",p.current&&(p.current.style.marginLeft=-1*o.current.scrollLeft+"px"),void(t&&(t.scrollTop=o.current.scrollTop));var t,r}},t.ptCallbacks.ptm("scrollableBody")),M=f({ref:a,style:{top:"0"},className:"p-treetable-scrollable-body-table"},t.ptCallbacks.ptm("scrollableBodyTable")),O=f({className:"p-treetable-scrollable-footer",ref:i},t.ptCallbacks.ptm("scrollableFooter")),P=f({className:"p-treetable-scrollable-footer-box",ref:p},t.ptCallbacks.ptm("scrollableFooterBox")),N=f({className:"p-treetable-scrollable-footer-table"},t.ptCallbacks.ptm("scrollableFooterTable"));return e.createElement("div",S,e.createElement("div",w,e.createElement("div",E,e.createElement("table",x,v,t.header))),e.createElement("div",k,e.createElement("table",M,v,t.body)),e.createElement("div",O,e.createElement("div",P,e.createElement("table",N,v,t.footer))))}));function ge(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=ye(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,l=function(){};return{s:l,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:l}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){i=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(i)throw o}}}}function ye(e,t){if(e){if("string"==typeof e)return be(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?be(e,t):void 0}}function be(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function he(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ve(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?he(Object(n),!0).forEach((function(t){F(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):he(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}me.displayName="TreeTableScrollableView";var Ce=e.forwardRef((function(n,r){var l=e.useContext(o),i=J.getProps(n,l),m=X(e.useState(i.expandedKeys),2),g=m[0],C=m[1],S=X(e.useState(i.first),2),w=S[0],E=S[1],x=X(e.useState(i.rows),2),k=x[0],M=x[1],O=X(e.useState(i.sortField),2),P=O[0],N=O[1],R=X(e.useState(i.sortOrder),2),D=R[0],T=R[1],K=X(e.useState(i.multiSortMeta),2),F=K[0],z=K[1],j=X(e.useState(i.filters),2),A=j[0],U=j[1],L=X(e.useState([]),2),W=L[0],G=L[1],B={props:i,state:{expandedKeys:g,first:w,rows:k,sortField:P,sortOrder:D,multiSortMeta:F,filters:A,columnOrder:W}},V=J.setMetaData(B),Y=e.useRef(null),$=e.useRef(null),q=e.useRef(null),Q=e.useRef(null),Z=e.useRef(null),ee=e.useRef(null),te=e.useRef(null),ne=e.useRef(null),re=e.useRef(0),le=e.useRef(0),oe=e.useRef(0),ie=e.useRef(null),ce=e.useRef(null),se=e.useRef(null),fe=e.useRef(null),pe=e.useRef(null),ye=e.useRef(null),be=X(d({type:"mousemove",listener:function(e){ee.current&&He(e)}}),2),he=be[0],Se=be[1],we=X(d({type:"mouseup",listener:function(e){ee.current&&(ee.current=!1,We())}}),2),Ee=we[0],xe=we[1],ke=function(e){i.onToggle?i.onToggle(e):C(e.value)},Me=function(e){i.onPage?i.onPage(e):(E(e.first),M(e.rows))},Oe=function(e){var t,n,r=e.sortField,l=i.defaultSortOrder;if(fe.current=e.sortable,pe.current=e.sortFunction,ye.current=e.sortField,"multiple"===i.sortMode){var o=e.originalEvent.metaKey||e.originalEvent.ctrlKey;if((t=H(rt()))&&t instanceof Array){var a=t.find((function(e){return e.field===r}));l=a?Pe(a.order):l}var c={field:r,order:l};l?(t&&o||(t=[]),Ne(c,t)):i.removableSort&&t&&Re(c,t),n={multiSortMeta:t}}else l=tt()===r?Pe(nt()):l,i.removableSort&&(r=l?r:null),n={sortField:r,sortOrder:l};i.onSort?i.onSort(n):(E(0),N(n.sortField),T(n.sortOrder),z(n.multiSortMeta))},Pe=function(e){return i.removableSort?i.defaultSortOrder===e?-1*e:0:-1*e},Ne=function(e,t){for(var n=-1,r=0;r<t.length;r++)if(t[r].field===e.field){n=r;break}n>=0?t[n]=e:t.push(e)},Re=function(e,t){for(var n=-1,r=0;r<t.length;r++)if(t[r].field===e.field){n=r;break}n>=0&&t.splice(n,1),t=t.length>0?t:null},Ie=function(e){return De(e)},De=function e(t){var n=H(t);if(fe.current&&"custom"===fe.current&&pe.current)n=pe.current({data:t,field:tt(),order:nt()});else{n.sort((function(e,t){var n=tt(),r=c.resolveFieldData(e.data,n),l=c.resolveFieldData(t.data,n);return ze(r,l,nt())}));for(var r=0;r<n.length;r++)n[r].children&&n[r].children.length&&(n[r].children=e(n[r].children))}return n},Te=function(e){var t=rt();return t?Ke(e,t):e},Ke=function e(t,n){var r=H(t);r.sort((function(e,t){return Fe(e,t,n,0)}));for(var l=0;l<r.length;l++)r[l].children&&r[l].children.length&&(r[l].children=e(r[l].children,n));return r},Fe=function e(n,r,o,a){var i=c.resolveFieldData(n.data,o[a].field),u=c.resolveFieldData(r.data,o[a].field);return 0===c.compare(i,u,l&&l.locale||t.locale)?o.length-1>a?e(n,r,o,a+1):0:ze(i,u,o[a].order)},ze=function(e,n,r){return c.sort(e,n,r,l&&l.locale||t.locale,l&&l.nullSortOrder||t.nullSortOrder)},je=function(e,t,n){Ae({value:e,field:t,matchMode:n})},Ae=function(e){var t=lt(),n=t?ve({},t):{};Ue(e.value)?n[e.field]&&delete n[e.field]:n[e.field]={value:e.value,matchMode:e.matchMode},i.onFilter?i.onFilter({filters:n}):(E(0),U(n))},Ue=function(e){return null==e||("string"==typeof e&&0===e.trim().length||e instanceof Array&&0===e.length)},Le=function(e){var t=u.getOffset(Y.current).left;te.current=e.columnEl,ne.current=e.column,ee.current=!0,re.current=e.originalEvent.pageX-t+Y.current.scrollLeft,Xe()},He=function(e){var t=u.getOffset(Y.current).left;u.addClass(Y.current,"p-unselectable-text"),q.current.style.height=Y.current.offsetHeight+"px",q.current.style.top="0px",q.current.style.left=e.pageX-t+Y.current.scrollLeft+"px",q.current.style.display="block"},We=function(e){var t=q.current.offsetLeft-re.current,n=te.current.offsetWidth,r=n+t;if(n+t>parseInt(te.current.style.minWidth||15,10)){if("fit"===i.columnResizeMode){var l=te.current.nextElementSibling,o=l.offsetWidth-t;if(r>15&&o>15)if(i.scrollable){var a=Ge(te.current),c=u.findSingle(a,"table.p-treetable-scrollable-body-table"),s=u.findSingle(a,"table.p-treetable-scrollable-header-table"),f=u.findSingle(a,"table.p-treetable-scrollable-footer-table"),p=u.index(te.current);Be(s,p,r,o),Be(c,p,r,o),Be(f,p,r,o)}else te.current.style.width=r+"px",l&&(l.style.width=o+"px")}else if("expand"===i.columnResizeMode)if(i.scrollable){var d=Ge(te.current),m=u.findSingle(d,"table.p-treetable-scrollable-body-table"),g=u.findSingle(d,"table.p-treetable-scrollable-header-table"),y=u.findSingle(d,"table.p-treetable-scrollable-footer-table");m.style.width=m.offsetWidth+t+"px",g.style.width=g.offsetWidth+t+"px",y&&(y.style.width=g.offsetWidth+t+"px");var b=u.index(te.current);Be(g,b,r,null),Be(m,b,r,null),Be(y,b,r,null)}else $.current.style.width=$.current.offsetWidth+t+"px",te.current.style.width=r+"px";i.onColumnResizeEnd&&i.onColumnResizeEnd({element:te.current,column:ne.current,delta:t})}q.current.style.display="none",te.current=null,ne.current=null,u.removeClass(Y.current,"p-unselectable-text"),_e()},Ge=function(e){if(e){for(var t=e.parentElement;t&&!u.hasClass(t,"p-treetable-scrollable-view");)t=t.parentElement;return t}return null},Be=function(e,t,n,r){if(e){var l="COLGROUP"===e.children[0].nodeName?e.children[0]:null;if(!l)throw new Error("Scrollable tables require a colgroup to support resizable columns");var o=l.children[t],a=o.nextElementSibling;o.style.width=n+"px",a&&r&&(a.style.width=r+"px")}},Xe=function(){he(),Ee()},_e=function(){Se(),xe()},Je=function(e){var t=e.originalEvent,n=e.column;ee.current?t.preventDefault():(le.current=u.getHiddenElementOuterWidth(Q.current),oe.current=u.getHiddenElementOuterHeight(Q.current),ie.current=qe(t.currentTarget),ce.current=n,t.dataTransfer.setData("text","b"))},Ve=function(e){var t=e.originalEvent,n=qe(t.currentTarget);if(i.reorderableColumns&&ie.current&&n){t.preventDefault();var r=u.getOffset(Y.current),l=u.getOffset(n);if(ie.current!==n){var o=l.left-r.left,a=l.left+n.offsetWidth/2;Q.current.style.top=l.top-r.top-(oe.current-1)+"px",Z.current.style.top=l.top-r.top+n.offsetHeight+"px",t.pageX>a?(Q.current.style.left=o+n.offsetWidth-Math.ceil(le.current/2)+"px",Z.current.style.left=o+n.offsetWidth-Math.ceil(le.current/2)+"px",se.current=1):(Q.current.style.left=o-Math.ceil(le.current/2)+"px",Z.current.style.left=o-Math.ceil(le.current/2)+"px",se.current=-1),Q.current.style.display="block",Z.current.style.display="block"}}},Ye=function(e){i.reorderableColumns&&ie.current&&(e.originalEvent.preventDefault(),Q.current.style.display="none",Z.current.style.display="none")},$e=function(t){var n=t.originalEvent,r=t.column;if(n.preventDefault(),ie.current){var l=u.index(ie.current),o=u.index(qe(n.currentTarget)),a=l!==o;if(a&&(o-l==1&&-1===se.current||l-o==1&&1===se.current)&&(a=!1),a){var s=W?at():e.Children.toArray(i.children),f=function(e,t){return Qe(e,"columnKey")||Qe(t,"columnKey")?c.equals(e,t,"props.columnKey"):c.equals(e,t,"props.field")},p=s.findIndex((function(e){return f(e,ce.current)})),d=s.findIndex((function(e){return f(e,r)}));d<p&&1===se.current&&d++,d>p&&-1===se.current&&d--,c.reorderArray(s,p,d);var m,g=[],y=ge(s);try{for(y.s();!(m=y.n()).done;){var b=m.value;g.push(Qe(b,"columnKey")||Qe(b,"field"))}}catch(e){y.e(e)}finally{y.f()}G(g),i.onColReorder&&i.onColReorder({dragIndex:p,dropIndex:d,columns:s})}Q.current.style.display="none",Z.current.style.display="none",ie.current.draggable=!1,ie.current=null,se.current=null}},qe=function(e){if("TH"===e.nodeName)return e;for(var t=e.parentElement;"TH"!==t.nodeName&&(t=t.parentElement););return t},Qe=function(e,t){return _.getCProp(e,t)},Ze=function(){return i.onPage?i.first:w},et=function(){return i.onPage?i.rows:k},tt=function(){return i.onSort?i.sortField:P},nt=function(){return i.onSort?i.sortOrder:D},rt=function(){return(i.onSort?i.multiSortMeta:F)||[]},lt=function(){return i.onFilter?i.filters:A},ot=function(e,t){if(e&&e.length)for(var n=0;n<e.length;n++){var r=e[n];if(Qe(r,"columnKey")===t||Qe(r,"field")===t)return r}return null},at=function(){var t=e.Children.toArray(i.children);if(t&&t.length){if(i.reorderableColumns&&W){var n,r=[],l=ge(W);try{for(l.s();!(n=l.n()).done;){var o=ot(t,n.value);o&&r.push(o)}}catch(e){l.e(e)}finally{l.f()}return[].concat(r,H(t.filter((function(e){return r.indexOf(e)<0}))))}return t}return null},it=function(e){var t,n=null,r=ge(e);try{for(r.s();!(t=r.n()).done;){var l=t.value;Qe(l,"frozen")&&(n=n||[]).push(l)}}catch(e){r.e(e)}finally{r.f()}return n},ct=function(e){var t,n=null,r=ge(e);try{for(r.s();!(t=r.n()).done;){var l=t.value;Qe(l,"frozen")||(n=n||[]).push(l)}}catch(e){r.e(e)}finally{r.f()}return n},ut=function(t){var n,r=[],l=lt(),o=e.Children.toArray(i.children),c="strict"===i.filterMode,u=ge(t);try{for(u.s();!(n=u.n()).done;){for(var s=n.value,f=ve({},s),p=!0,d=!1,m=0;m<o.length;m++){var g=o[m],y=l?l[Qe(g,"field")]:null,b=Qe(g,"field"),h=void 0;if(y){var v=y.matchMode||Qe(g,"filterMatchMode")||"startsWith";if(h={filterField:b,filterValue:y.value,filterConstraint:"custom"===v?Qe(g,"filterFunction"):a.filters[v],isStrictMode:c,options:{rowData:s,filters:l,props:i,column:{filterMeta:y,filterField:b,props:_.getCProps(g)}}},(!c||st(f,h)||ft(f,h))&&(c||ft(f,h)||st(f,h))||(p=!1),!p)break}if(i.globalFilter&&!d){var C=ve({},f);h={filterField:b,filterValue:i.globalFilter,filterConstraint:a.filters[i.globalFilterMatchMode],isStrictMode:c},(c&&(st(C,h)||ft(C,h))||!c&&(ft(C,h)||st(C,h)))&&(d=!0,f=C)}}var S=p;i.globalFilter&&(S=p&&d),S&&r.push(f)}}catch(e){u.e(e)}finally{u.f()}return r},st=function(e,t){if(e){var n=!1;if(e.children){var r=H(e.children);e.children=[];var l,o=ge(r);try{for(o.s();!(l=o.n()).done;){var a=ve({},l.value);ft(a,t)&&(n=!0,e.children.push(a))}}catch(e){o.e(e)}finally{o.f()}}if(n)return!0}},ft=function(e,t){var n=t.filterField,r=t.filterValue,l=t.filterConstraint,o=t.isStrictMode,a=t.options,u=!1;return l(c.resolveFieldData(e.data,n),r,i.filterLocale,a)&&(u=!0),(!u||o&&!pt(e))&&(u=st(e,{filterField:n,filterValue:r,filterConstraint:l,isStrictMode:o})||u),u},pt=function(e){return!1!==e.leaf&&!(e.children&&e.children.length)};e.useImperativeHandle(r,(function(){return{props:i,filter:je,getElement:function(){return Y.current}}}));var dt,mt=function(t,n){var r=tt(),l=nt(),o=H(rt()),a=lt();return e.createElement(de,{columns:t,columnGroup:n,tabIndex:i.tabIndex,onSort:Oe,sortField:r,sortIcon:i.sortIcon,sortOrder:l,multiSortMeta:o,resizableColumns:i.resizableColumns,onResizeStart:Le,reorderableColumns:i.reorderableColumns,onDragStart:Je,onDragOver:Ve,onDragLeave:Ye,onDrop:$e,onFilter:Ae,filters:a,filterDelay:i.filterDelay,ptCallbacks:V,metaData:B})},gt=function(t,n){return e.createElement(ue,{columns:t,columnGroup:n,ptCallbacks:V,metaData:B})},yt=function(t,n){return e.createElement(ae,{value:t,checkboxIcon:i.checkboxIcon,columns:n,expandedKeys:i.onToggle?i.expandedKeys:g,selectOnEdit:i.selectOnEdit,onToggle:ke,togglerTemplate:i.togglerTemplate,onExpand:i.onExpand,onCollapse:i.onCollapse,paginator:i.paginator,first:Ze(),rows:et(),selectionMode:i.selectionMode,selectionKeys:i.selectionKeys,onSelectionChange:i.onSelectionChange,metaKeySelection:i.metaKeySelection,onRowClick:i.onRowClick,onRowMouseEnter:i.onRowMouseEnter,onRowMouseLeave:i.onRowMouseLeave,onSelect:i.onSelect,onUnselect:i.onUnselect,propagateSelectionUp:i.propagateSelectionUp,propagateSelectionDown:i.propagateSelectionDown,lazy:i.lazy,rowClassName:i.rowClassName,emptyMessage:i.emptyMessage,loading:i.loading,contextMenuSelectionKey:i.contextMenuSelectionKey,onContextMenuSelectionChange:i.onContextMenuSelectionChange,onContextMenu:i.onContextMenu,ptCallbacks:V,metaData:B})},bt=function(t,n){var r=s("p-paginator-"+t,i.paginatorClassName);return e.createElement(v,{first:Ze(),rows:et(),pageLinkSize:i.pageLinkSize,className:r,onPageChange:Me,template:i.paginatorTemplate,totalRecords:n,rowsPerPageOptions:i.rowsPerPageOptions,currentPageReportTemplate:i.currentPageReportTemplate,leftContent:i.paginatorLeft,rightContent:i.paginatorRight,alwaysShow:i.alwaysShowPaginator,dropdownAppendTo:i.paginatorDropdownAppendTo,pt:V.ptm("paginator")})},ht=function(t,n,r,l,o){var a=mt(n,l),c=gt(n,o),u=yt(t,n);return e.createElement(me,{columns:n,header:a,body:u,footer:c,scrollHeight:i.scrollHeight,frozen:r,frozenWidth:i.frozenWidth,ptCallbacks:V,metaData:B})},vt=function(t){var n,r,l=at(),o=it(l),a=o?ct(l):l;o&&(n=ht(t,o,!0,i.frozenHeaderColumnGroup,i.frozenFooterColumnGroup)),r=ht(t,a,!1,i.headerColumnGroup,i.footerColumnGroup);var c=f({className:"p-treetable-wrapper p-treetable-scrollable-wrapper"},V.ptm("scrollableWrapper"));return e.createElement("div",c,n,r)},Ct=function(t){var n=at(),r=mt(n,i.headerColumnGroup),l=gt(n,i.footerColumnGroup),o=yt(t,n),a=s("p-treetable-table",{"p-treetable-scrollable-table":i.scrollable,"p-treetable-resizable-table":i.resizableColumns,"p-treetable-resizable-table-fit":i.resizableColumns&&"fit"===i.columnResizeMode},i.tableClassName),c=f({className:"p-treetable-wrapper"},V.ptm("wrapper")),u=f({ref:$,style:i.tableStyle,className:a},V.ptm("table"));return e.createElement("div",c,e.createElement("table",u,r,l,o))},St=function(){var e=i.value||[];if(!i.lazy&&e&&e.length){var t=lt(),n=tt(),r=rt();(c.isNotEmpty(t)||i.globalFilter)&&(e=ut(e)),(n||c.isNotEmpty(r))&&("single"===i.sortMode?e=Ie(e):"multiple"===i.sortMode&&(e=Te(e)))}return e}(),wt=s("p-treetable p-component",{"p-treetable-hoverable-rows":i.rowHover,"p-treetable-selectable":i.selectionMode&&"single"===i.selectionMode||i.selectionMode&&"multiple"===i.selectionMode,"p-treetable-resizable":i.resizableColumns,"p-treetable-resizable-fit":i.resizableColumns&&"fit"===i.columnResizeMode,"p-treetable-striped":i.stripedRows,"p-treetable-gridlines":i.showGridlines},i.className),Et=(dt=St,i.scrollable?vt(dt):Ct(dt)),xt=function(e){return i.lazy?i.totalRecords:e?e.length:0}(St),kt=f({className:"p-treetable-header"},V.ptm("header")),Mt=f({className:"p-treetable-footer"},V.ptm("footer")),Ot=f({ref:q,className:"p-column-resizer-helper",style:{display:"none"}},V.ptm("resizeHelper")),Pt=i.header&&e.createElement("div",kt,i.header),Nt=i.footer&&e.createElement("div",Mt,i.footer),Rt=i.paginator&&"bottom"!==i.paginatorPosition&&bt("top",xt),It=i.paginator&&"top"!==i.paginatorPosition&&bt("bottom",xt),Dt=function(){if(i.loading){var t=f({className:"p-treetable-loading-icon"},V.ptm("loadingIcon")),n=i.loadingIcon||e.createElement(h,I({},t,{spin:!0})),r=p.getJSXIcon(n,ve({},t),{props:i}),l=f({className:"p-treetable-loading"},V.ptm("loadingWrapper")),o=f({className:"p-treetable-loading-overlay p-component-overlay"},V.ptm("loadingOverlay"));return e.createElement("div",l,e.createElement("div",o,r))}return null}(),Tt=i.resizableColumns&&e.createElement("div",Ot),Kt={position:"absolute",display:"none"},Ft=f({className:"p-datatable-reorder-indicator-up",style:ve({},Kt)},V.ptm("reorderIndicatorUp")),zt=f(V.ptm("reorderIndicatorUpIcon")),jt=i.reorderableColumns&&p.getJSXIcon(i.reorderIndicatorUpIcon||e.createElement(y,zt),ve({},zt),{props:i}),At=i.reorderableColumns&&e.createElement("span",I({ref:Q},Ft),jt),Ut={className:"p-datatable-reorder-indicator-down",style:ve({},Kt)},Lt=f(V.ptm("reorderIndicatorDownIcon")),Ht=p.getJSXIcon(i.reorderIndicatorDownIcon||e.createElement(b,Lt),ve({},Lt),{props:i}),Wt=i.reorderableColumns&&e.createElement("span",I({ref:Z},Ut),Ht),Gt=f({ref:Y,id:i.id,className:wt,style:i.style,"data-scrollselectors":".p-treetable-wrapper"},c.findDiffKeys(i,Ce.defaultProps),V.ptm("root"));return e.createElement("div",Gt,Dt,Pt,Rt,Et,It,Nt,Tt,At,Wt)}));Ce.displayName="TreeTable";export{Ce as TreeTable};
