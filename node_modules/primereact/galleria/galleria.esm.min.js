import*as e from"react";import t,{PrimeReactContext as n,localeOption as r}from"primereact/api";import{CSSTransition as a}from"primereact/csstransition";import{useMountEffect as i,usePrevious as l,useResizeListener as o,useUpdateEffect as c,useInterval as u,useUnmountEffect as m}from"primereact/hooks";import{TimesIcon as s}from"primereact/icons/times";import{Portal as p}from"primereact/portal";import{Ripple as v}from"primereact/ripple";import{mergeProps as d,classNames as f,IconUtils as h,UniqueComponentId as b,DomHandler as I,ObjectUtils as g,ZIndexUtils as y}from"primereact/utils";import{ComponentBase as x}from"primereact/componentbase";import{ChevronLeftIcon as w}from"primereact/icons/chevronleft";import{ChevronRightIcon as O}from"primereact/icons/chevronright";import{ChevronDownIcon as S}from"primereact/icons/chevrondown";import{ChevronUpIcon as E}from"primereact/icons/chevronup";function N(e){return N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},N(e)}function P(e,t){if("object"!==N(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==N(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function j(e){var t=P(e,"string");return"symbol"===N(t)?t:String(t)}function T(e,t,n){return(t=j(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function C(e){if(Array.isArray(e))return e}function k(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,l,o=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(o.push(r.value),o.length!==t);c=!0);}catch(e){u=!0,a=e}finally{try{if(!c&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(u)throw a}}return o}}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function V(e,t){if(e){if("string"==typeof e)return A(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?A(e,t):void 0}}function D(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function H(e,t){return C(e)||k(e,t)||V(e,t)||D()}var R=x.extend({defaultProps:{__TYPE:"Galleria",id:null,value:null,activeIndex:0,fullScreen:!1,item:null,thumbnail:null,indicator:null,caption:null,className:null,closeIcon:null,style:null,header:null,footer:null,numVisible:3,responsiveOptions:null,showItemNavigators:!1,showThumbnailNavigators:!0,showItemNavigatorsOnHover:!1,changeItemOnIndicatorHover:!1,circular:!1,autoPlay:!1,transitionInterval:4e3,showThumbnails:!0,itemNextIcon:null,itemPrevIcon:null,nextThumbnailIcon:null,prevThumbnailIcon:null,thumbnailsPosition:"bottom",verticalThumbnailViewPortHeight:"300px",showIndicators:!1,showIndicatorsOnItem:!1,indicatorsPosition:"bottom",baseZIndex:0,transitionOptions:null,onItemChange:null,children:void 0}});function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function X(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){T(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var B=e.memo(e.forwardRef((function(t,n){var r=function(){t.slideShowActive&&t.stopSlideShow&&t.stopSlideShow()},a=function(e){r(),t.onActiveItemChange({index:t.circular&&0===t.activeItemIndex?t.value.length-1:0!==t.activeItemIndex?t.activeItemIndex-1:0}),e&&e.cancelable&&e.preventDefault()},l=function(e){r(),t.onActiveItemChange({index:t.circular&&t.value.length-1===t.activeItemIndex?0:t.activeItemIndex+1}),e&&e.cancelable&&e.preventDefault()},o=function(e){r(),t.onActiveItemChange({index:e})},c=function(e){t.changeItemOnIndicatorHover&&(r(),t.onActiveItemChange({index:e}))},u=function(e,n){13===e.which&&(r(),t.onActiveItemChange({index:n}))};i((function(){t.autoPlay&&t.startSlideShow()}));var m=function(n){var r="p-galleria-indicator-"+n,a=f("p-galleria-indicator",{"p-highlight":t.activeItemIndex===n}),i=t.indicator&&t.indicator(n),l=d({className:a,key:r,tabIndex:0,onClick:function(){return o(n)},onMouseEnter:function(){return c(n)},onKeyDown:function(e){return u(e,n)}},t.ptm("indicator"));return i||(i=e.createElement("button",{type:"button",tabIndex:-1,className:"p-link"},e.createElement(v,null))),e.createElement("li",l,i)},s=t.itemTemplate&&t.itemTemplate(t.value[t.activeItemIndex]),p=function(){if(t.showItemNavigators){var n=!t.circular&&0===t.activeItemIndex,r=f("p-galleria-item-prev p-galleria-item-nav p-link",{"p-disabled":n}),i=d({className:"p-galleria-item-prev-icon"},t.ptm("previousItemIcon")),l=h.getJSXIcon(t.itemPrevIcon||e.createElement(w,i),X({},i),{props:t}),o=d({type:"button",className:r,onClick:a,disabled:n},t.ptm("previousItemButton"));return e.createElement("button",o,l,e.createElement(v,null))}return null}(),b=function(){if(t.showItemNavigators){var n=!t.circular&&t.activeItemIndex===t.value.length-1,r=f("p-galleria-item-next p-galleria-item-nav p-link",{"p-disabled":n}),a=d({className:"p-galleria-item-next-icon"},t.ptm("nextItemIcon")),i=h.getJSXIcon(t.itemNextIcon||e.createElement(O,a),X({},a),{props:t}),o=d({type:"button",className:r,onClick:l,disabled:n},t.ptm("nextItemButton"));return e.createElement("button",o,i,e.createElement(v,null))}return null}(),I=function(){var n=d({className:"p-galleria-caption"},t.ptm("caption"));if(t.caption){var r=t.caption(t.value[t.activeItemIndex]);return e.createElement("div",n,r)}return null}(),g=function(){if(t.showIndicators){for(var n=f("p-galleria-indicators p-reset",t.indicatorsContentClassName),r=[],a=d({className:n},t.ptm("indicators")),i=0;i<t.value.length;i++)r.push(m(i));return e.createElement("ul",a,r)}return null}(),y=d({ref:n,className:"p-galleria-item-wrapper"},t.ptm("itemWrapper")),x=d({className:"p-galleria-item-container"},t.ptm("itemContainer")),S=d({className:"p-galleria-item"},t.ptm("item"));return e.createElement("div",y,e.createElement("div",x,p,e.createElement("div",S,s),b,I),g)})));function G(e){if(Array.isArray(e))return A(e)}function J(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Z(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(Object(n),!0).forEach((function(t){T(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}B.displayName="GalleriaItem";var z=e.memo((function(t){var n=t.active?0:null,r=t.template&&t.template(t.item),a=f("p-galleria-thumbnail-item",{"p-galleria-thumbnail-item-current":t.current,"p-galleria-thumbnail-item-active":t.active,"p-galleria-thumbnail-item-start":t.start,"p-galleria-thumbnail-item-end":t.end},t.className),i=d({className:a},t.ptm("thumbnailItem")),l=d({className:"p-galleria-thumbnail-item-content",tabIndex:n,onClick:function(e){t.onItemClick({originalEvent:e,index:t.index})},onKeyDown:function(e){13===e.which&&t.onItemClick({originalEvent:e,index:t.index})}},t.ptm("thumbnailItemContent"));return e.createElement("div",i,e.createElement("div",l,r))})),K=e.memo(e.forwardRef((function(r,a){var u=H(e.useState(r.numVisible),2),m=u[0],s=u[1],p=H(e.useState(0),2),y=p[0],x=p[1],N=e.useRef(null),P=e.useRef(null),j=e.useRef(""),T=e.useRef(null),C=e.useRef(null),k=l(m),A=l(r.activeItemIndex),D=e.useContext(n),R=H(o({listener:function(){te()},when:r.responsiveOptions}),1)[0],M=function(e){var t=y+e;e<0&&-1*t+m>r.value.length-1?t=m-r.value.length:e>0&&t>0&&(t=0),r.circular&&(e<0&&r.value.length-1===r.activeItemIndex?t=0:e>0&&0===r.activeItemIndex&&(t=m-r.value.length)),N.current&&(I.removeClass(N.current,"p-items-hidden"),N.current.style.transform=r.isVertical?"translate3d(0, ".concat(t*(100/m),"%, 0)"):"translate3d(".concat(t*(100/m),"%, 0, 0)"),N.current.style.transition="transform 500ms ease 0s"),x(t)},X=function(){r.slideShowActive&&r.stopSlideShow&&r.stopSlideShow()},B=function(){var e=Math.floor(m/2);return m%2?e:e-1},W=function(e){X();var t=0!==r.activeItemIndex?r.activeItemIndex-1:0;m-(t+y)-1>B()&&(-1*y!=0||r.circular)&&M(1),r.onActiveItemChange({index:r.circular&&0===r.activeItemIndex?r.value.length-1:t}),e.cancelable&&e.preventDefault()},K=function(e){X();var t=r.activeItemIndex+1;t+y>B()&&(-1*y<Q()-1||r.circular)&&M(-1),r.onActiveItemChange({index:r.circular&&r.value.length-1===r.activeItemIndex?0:t}),e.cancelable&&e.preventDefault()},_=function(e){X();var t=e.index;if(t!==r.activeItemIndex){var n=t+y,a=0;t<r.activeItemIndex?(a=m-n-1-B())>0&&-1*y!=0&&M(a):(a=B()-n)<0&&-1*y<Q()-1&&M(a),r.onActiveItemChange({index:t})}},L=function(e){N.current&&"transform"===e.propertyName&&(I.addClass(N.current,"p-items-hidden"),N.current.style.transition="")},U=function(e){var t=e.changedTouches[0];P.current={x:t.pageX,y:t.pageY}},$=function(e){e.cancelable&&e.preventDefault()},q=function(e){var t=e.changedTouches[0];F(e,r.isVertical?t.pageY-P.current.y:t.pageX-P.current.x)},F=function(e,t){t<0?K(e):W(e)},Q=function(){return r.value.length>m?r.value.length-m+1:0},ee=function(){T.current||(T.current=I.createInlineStyle(D&&D.nonce||t.nonce));var e,n="\n            .p-galleria-thumbnail-items[".concat(j.current,"] .p-galleria-thumbnail-item {\n                flex: 1 0 ").concat(100/m,"%\n            }\n        ");if(r.responsiveOptions){C.current=G(e=r.responsiveOptions)||J(e)||V(e)||Z(),C.current.sort((function(e,n){return g.sort(e.breakpoint,n.breakpoint,-1,D&&D.locale||t.locale,D&&D.nullSortOrder||t.nullSortOrder)}));for(var a=0;a<C.current.length;a++){var i=C.current[a];n+="\n                    @media screen and (max-width: ".concat(i.breakpoint,") {\n                        .p-galleria-thumbnail-items[").concat(j.current,"] .p-galleria-thumbnail-item {\n                            flex: 1 0 ").concat(100/i.numVisible,"%\n                        }\n                    }\n                ")}}T.current.innerHTML=n},te=function(){if(N.current&&C.current){for(var e=window.innerWidth,t={numVisible:r.numVisible},n=0;n<C.current.length;n++){var a=C.current[n];parseInt(a.breakpoint,10)>=e&&(t=a)}m!==t.numVisible&&s(t.numVisible)}};i((function(){N.current&&(j.current=b(),N.current.setAttribute(j.current,"")),ee(),te(),R()})),c((function(){var e=y;k===m&&A===r.activeItemIndex||((e=r.activeItemIndex<=B()?0:r.value.length-m+B()<r.activeItemIndex?m-r.value.length:r.value.length-m<r.activeItemIndex&&m%2==0?-1*r.activeItemIndex+B()+1:-1*r.activeItemIndex+B())!==y&&x(e),N.current.style.transform=r.isVertical?"translate3d(0, ".concat(e*(100/m),"%, 0)"):"translate3d(".concat(e*(100/m),"%, 0, 0)"),A!==r.activeItemIndex&&(I.removeClass(N.current,"p-items-hidden"),N.current.style.transition="transform 500ms ease 0s"))}));var ne,re,ae,ie,le,oe,ce,ue=function(){if(r.showThumbnailNavigators){var t=!r.circular&&0===r.activeItemIndex||r.value.length<=m,n=f("p-galleria-thumbnail-prev p-link",{"p-disabled":t}),a=d({className:"p-galleria-thumbnail-prev-icon"},r.ptm("previousThumbnailIcon")),i=h.getJSXIcon(r.isVertical?r.prevThumbnailIcon||e.createElement(E,a):r.prevThumbnailIcon||e.createElement(w,a),Y({},a),{props:r}),l=d({className:n,onClick:W,disabled:t},r.ptm("previousThumbnailButton"));return e.createElement("button",l,i,e.createElement(v,null))}return null},me=function(){if(r.showThumbnailNavigators){var t=!r.circular&&r.activeItemIndex===r.value.length-1||r.value.length<=m,n=f("p-galleria-thumbnail-next p-link",{"p-disabled":t}),a=d({className:"p-galleria-thumbnail-next-icon"},r.ptm("nextThumbnailIcon")),i=h.getJSXIcon(r.isVertical?r.nextThumbnailIcon||e.createElement(S,a):r.nextThumbnailIcon||e.createElement(O,a),Y({},a),{props:r}),l=d({className:n,onClick:K,disabled:t},r.ptm("nextThumbnailButton"));return e.createElement("button",l,i,e.createElement(v,null))}return null},se=(ne=r.value.map((function(t,n){var a=-1*y,i=a+m-1;return e.createElement(z,{key:n,index:n,template:r.itemTemplate,item:t,active:a<=n&&i>=n,start:a===n,end:i===n,onItemClick:_,current:r.activeItemIndex===n,ptm:r.ptm})})),re=r.isVertical?r.contentHeight:"",ae=ue(),ie=me(),le=d({className:"p-galleria-thumbnail-container"},r.ptm("thumbnailContainer")),oe=d({className:"p-galleria-thumbnail-items-container",style:{height:re}},r.ptm("thumbnailItemsContainer")),ce=d({ref:N,className:"p-galleria-thumbnail-items",onTransitionEnd:L,onTouchStart:U,onTouchMove:$,onTouchEnd:q},r.ptm("thumbnailItems")),e.createElement("div",le,ae,e.createElement("div",oe,e.createElement("div",ce,ne)),ie)),pe=d({className:"p-galleria-thumbnail-wrapper"},r.ptm("thumbnailWrapper"));return e.createElement("div",pe,se)})));function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){T(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}z.displayName="GalleriaThumbnailItem",K.displayName="GalleriaThumbnails";var U=e.memo(e.forwardRef((function(i,l){var o=e.useContext(n),c=R.getProps(i,o),b=H(e.useState(!1),2),x=b[0],w=b[1],O=H(e.useState(c.numVisible),2),S=O[0],E=O[1],N=H(e.useState(!1),2),P=N[0],j=N[1],T=H(e.useState(c.activeIndex),2),C=T[0],k=T[1],A=e.useRef(null),V=e.useRef(null),D=e.useRef(null),M=c.onItemChange?c.activeIndex:C,X="left"===c.thumbnailsPosition||"right"===c.thumbnailsPosition,G=R.setMetaData({props:c,state:{visible:x,numVisible:S,slideShowActive:P,activeIndex:C}}).ptm;u((function(){J({index:c.circular&&c.value.length-1===M?0:M+1})}),c.transitionInterval,P);var J=function(e){e.index>=c.value.length?Q():c.onItemChange?c.onItemChange(e):k(e.index)},Z=function(){w(!0)},W=function(){w(!1)},Y=function(){I.addClass(document.body,"p-overflow-hidden")},z=function(){y.set("modal",D.current,o&&o.autoZIndex||t.autoZIndex,c.baseZIndex||o&&o.zIndex.modal||t.zIndex.modal),I.addMultipleClasses(D.current,"p-component-overlay p-component-overlay-enter")},_=function(){c.onShow&&c.onShow()},U=function(){I.removeClass(document.body,"p-overflow-hidden"),I.addClass(D.current,"p-component-overlay-leave")},$=function(){y.clear(D.current),c.onHide&&c.onHide()},q=function(){return P},F=function(){j(!0)},Q=function(){j(!1)},ee=function(e,t){var n=["top","left","bottom","right"].find((function(e){return e===t}));return n?"".concat(e,"-").concat(n):""};e.useEffect((function(){c.value&&c.value.length<S&&E(c.value.length)}),[c.value,S]),e.useEffect((function(){E(c.numVisible)}),[c.numVisible]),m((function(){P&&Q(),y.clear(D.current)})),e.useImperativeHandle(l,(function(){return{props:c,show:Z,hide:W,isAutoPlayActive:q,startSlideShow:F,stopSlideShow:Q,getElement:function(){return A.current},getPreviewContent:function(){return V.current}}}));return g.isNotEmpty(c.value)&&function(){var n,i,l,u,m,b,I,g,y,w,O,E,N,j=(l=c.showThumbnails&&ee("p-galleria-thumbnails",c.thumbnailsPosition),u=c.showIndicators&&ee("p-galleria-indicators",c.indicatorsPosition),m=f("p-galleria p-component",c.className,{"p-galleria-fullscreen":c.fullScreen,"p-galleria-indicator-onitem":c.showIndicatorsOnItem,"p-galleria-item-nav-onhover":c.showItemNavigatorsOnHover&&!c.fullScreen,"p-input-filled":o&&"filled"===o.inputStyle||"filled"===t.inputStyle,"p-ripple-disabled":o&&!1===o.ripple||!1===t.ripple},l,u),b=d({className:{className:"p-galleria-close-icon","aria-hidden":!0}},G("closeIcon")),I=h.getJSXIcon(c.closeIcon||e.createElement(s,b),L({},b),{props:c}),g=d({type:"button",className:"p-galleria-close p-link","aria-label":r("close"),onClick:W},G("closeButton")),y=c.fullScreen&&e.createElement("button",g,I,e.createElement(v,null)),n=d({className:"p-galleria-header"},G("header")),w=c.header?e.createElement("div",n,c.header):null,i=d({className:"p-galleria-footer"},G("footer")),O=c.footer?e.createElement("div",i,c.footer):null,E=d({ref:A,id:c.id,className:m,style:c.style},R.getOtherProps(c),G("root")),N=d({className:"p-galleria-content"},G("content")),e.createElement("div",E,y,w,e.createElement("div",N,e.createElement(B,{ref:V,value:c.value,activeItemIndex:M,onActiveItemChange:J,itemTemplate:c.item,circular:c.circular,caption:c.caption,showIndicators:c.showIndicators,itemPrevIcon:c.itemPrevIcon,itemNextIcon:c.itemNextIcon,changeItemOnIndicatorHover:c.changeItemOnIndicatorHover,indicator:c.indicator,showItemNavigators:c.showItemNavigators,autoPlay:c.autoPlay,slideShowActive:P,startSlideShow:F,stopSlideShow:Q,ptm:G}),c.showThumbnails&&e.createElement(K,{value:c.value,activeItemIndex:M,onActiveItemChange:J,itemTemplate:c.thumbnail,numVisible:S,nextThumbnailIcon:c.nextThumbnailIcon,prevThumbnailIcon:c.prevThumbnailIcon,responsiveOptions:c.responsiveOptions,circular:c.circular,isVertical:X,contentHeight:c.verticalThumbnailViewPortHeight,showThumbnailNavigators:c.showThumbnailNavigators,autoPlay:c.autoPlay,slideShowActive:P,stopSlideShow:Q,ptm:G})),O));if(c.fullScreen){var T=f("p-galleria-mask",{"p-galleria-visible":x}),C=d({ref:D,className:T},G("mask"));return e.createElement(p,{element:e.createElement("div",C,e.createElement(a,{nodeRef:A,classNames:"p-galleria",in:x,timeout:{enter:150,exit:150},options:c.transitionOptions,unmountOnExit:!0,onEnter:Y,onEntering:z,onEntered:_,onExit:U,onExited:$},j))})}return j}()})));U.displayName="Galleria";export{U as Galleria};
