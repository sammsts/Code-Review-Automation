import*as e from"react";import n,{PrimeReactContext as t}from"primereact/api";import{useMatchMedia as r,useEventListener as a,useResizeListener as l,useMountEffect as i,useUpdateEffect as o}from"primereact/hooks";import{AngleDownIcon as u}from"primereact/icons/angledown";import{AngleRightIcon as m}from"primereact/icons/angleright";import{BarsIcon as c}from"primereact/icons/bars";import{Ripple as s}from"primereact/ripple";import{UniqueComponentId as p,DomHandler as f,ZIndexUtils as d,classNames as b,mergeProps as g,ObjectUtils as v,IconUtils as y}from"primereact/utils";import{ComponentBase as h}from"primereact/componentbase";function E(e){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E(e)}function S(e,n){if("object"!==E(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!==E(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}function k(e){var n=S(e,"string");return"symbol"===E(n)?n:String(n)}function w(e,n,t){return(n=k(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function N(e){if(Array.isArray(e))return e}function x(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,l,i,o=[],u=!0,m=!1;try{if(l=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;u=!1}else for(;!(u=(r=l.call(t)).done)&&(o.push(r.value),o.length!==n);u=!0);}catch(e){m=!0,a=e}finally{try{if(!u&&null!=t.return&&(i=t.return(),Object(i)!==i))return}finally{if(m)throw a}}return o}}function I(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function O(e,n){if(e){if("string"==typeof e)return I(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?I(e,n):void 0}}function j(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function D(e,n){return N(e)||x(e,n)||O(e,n)||j()}var P=h.extend({defaultProps:{__TYPE:"MegaMenu",id:null,model:null,style:null,className:null,orientation:"horizontal",breakpoint:void 0,scrollHeight:"400px",start:null,submenuIcon:null,menuIcon:null,end:null,children:void 0}});function C(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function z(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?C(Object(t),!0).forEach((function(n){w(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):C(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var A=e.memo(e.forwardRef((function(h,E){var S=e.useContext(t),k=P.getProps(h,S),w=D(e.useState(null),2),N=w[0],x=w[1],I=D(e.useState(null),2),O=I[0],j=I[1],C=D(e.useState(!1),2),A=C[0],J=C[1],M=e.useRef(null),X=e.useRef(null),_=e.useRef(null),H="horizontal"===k.orientation,T="vertical"===k.orientation,R=r("screen and (max-width: ".concat(k.breakpoint,")"),!!k.breakpoint),Z=P.setMetaData({props:k,state:{activeItem:N,attributeSelector:O,mobileActive:A}}).ptm,F=function(e,n){return Z(n,{context:{active:N===e}})},K=D(a({type:"click",listener:function(e){R&&!A||!ee(e)||(x(null),J(!1))}}),1)[0],L=D(l({listener:function(){R&&!A||(x(null),J(!1))}}),1)[0],U=function(e,n){n.disabled?e.preventDefault():(n.url||e.preventDefault(),n.command&&n.command({originalEvent:e,item:n}),x(null),J(!1))},V=function(e,n){var t=e.currentTarget.parentElement;switch(e.which){case 40:H?Y(n):Q(t),e.preventDefault();break;case 38:T?W(t):n.items&&n===N&&$(),e.preventDefault();break;case 39:H?Q(t):Y(n),e.preventDefault();break;case 37:H?W(t):n.items&&n===N&&$(),e.preventDefault()}},Y=function(e){e.items&&x(e)},$=function(e){x(null)},q=function(e){e.preventDefault(),J((function(e){return!e})),x(null)},B=function e(n){var t=n.nextElementSibling;return t?f.hasClass(t,"p-disabled")||!f.hasClass(t,"p-menuitem")?e(t):t:null},G=function e(n){var t=n.previousElementSibling;return t?f.hasClass(t,"p-disabled")||!f.hasClass(t,"p-menuitem")?e(t):t:null},Q=function(e){var n=B(e);n&&n.children[0].focus()},W=function(e){var n=G(e);n&&n.children[0].focus()},ee=function(e){return M.current&&!(M.current.isSameNode(e.target)||M.current.contains(e.target)||_.current&&_.current.contains(e.target))},ne=function(e){var n;switch(e.items?e.items.length:0){case 2:n="p-megamenu-col-6";break;case 3:n="p-megamenu-col-4";break;case 4:n="p-megamenu-col-3";break;case 6:n="p-megamenu-col-2";break;default:n="p-megamenu-col-12"}return n};e.useImperativeHandle(E,(function(){return{props:k,getElement:function(){return M.current}}})),i((function(){k.breakpoint&&!O&&j(p()),K(),L()})),o((function(){var e=f.findSingle(M.current,".p-menuitem-active > .p-megamenu-panel");return N&&!R&&d.set("menu",e,S&&S.autoZIndex||n.autoZIndex,S&&S.zIndex.menu||n.zIndex.menu),R&&e&&e.previousElementSibling.scrollIntoView({block:"nearest",inline:"nearest"}),function(){d.clear(e)}}),[N]);var te=function(n){var t=g({key:"separator_"+n,className:"p-menu-separator",role:"separator"},Z("separator"));return e.createElement("li",t)},re=function(n){if(n.items){var t=g({className:"p-submenu-icon"},Z("submenuIcon"));return y.getJSXIcon(T?k.submenuIcon||e.createElement(m,t):k.submenuIcon||e.createElement(u,t),z({},t),{props:k})}return null},ae=function(n,t){if(!1===n.visible)return null;if(n.separator)return te(t);var r=n.label+"_"+t,a=b("p-menuitem",n.className),l=b("p-menuitem-link",{"p-disabled":n.disabled}),i=b(n.icon,"p-menuitem-icon"),o=y.getJSXIcon(n.icon,{className:"p-menuitem-icon"},{props:k}),u=n.label&&e.createElement("span",{className:"p-menuitem-text"},n.label),m=g({href:n.url||"#",className:l,target:n.target,onClick:function(e){return U(e,n)},role:"menuitem","aria-disabled":n.disabled},F(n,"action")),c=g({key:r,id:n.id,className:a,style:n.style,role:"none"},F(n,"submenuItem")),p=e.createElement("a",m,o,u,e.createElement(s,null));return n.template&&(p=v.getJSXElement(n.template,n,{onClick:function(e){return U(e,n)},className:l,labelClassName:"p-menuitem-text",iconClassName:i,element:p,props:k})),e.createElement("li",c,p)},le=function(n){if(!1===n.visible)return null;var t=b("p-megamenu-submenu-header",{"p-disabled":n.disabled},n.className),r=n.items.map(ae),a=g({id:n.id,className:t,style:n.style,role:"presentation"},Z("submenuHeader"));return e.createElement(e.Fragment,{key:n.label},e.createElement("li",a,n.label),r)},ie=function(e){return e.map(le)},oe=function(n,t,r,a){var l=n.label+"_column_"+r,i=ie(t),o=g({key:l,className:a},Z("column")),u=g({className:"p-megamenu-submenu",role:"menu"},Z("submenu"));return e.createElement("div",o,e.createElement("ul",u,i))},ue=function(e){if(e.items){var n=ne(e);return e.items.map((function(t,r){return oe(e,t,r,n)}))}return null},me=function(n){if(n.items){var t=ue(n),r=g({className:"p-megamenu-panel"},Z("panel")),a=g({className:"p-megamenu-grid"},Z("grid"));return e.createElement("div",r,e.createElement("div",a,t))}return null},ce=function(){if(!X.current){X.current=f.createInlineStyle(S&&S.nonce||n.nonce);var e="".concat(O),t="\n@media screen and (max-width: ".concat(k.breakpoint,") {\n    .p-megamenu[").concat(e,"] > .p-megamenu-root-list .p-menuitem-active .p-megamenu-panel {\n        position: relative;\n        left: 0 !important;\n        box-shadow: none;\n        border-radius: 0;\n        background: inherit;\n    }\n\n    .p-megamenu[").concat(e,"] .p-menuitem-active > .p-menuitem-link > .p-submenu-icon {\n        transform: rotate(-180deg);\n    }\n\n    .p-megamenu[").concat(e,"] .p-megamenu-grid {\n        flex-wrap: wrap;\n    }\n\n    ").concat(H?"\n.p-megamenu[".concat(e,"] .p-megamenu-button {\n    display: flex;\n}\n\n.p-megamenu[").concat(e,"].p-megamenu-horizontal {\n    position: relative;\n}\n\n.p-megamenu[").concat(e,"].p-megamenu-horizontal .p-megamenu-root-list {\n    display: none;\n}\n\n.p-megamenu-horizontal[").concat(e,'] div[class*="p-megamenu-col-"] {\n    width: auto;\n    flex: 1;\n    padding: 0;\n}\n\n.p-megamenu[').concat(e,"].p-megamenu-mobile-active .p-megamenu-root-list {\n    display: flex;\n    flex-direction: column;\n    position: absolute;\n    width: 100%;\n    top: 100%;\n    left: 0;\n    z-index: 1;\n}\n        "):"","\n\n    ").concat(T?"\n.p-megamenu-vertical[".concat(e,"] {\n    width: 100%;\n}\n\n.p-megamenu-vertical[").concat(e,"] .p-megamenu-root-list {\n    max-height: ").concat(k.scrollHeight,";\n    overflow: ").concat(k.scrollHeight?"auto":"",";\n}\n.p-megamenu-vertical[").concat(e,'] div[class*="p-megamenu-col-"] {\n    width: 100%;\n    padding: 0;\n}\n\n.p-megamenu-vertical[').concat(e,"] .p-megamenu-submenu {\n    width: 100%;\n}\n\n.p-megamenu-vertical[").concat(e,'] div[class*="p-megamenu-col-"] .p-megamenu-submenu-header {\n    background: inherit;\n}\n\n.p-megamenu-vertical[').concat(e,'] .p-submenu-icon:before {\n    content: "\\e930";\n}\n        '):"","\n}\n");X.current.innerHTML=t}};o((function(){return O&&M.current&&(M.current.setAttribute(O,""),ce()),function(){X.current=f.removeInlineStyle(X.current)}}),[O,k.breakpoint]);var se,pe=function(n,t){var r=b("p-menuitem",{"p-menuitem-active":n===N},n.className),a=b("p-menuitem-link",{"p-disabled":n.disabled}),l=g({className:"p-menuitem-icon"},F(n,"icon")),i=y.getJSXIcon(n.icon,z({},l),{props:k}),o=g({className:"p-menuitem-text"},F(n,"label")),u=n.label&&e.createElement("span",o,n.label),m=n.template?v.getJSXElement(n.template,n):null,c=re(n),p=me(n),f=g({href:n.url||"#",className:a,target:n.target,onClick:function(e){return t=e,(r=n).disabled||(r.url||t.preventDefault(),r.command&&r.command({originalEvent:t,item:k.item}),r.items&&x(N&&N===r?null:r)),void t.preventDefault();var t,r},onKeyDown:function(e){return V(e,n)},role:"menuitem","aria-haspopup":null!=n.items},F(n,"headerAction")),d=g({key:n.label+"_"+t,id:n.id,className:r,style:n.style,onMouseEnter:function(e){return t=e,void((r=n).disabled||R?t.preventDefault():N&&x(r));var t,r},role:"none"},F(n,"menuitem"));return e.createElement("li",d,e.createElement("a",f,i,u,m,c,e.createElement(s,null)),p)},fe=b("p-megamenu p-component",{"p-megamenu-horizontal":"horizontal"===k.orientation,"p-megamenu-vertical":"vertical"===k.orientation,"p-megamenu-mobile-active":A},k.className),de=g({ref:M,id:k.id,className:fe,style:k.style},P.getOtherProps(k),Z("root")),be=(se=g({className:"p-megamenu-root-list",role:"menubar"},Z("menu")),k.model?e.createElement("ul",se,k.model.map((function(e,n){return pe(e,n)}))):null),ge=function(){var n=g({className:"p-megamenu-start"},Z("start"));if(k.start){var t=v.getJSXElement(k.start,k);return e.createElement("div",n,t)}return null}(),ve=function(){var n=g({className:"p-megamenu-end"},Z("end"));if(k.end){var t=v.getJSXElement(k.end,k);return e.createElement("div",n,t)}return null}(),ye=function(){if("vertical"===k.orientation||k.model&&k.model.length<1)return null;var n=y.getJSXIcon(k.menuIcon||e.createElement(c,null),void 0,{props:k});return e.createElement("a",{ref:_,href:"#",role:"button",tabIndex:0,className:"p-megamenu-button",onClick:q},n)}();return e.createElement("div",de,ge,ye,be,ve)})));A.displayName="MegaMenu";export{A as MegaMenu};
