import*as e from"react";import t,{PrimeReactContext as n,localeOption as r}from"primereact/api";import{CSSTransition as o}from"primereact/csstransition";import{useEventListener as i,useMountEffect as a,useUpdateEffect as l,useUnmountEffect as c}from"primereact/hooks";import{TimesIcon as u}from"primereact/icons/times";import{WindowMaximizeIcon as s}from"primereact/icons/windowmaximize";import{WindowMinimizeIcon as m}from"primereact/icons/windowminimize";import{Portal as d}from"primereact/portal";import{Ripple as p}from"primereact/ripple";import{UniqueComponentId as f,DomHandler as g,ZIndexUtils as b,classNames as y,mergeProps as h,ObjectUtils as v,IconUtils as w}from"primereact/utils";import{ComponentBase as S}from"primereact/componentbase";function x(e){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x(e)}function E(e,t){if("object"!==x(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==x(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function z(e){var t=E(e,"string");return"symbol"===x(t)?t:String(t)}function k(e,t,n){return(t=z(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function I(e){if(Array.isArray(e))return C(e)}function O(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function D(e,t){if(e){if("string"==typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?C(e,t):void 0}}function P(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function R(e){if(Array.isArray(e))return e}function N(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return l}}function j(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function M(e,t){return R(e)||N(e,t)||D(e,t)||j()}var X=S.extend({defaultProps:{__TYPE:"Dialog",appendTo:null,ariaCloseIconLabel:null,baseZIndex:0,blockScroll:!1,breakpoints:null,className:null,closable:!0,closeIcon:null,closeOnEscape:!0,contentClassName:null,contentStyle:null,dismissableMask:!1,draggable:!0,focusOnShow:!0,footer:null,header:null,headerClassName:null,headerStyle:null,icons:null,id:null,keepInViewport:!0,maskClassName:null,maskStyle:null,maximizable:!1,maximizeIcon:null,maximized:!1,minX:0,minY:0,minimizeIcon:null,modal:!0,onClick:null,onDrag:null,onDragEnd:null,onDragStart:null,onHide:null,onMaskClick:null,onMaximize:null,onResize:null,onResizeEnd:null,onResizeStart:null,onShow:null,position:"center",resizable:!0,rtl:!1,showHeader:!0,style:null,transitionOptions:null,visible:!1,children:void 0}});function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(Object(n),!0).forEach((function(t){k(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var A=e.forwardRef((function(S,x){var E=e.useContext(n),z=X.getProps(S,E),k=z.id?z.id:f(),C=M(e.useState(k),2),R=C[0],N=M(e.useState(!1),2),j=N[0],H=N[1],A=M(e.useState(!1),2),Y=A[0],B=A[1],V=M(e.useState(z.maximized),2),_=V[0],J=V[1],Z=e.useRef(null),L=e.useRef(null),W=e.useRef(null),F=e.useRef(null),U=e.useRef(null),$=e.useRef(null),K=e.useRef(null),q=e.useRef(!1),G=e.useRef(!1),Q=e.useRef(null),ee=e.useRef(null),te=e.useRef(null),ne=e.useRef(k),re=z.onMaximize?z.maximized:_,oe=X.setMetaData({props:z,state:{id:R,maximized:re,containerVisible:j}}).ptm,ie=M(i({type:"keydown",listener:function(e){return ze(e)}}),2),ae=ie[0],le=ie[1],ce=M(i({type:"mousemove",target:function(){return window.document},listener:function(e){return Pe(e)}}),2),ue=ce[0],se=ce[1],me=M(i({type:"mouseup",target:function(){return window.document},listener:function(e){return Re(e)}}),2),de=me[0],pe=me[1],fe=M(i({type:"mousemove",target:function(){return window.document},listener:function(e){return Ce(e)}}),2),ge=fe[0],be=fe[1],ye=M(i({type:"mouseup",target:function(){return window.document},listener:function(e){return Ie(e)}}),2),he=ye[0],ve=ye[1],we=function(e){z.onHide(),e.preventDefault()},Se=function(e){W.current=e.target,z.onPointerDown&&z.onPointerDown(e)},xe=function(e){z.dismissableMask&&z.modal&&L.current===e.target&&!W.current&&we(e),z.onMaskClick&&z.onMaskClick(e),W.current=null},Ee=function(e){z.onMaximize?z.onMaximize({originalEvent:e,maximized:!re}):J((function(e){return!e})),e.preventDefault()},ze=function(e){var t=e.currentTarget;if(t&&t.primeDialogParams){var n=t.primeDialogParams,r=n.length,o=n[r-1]?n[r-1].id:void 0;if(o===R){var i=document.getElementById(o);if(z.closable&&z.closeOnEscape&&"Escape"===e.key)we(e),e.stopImmediatePropagation(),n.splice(r-1,1);else if("Tab"===e.key){e.preventDefault();var a=g.getFocusableElements(i);if(a&&a.length>0)if(document.activeElement){var l=a.indexOf(document.activeElement);e.shiftKey?-1===l||0===l?a[a.length-1].focus():a[l-1].focus():-1===l||l===a.length-1?a[0].focus():a[l+1].focus()}else a[0].focus()}}}},ke=function(e){g.hasClass(e.target,"p-dialog-header-icon")||g.hasClass(e.target.parentElement,"p-dialog-header-icon")||z.draggable&&(q.current=!0,Q.current=e.pageX,ee.current=e.pageY,Z.current.style.margin="0",g.addClass(document.body,"p-unselectable-text"),z.onDragStart&&z.onDragStart(e))},Ce=function(e){if(q.current){var t=g.getOuterWidth(Z.current),n=g.getOuterHeight(Z.current),r=e.pageX-Q.current,o=e.pageY-ee.current,i=Z.current.getBoundingClientRect(),a=i.left+r,l=i.top+o,c=g.getViewport();Z.current.style.position="fixed",z.keepInViewport?(a>=z.minX&&a+t<c.width&&(Q.current=e.pageX,Z.current.style.left=a+"px"),l>=z.minY&&l+n<c.height&&(ee.current=e.pageY,Z.current.style.top=l+"px")):(Q.current=e.pageX,Z.current.style.left=a+"px",ee.current=e.pageY,Z.current.style.top=l+"px"),z.onDrag&&z.onDrag(e)}},Ie=function(e){q.current&&(q.current=!1,g.removeClass(document.body,"p-unselectable-text"),z.onDragEnd&&z.onDragEnd(e))},Oe=function(e){z.resizable&&(G.current=!0,Q.current=e.pageX,ee.current=e.pageY,g.addClass(document.body,"p-unselectable-text"),z.onResizeStart&&z.onResizeStart(e))},De=function(e,t,n){!n&&(n=g.getViewport());var r=parseInt(e);return/^(\d+|(\.\d+))(\.\d+)?%$/.test(e)?r*(n[t]/100):r},Pe=function(e){if(G.current){var t=e.pageX-Q.current,n=e.pageY-ee.current,r=g.getOuterWidth(Z.current),o=g.getOuterHeight(Z.current),i=Z.current.getBoundingClientRect(),a=g.getViewport(),l=!parseInt(Z.current.style.top)||!parseInt(Z.current.style.left),c=De(Z.current.style.minWidth,"width",a),u=De(Z.current.style.minHeight,"height",a),s=r+t,m=o+n;l&&(s+=t,m+=n),(!c||s>c)&&i.left+s<a.width&&(Z.current.style.width=s+"px"),(!u||m>u)&&i.top+m<a.height&&(Z.current.style.height=m+"px"),Q.current=e.pageX,ee.current=e.pageY,z.onResize&&z.onResize(e)}},Re=function(e){G.current&&(G.current=!1,g.removeClass(document.body,"p-unselectable-text"),z.onResizeEnd&&z.onResizeEnd(e))},Ne=function(){Z.current.style.position="",Z.current.style.left="",Z.current.style.top="",Z.current.style.margin=""},je=function(){Z.current.setAttribute(ne.current,"")},Me=function(){var e;z.onShow&&z.onShow(),z.focusOnShow&&!((e=document.activeElement)&&Z.current&&Z.current.contains(e))&&z.closable&&z.showHeader&&K.current.focus(),Te()},Xe=function(){z.modal&&g.addClass(L.current,"p-component-overlay-leave"),z.blockScroll&&g.removeClass(document.body,"p-overflow-hidden")},He=function(){q.current=!1,b.clear(L.current),H(!1),Ae()},Te=function(){Ye(),(z.blockScroll||z.maximizable&&re)&&g.addClass(document.body,"p-overflow-hidden")},Ae=function(){Be();var e=z.maximizable&&re;z.modal?(document.primeDialogParams&&document.primeDialogParams.some((function(e){return e.hasBlockScroll}))||e)&&g.removeClass(document.body,"p-overflow-hidden"):(z.blockScroll||e)&&g.removeClass(document.body,"p-overflow-hidden")},Ye=function(){z.draggable&&(ge(),he()),z.resizable&&(ue(),de()),ae();var e,t={id:R,hasBlockScroll:z.blockScroll};document.primeDialogParams=document.primeDialogParams?[].concat(I(e=document.primeDialogParams)||O(e)||D(e)||P(),[t]):[t]},Be=function(){be(),ve(),se(),pe(),le(),document.primeDialogParams=document.primeDialogParams&&document.primeDialogParams.filter((function(e){return e.id!==R}))},Ve=function(){te.current=g.createInlineStyle(E&&E.nonce||t.nonce);var e="";for(var n in z.breakpoints)e+="\n                @media screen and (max-width: ".concat(n,") {\n                    .p-dialog[").concat(ne.current,"] {\n                        width: ").concat(z.breakpoints[n]," !important;\n                    }\n                }\n            ");te.current.innerHTML=e};a((function(){z.visible&&H(!0),z.breakpoints&&Ve()})),l((function(){z.visible&&!j&&H(!0),z.visible!==Y&&j&&B(z.visible)})),l((function(){j&&(b.set("modal",L.current,E&&E.autoZIndex||t.autoZIndex,z.baseZIndex||E&&E.zIndex.modal||t.zIndex.modal),B(!0))}),[j]),l((function(){z.blockScroll||g[re&&Y?"addClass":"removeClass"](document.body,"p-overflow-hidden")}),[z.maximized,_,Y]),c((function(){Ae(),g.removeInlineStyle(te.current),b.clear(L.current)})),e.useImperativeHandle(x,(function(){return{props:z,resetPosition:Ne,getElement:function(){return Z.current},getMask:function(){return L.current},getContent:function(){return F.current},getHeader:function(){return U.current},getFooter:function(){return $.current},getCloseButton:function(){return K.current}}}));var _e,Je,Ze,Le,We,Fe,Ue,$e,Ke,qe,Ge,Qe,et=function(){if(z.closable){var t=z.ariaCloseIconLabel||r("close"),n=h({className:"p-dialog-header-close-icon","aria-hidden":!0},oe("closeButtonIcon")),o=w.getJSXIcon(z.closeIcon||e.createElement(u,n),T({},n),{props:z}),i=h({ref:K,type:"button",className:"p-dialog-header-icon p-dialog-header-close p-link","aria-label":t,onClick:we},oe("closeButton"));return e.createElement("button",i,o,e.createElement(p,null))}return null},tt=function(){var t=h({className:"p-dialog-header-maximize-icon"},oe("maximizableIcon")),n=w.getJSXIcon(re?z.minimizeIcon||e.createElement(m,t):z.maximizeIcon||e.createElement(s,t),t,{props:z});if(z.maximizable){var r=h({type:"button",className:"p-dialog-header-icon p-dialog-header-maximize p-link",onClick:Ee},oe("maximizableButton"));return e.createElement("button",r,n,e.createElement(p,null))}return null},nt=function(){if(z.showHeader){var t=et(),n=tt(),r=v.getJSXElement(z.icons,z),o=v.getJSXElement(z.header,z),i=R+"_header",a=y("p-dialog-header",z.headerClassName),l=h({ref:U,style:z.headerStyle,className:a,onMouseDown:ke},oe("header")),c=h({id:i,className:"p-dialog-title"},oe("headerTitle")),u=h({className:"p-dialog-header-icons"},oe("headerIcons"));return e.createElement("div",l,e.createElement("div",c,o),e.createElement("div",u,r,n,t))}return null},rt=function(){var t=y("p-dialog-content",z.contentClassName),n=h({id:R+"_content",ref:F,style:z.contentStyle,className:t},oe("content"));return e.createElement("div",n,z.children)},ot=function(){var t=v.getJSXElement(z.footer,z),n=h({ref:$,className:"p-dialog-footer"},oe("footer"));return t&&e.createElement("div",n,t)};return j&&(Je=y("p-dialog p-component",z.className,{"p-dialog-rtl":z.rtl,"p-dialog-maximized":re,"p-dialog-default":!re,"p-input-filled":E&&"filled"===E.inputStyle||"filled"===t.inputStyle,"p-ripple-disabled":E&&!1===E.ripple||!1===t.ripple}),Ze=y("p-dialog-mask",(_e=["center","left","right","top","top-left","top-right","bottom","bottom-left","bottom-right"].find((function(e){return e===z.position||e.replace("-","")===z.position})))?"p-dialog-".concat(_e):"",{"p-component-overlay p-component-overlay-enter":z.modal,"p-dialog-visible":j,"p-dialog-draggable":z.draggable,"p-dialog-resizable":z.resizable},z.maskClassName),Le=nt(),We=rt(),Fe=ot(),Ue=z.resizable?e.createElement("span",{className:"p-resizable-handle",style:{zIndex:90},onMouseDown:Oe}):null,$e=R+"_header",Ke=R+"_content",qe={enter:"center"===z.position?150:300,exit:"center"===z.position?150:300},Ge=h({ref:L,style:z.maskStyle,className:Ze,onPointerUp:xe},oe("mask")),Qe=h({ref:Z,id:R,className:Je,style:z.style,onClick:z.onClick,role:"dialog","aria-labelledby":$e,"aria-describedby":Ke,"aria-modal":z.modal,onPointerDown:Se},X.getOtherProps(z),oe("root")),e.createElement(d,{element:e.createElement("div",Ge,e.createElement(o,{nodeRef:Z,classNames:"p-dialog",timeout:qe,in:Y,options:z.transitionOptions,unmountOnExit:!0,onEnter:je,onEntered:Me,onExiting:Xe,onExited:He},e.createElement("div",Qe,Le,We,Fe,Ue))),appendTo:z.appendTo,visible:!0}))}));A.displayName="Dialog";export{A as Dialog};
