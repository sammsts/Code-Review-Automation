import*as e from"react";import t,{PrimeReactContext as r}from"primereact/api";import{useResizeListener as n,useOverlayScrollListener as o,useMountEffect as u,useUpdateEffect as i,useUnmountEffect as a}from"primereact/hooks";import{Portal as l}from"primereact/portal";import{DomHandler as c,ZIndexUtils as s,ObjectUtils as f,classNames as p,mergeProps as d}from"primereact/utils";import{ComponentBase as m}from"primereact/componentbase";function v(e){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}function h(e,t){if("object"!==v(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==v(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function y(e){var t=h(e,"string");return"symbol"===v(t)?t:String(t)}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function b(e){if(Array.isArray(e))return g(e)}function E(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function w(e,t){if(e){if("string"==typeof e)return g(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?g(e,t):void 0}}function T(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function x(e){if(Array.isArray(e))return e}function S(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,u,i,a=[],l=!0,c=!1;try{if(u=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=u.call(r)).done)&&(a.push(n.value),a.length!==t);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw o}}return a}}function I(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function k(e,t){return x(e)||S(e,t)||w(e,t)||I()}var A=m.extend({defaultProps:{__TYPE:"Tooltip",appendTo:null,at:null,autoHide:!0,autoZIndex:!0,baseZIndex:0,className:null,content:null,disabled:!1,event:null,hideDelay:0,hideEvent:"mouseleave",id:null,mouseTrack:!1,mouseTrackLeft:5,mouseTrackTop:5,my:null,onBeforeHide:null,onBeforeShow:null,onHide:null,onShow:null,position:"right",showDelay:0,showEvent:"mouseenter",showOnDisabled:!1,style:null,target:null,updateDelay:0,children:void 0}}),C=e.memo(e.forwardRef((function(m,v){var h=e.useContext(r),g=A.getProps(m,h),x=k(e.useState(!1),2),S=x[0],I=x[1],C=k(e.useState(g.position),2),O=C[0],D=C[1],N=k(e.useState(""),2),j=N[0],H=N[1],L=A.setMetaData({props:g,state:{visible:S,position:O,className:j}}).ptm,R=e.useRef(null),P=e.useRef(null),W=e.useRef(null),Z=e.useRef(null),B=e.useRef(!0),M=e.useRef({}),F=e.useRef(null),z=k(n({listener:function(e){!c.isTouchDevice()&&ue(e)}}),2),Y=z[0],_=z[1],U=k(o({target:W.current,listener:function(e){ue(e)},when:S}),2),X=U[0],$=U[1],q=function(e){return Q(e,"mousetrack")||g.mouseTrack},G=function(e){return"true"===Q(e,"disabled")||V(e,"disabled")||g.disabled},J=function(e){return Q(e,"showondisabled")||g.showOnDisabled},K=function(){return Q(W.current,"autohide")||g.autoHide},Q=function(e,t){return V(e,"data-pr-".concat(t))?e.getAttribute("data-pr-".concat(t)):null},V=function(e,t){return e&&e.hasAttribute(t)},ee=function(e){var t=[Q(e,"showevent")||g.showEvent],r=[Q(e,"hideevent")||g.hideEvent];if(q(e))t=["mousemove"],r=["mouseleave"];else{var n=Q(e,"event")||g.event;"focus"===n&&(t=["focus"],r=["blur"]),"both"===n&&(t=["focus","mouseenter"],r=["blur","mouseleave"])}return{showEvents:t,hideEvents:r}},te=function(e){return{top:Q(e,"mousetracktop")||g.mouseTrackTop,left:Q(e,"mousetrackleft")||g.mouseTrackLeft}},re=function(e,t){if(P.current){var r=Q(e,"tooltip")||g.content;r?(P.current.innerHTML="",P.current.appendChild(document.createTextNode(r)),t()):g.children&&t()}},ne=function(e){re(W.current,(function(){var r=F.current,n=r.pageX,o=r.pageY;g.autoZIndex&&!s.get(R.current)&&s.set("tooltip",R.current,h&&h.autoZIndex||t.autoZIndex,g.baseZIndex||h&&h.zIndex.tooltip||t.zIndex.tooltip),R.current.style.left="",R.current.style.top="",K()&&(R.current.style.pointerEvents="none"),!q(W.current)&&"mouse"!=e||Z.current||(Z.current={width:c.getOuterWidth(R.current),height:c.getOuterHeight(R.current)}),ie(W.current,{x:n,y:o},e)}))},oe=function(e){W.current=e.currentTarget;var t,r=G(W.current);(t=J(W.current)&&r?W.current.firstChild:W.current,!(g.content||Q(t,"tooltip")||g.children))||r||(F.current=e,S?fe("updateDelay",ne):pe(g.onBeforeShow,{originalEvent:e,target:W.current})&&fe("showDelay",(function(){I(!0),pe(g.onShow,{originalEvent:e,target:W.current})})))},ue=function(e){(de(),S)&&(pe(g.onBeforeHide,{originalEvent:e,target:W.current})&&fe("hideDelay",(function(){(K()||!1!==B.current)&&(s.clear(R.current),c.removeClass(R.current,"p-tooltip-active"),I(!1),pe(g.onHide,{originalEvent:e,target:W.current}))})))},ie=function(e,t,r){var n=0,o=0,u=r||O;if((q(e)||"mouse"==u)&&t){var i={width:c.getOuterWidth(R.current),height:c.getOuterHeight(R.current)};n=t.x,o=t.y;var a=te(e),l=a.top,s=a.left;switch(u){case"left":n-=i.width+s,o-=i.height/2-l;break;case"right":case"mouse":n+=s,o-=i.height/2-l;break;case"top":n-=i.width/2-s,o-=i.height+l;break;case"bottom":n-=i.width/2-s,o+=l}n<=0||Z.current.width>i.width?(R.current.style.left="0px",R.current.style.right=window.innerWidth-i.width-n+"px"):(R.current.style.right="",R.current.style.left=n+"px"),R.current.style.top=o+"px",c.addClass(R.current,"p-tooltip-active")}else{var f=c.findCollisionPosition(u),p=Q(e,"my")||g.my||f.my,d=Q(e,"at")||g.at||f.at;R.current.style.padding="0px",c.flipfitCollision(R.current,e,p,d,(function(e){var t=e.at,r=t.x,n=g.at?"center"!==r&&r!==e.my.x?r:t.y:e.at["".concat(f.axis)];R.current.style.padding="",D(n),ae(n),c.addClass(R.current,"p-tooltip-active")}))}},ae=function(e){if(R.current){var t=getComputedStyle(R.current);"left"===e?R.current.style.left=parseFloat(t.left)-2*parseFloat(t.paddingLeft)+"px":"top"===e&&(R.current.style.top=parseFloat(t.top)-2*parseFloat(t.paddingTop)+"px")}},le=function(e){K()||(B.current=!0,ue(e))},ce=function(e){if(e){var t=ee(e),r=t.showEvents,n=t.hideEvents,o=me(e);r.forEach((function(e){return null==o?void 0:o.addEventListener(e,oe)})),n.forEach((function(e){return null==o?void 0:o.addEventListener(e,ue)}))}},se=function(e){if(e){var t=ee(e),r=t.showEvents,n=t.hideEvents,o=me(e);r.forEach((function(e){return null==o?void 0:o.removeEventListener(e,oe)})),n.forEach((function(e){return null==o?void 0:o.removeEventListener(e,ue)}))}},fe=function(e,t){de();var r=Q(W.current,e.toLowerCase())||g[e];r?M.current["".concat(e)]=setTimeout((function(){return t()}),r):t()},pe=function(e){if(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=e.apply(void 0,r);return void 0===o&&(o=!0),o}return!0},de=function(){Object.values(M.current).forEach((function(e){return clearTimeout(e)}))},me=function(e){if(e){if(J(e)){if(e.hasWrapper)return e.parentElement;var t=document.createElement("span");return c.addClass(t,"p-tooltip-target-wrapper"),e.parentNode.insertBefore(t,e),t.appendChild(e),e.hasWrapper=!0,t}var r;return e.hasWrapper&&((r=e.parentElement).replaceWith.apply(r,b(n=e.parentElement.childNodes)||E(n)||w(n)||T()),delete e.hasWrapper),e}var n;return null},ve=function(e){ye(e),he(e)},he=function(e){ge(e||g.target,ce)},ye=function(e){ge(e||g.target,se)},ge=function(e,t){if(e=f.getRefElement(e))if(c.isElement(e))t(e);else{var r=function(e){c.find(document,e).forEach((function(e){t(e)}))};e instanceof Array?e.forEach((function(e){r(e)})):r(e)}};u((function(){he(),S&&W.current&&G(W.current)&&ue()})),i((function(){return he(),function(){ye()}}),[oe,ue,g.target]),i((function(){if(S){var e=Q(W.current,"position")||O,t=Q(W.current,"classname");D(e),H(t),ne(e),Y(),X()}else D(g.position),H(""),W.current=null,Z.current=null,B.current=!0;return function(){_(),$()}}),[S]),i((function(){S&&fe("updateDelay",(function(){re(W.current,(function(){ie(W.current)}))}))}),[g.content]),a((function(){de(),ye(),s.clear(R.current)})),e.useImperativeHandle(v,(function(){return{props:g,updateTargetEvents:ve,loadTargetEvents:he,unloadTargetEvents:ye,show:oe,hide:ue,getElement:function(){return R.current},getTarget:function(){return W.current}}}));var be,Ee,we,Te,xe,Se,Ie,ke,Ae;if(S){var Ce=(xe=p("p-tooltip p-component",(be={},Ee="p-tooltip-".concat(O),we=!0,(Ee=y(Ee))in be?Object.defineProperty(be,Ee,{value:we,enumerable:!0,configurable:!0,writable:!0}):be[Ee]=we,be),g.className,j),Te=W.current,Se=!(g.content||Q(Te,"tooltip")),Ie=d({id:g.id,ref:R,className:xe,style:g.style,role:"tooltip","aria-hidden":S,onMouseEnter:function(e){K()||(B.current=!1)},onMouseLeave:function(e){return le(e)}},A.getOtherProps(g),L("root")),ke=d({className:"p-tooltip-arrow"},L("arrow")),Ae=d({ref:P,className:"p-tooltip-text"},L("text")),e.createElement("div",Ie,e.createElement("div",ke),e.createElement("div",Ae,Se&&g.children)));return e.createElement(l,{element:Ce,appendTo:g.appendTo,visible:!0})}return null})));C.displayName="Tooltip";export{C as Tooltip};
