import*as e from"react";import{SearchIcon as n}from"primereact/icons/search";import{SpinnerIcon as t}from"primereact/icons/spinner";import{mergeProps as o,classNames as r,DomHandler as l,ObjectUtils as a,IconUtils as i}from"primereact/utils";import{ComponentBase as c}from"primereact/componentbase";import{ariaLabel as d,PrimeReactContext as p}from"primereact/api";import{CheckIcon as u}from"primereact/icons/check";import{ChevronDownIcon as s}from"primereact/icons/chevrondown";import{ChevronRightIcon as f}from"primereact/icons/chevronright";import{MinusIcon as g}from"primereact/icons/minus";import{Ripple as m}from"primereact/ripple";function y(){return y=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},y.apply(this,arguments)}function h(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,o=new Array(n);t<n;t++)o[t]=e[t];return o}function v(e){if(Array.isArray(e))return h(e)}function b(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function S(e,n){if(e){if("string"==typeof e)return h(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?h(e,n):void 0}}function x(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function E(e){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E(e)}function C(e,n){if("object"!==E(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var o=t.call(e,n||"default");if("object"!==E(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}function k(e){var n=C(e,"string");return"symbol"===E(n)?n:String(n)}function D(e,n,t){return(n=k(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function O(e){if(Array.isArray(e))return e}function N(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var o,r,l,a,i=[],c=!0,d=!1;try{if(l=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;c=!1}else for(;!(c=(o=l.call(t)).done)&&(i.push(o.value),i.length!==n);c=!0);}catch(e){d=!0,r=e}finally{try{if(!c&&null!=t.return&&(a=t.return(),Object(a)!==a))return}finally{if(d)throw r}}return i}}function w(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function K(e,n){return O(e)||N(e,n)||S(e,n)||w()}var I=c.extend({defaultProps:{__TYPE:"Tree",id:null,value:null,checkboxIcon:null,disabled:!1,selectionMode:null,selectionKeys:null,onSelectionChange:null,contextMenuSelectionKey:null,onContextMenuSelectionChange:null,expandedKeys:null,style:null,className:null,contentStyle:null,contentClassName:null,metaKeySelection:!0,propagateSelectionUp:!0,propagateSelectionDown:!0,loading:!1,loadingIcon:null,expandIcon:null,collapseIcon:null,dragdropScope:null,header:null,footer:null,showHeader:!0,filter:!1,filterIcon:null,filterValue:null,filterBy:"label",filterMode:"lenient",filterPlaceholder:null,filterLocale:void 0,filterTemplate:null,nodeTemplate:null,togglerTemplate:null,onSelect:null,onUnselect:null,onExpand:null,onCollapse:null,onToggle:null,onDragDrop:null,onContextMenu:null,onFilterValueChange:null,onNodeClick:null,onNodeDoubleClick:null,children:void 0}});function T(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=M(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,a=!0,i=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){i=!0,l=e},f:function(){try{a||null==t.return||t.return()}finally{if(i)throw l}}}}function M(e,n){if(e){if("string"==typeof e)return P(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?P(e,n):void 0}}function P(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,o=new Array(n);t<n;t++)o[t]=e[t];return o}function j(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function U(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?j(Object(t),!0).forEach((function(n){D(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):j(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var L=e.memo((function(n){var t,c,p,y,h,v=e.useRef(null),b=e.useRef(!1),S=n.isNodeLeaf(n.node),x=!!n.expandedKeys&&void 0!==n.expandedKeys[n.node.key]||n.node.expanded,E=function(e){return n.ptm(e,{context:{selected:n.selected,expanded:x,checked:n.checked}})},C=function(e){var t=n.expandedKeys?U({},n.expandedKeys):{};t[n.node.key]=!0,n.onToggle({originalEvent:e,value:t}),O(e,!0)},k=function(e){var t=U({},n.expandedKeys);delete t[n.node.key],n.onToggle({originalEvent:e,value:t}),O(e,!1)},D=function(e){n.disabled||(x?k(e):C(e),e.preventDefault(),e.stopPropagation())},O=function(e,t){t?n.onExpand&&n.onExpand({originalEvent:e,node:n.node}):n.onCollapse&&n.onCollapse({originalEvent:e,node:n.node})},N=function(e){if(!n.disabled){var t=e.target.parentElement;if(l.hasClass(t,"p-treenode"))switch(e.which){case 40:var o=t.children[1];if(o)M(o.children[0]);else{for(var r=t.nextElementSibling;r&&l.hasClass(r,"p-treenode-droppoint");)r=r.nextElementSibling;if(r)M(r);else{var a=w(t);a&&M(a)}}e.preventDefault();break;case 38:if(t.previousElementSibling)M(K(t.previousElementSibling));else{var i=I(t);i&&M(i)}e.preventDefault();break;case 39:x||C(e),e.preventDefault();break;case 37:x&&k(e),e.preventDefault();break;case 13:P(e),e.preventDefault()}}},w=function e(n){var t=I(n);return t?t.nextElementSibling||e(t):null},K=function e(n){var t=n.children[1];return t?e(t.children[t.children.length-1]):n},I=function(e){var n=e.parentElement.parentElement;return l.hasClass(n,"p-treenode")?n:null},M=function(e){e&&e.children[0]&&e.children[0].focus()},P=function(e){n.onClick&&n.onClick({originalEvent:e,node:n.node});var t=e.target.nodeName;if(!n.disabled&&"INPUT"!==t&&"BUTTON"!==t&&"A"!==t&&!l.hasClass(e.target,"p-clickable")){if(n.selectionMode&&!1!==n.node.selectable){var o;if(H()){var r=X();o=n.selectionKeys?U({},n.selectionKeys):{},r?(n.propagateSelectionDown?F(n.node,!1,o):delete o[n.node.key],n.propagateSelectionUp&&n.onPropagateUp&&n.onPropagateUp({originalEvent:e,check:!1,selectionKeys:o}),n.onUnselect&&n.onUnselect({originalEvent:e,node:n.node})):(n.propagateSelectionDown?F(n.node,!0,o):o[n.node.key]={checked:!0},n.propagateSelectionUp&&n.onPropagateUp&&n.onPropagateUp({originalEvent:e,check:!0,selectionKeys:o}),n.onSelect&&n.onSelect({originalEvent:e,node:n.node}))}else{var a=R();if(!b.current&&n.metaKeySelection){var i=e.metaKey||e.ctrlKey;a&&i?(V()?o=null:delete(o=U({},n.selectionKeys))[n.node.key],n.onUnselect&&n.onUnselect({originalEvent:e,node:n.node})):(V()?o=n.node.key:B()&&((o=i&&n.selectionKeys?U({},n.selectionKeys):{})[n.node.key]=!0),n.onSelect&&n.onSelect({originalEvent:e,node:n.node}))}else V()?a?(o=null,n.onUnselect&&n.onUnselect({originalEvent:e,node:n.node})):(o=n.node.key,n.onSelect&&n.onSelect({originalEvent:e,node:n.node})):a?(delete(o=U({},n.selectionKeys))[n.node.key],n.onUnselect&&n.onUnselect({originalEvent:e,node:n.node})):((o=n.selectionKeys?U({},n.selectionKeys):{})[n.node.key]=!0,n.onSelect&&n.onSelect({originalEvent:e,node:n.node}))}n.onSelectionChange&&n.onSelectionChange({originalEvent:e,value:o})}b.current=!1}},j=function(e){n.onDoubleClick&&n.onDoubleClick({originalEvent:e,node:n.node})},A=function(e){n.disabled||(l.clearSelection(),n.onContextMenuSelectionChange&&n.onContextMenuSelectionChange({originalEvent:e,value:n.node.key}),n.onContextMenu&&n.onContextMenu({originalEvent:e,node:n.node}))},J=function(e){var t,o=e.check,r=e.selectionKeys,l=0,a=!1,i=T(n.node.children);try{for(i.s();!(t=i.n()).done;){var c=t.value;r[c.key]&&r[c.key].checked?l++:r[c.key]&&r[c.key].partialChecked&&(a=!0)}}catch(e){i.e(e)}finally{i.f()}o&&l===n.node.children.length?r[n.node.key]={checked:!0,partialChecked:!1}:(o||delete r[n.node.key],a||l>0&&l!==n.node.children.length?r[n.node.key]={checked:!1,partialChecked:!0}:delete r[n.node.key]),n.propagateSelectionUp&&n.onPropagateUp&&n.onPropagateUp(e)},F=function e(n,t,o){if(t?o[n.key]={checked:!0,partialChecked:!1}:delete o[n.key],n.children&&n.children.length)for(var r=0;r<n.children.length;r++)e(n.children[r],t,o)},R=function(){return!(!n.selectionMode||!n.selectionKeys)&&(V()?n.selectionKeys===n.node.key:void 0!==n.selectionKeys[n.node.key])},X=function(){return!!n.selectionKeys&&(n.selectionKeys[n.node.key]&&n.selectionKeys[n.node.key].checked)},V=function(){return n.selectionMode&&"single"===n.selectionMode},B=function(){return n.selectionMode&&"multiple"===n.selectionMode},H=function(){return n.selectionMode&&"checkbox"===n.selectionMode},$=function(){b.current=!0},_=function(e,t){(e.preventDefault(),!1!==n.node.droppable)&&(l.removeClass(e.target,"p-treenode-droppoint-active"),n.onDropPoint&&n.onDropPoint({originalEvent:e,path:n.path,index:-1===t?n.index:n.index+1,position:t}))},Y=function(e){e.dataTransfer.types[1]===n.dragdropScope.toLocaleLowerCase()&&(e.dataTransfer.dropEffect="move",e.preventDefault())},q=function(e){e.dataTransfer.types[1]===n.dragdropScope.toLocaleLowerCase()&&l.addClass(e.target,"p-treenode-droppoint-active")},z=function(e){e.dataTransfer.types[1]===n.dragdropScope.toLocaleLowerCase()&&l.removeClass(e.target,"p-treenode-droppoint-active")},G=function(e){n.dragdropScope&&!1!==n.node.droppable&&(l.removeClass(v.current,"p-treenode-dragover"),e.preventDefault(),e.stopPropagation(),n.onDrop&&n.onDrop({originalEvent:e,path:n.path,index:n.index}))},Q=function(e){e.dataTransfer.types[1]===n.dragdropScope.toLocaleLowerCase()&&!1!==n.node.droppable&&(e.dataTransfer.dropEffect="move",e.preventDefault(),e.stopPropagation())},W=function(e){e.dataTransfer.types[1]===n.dragdropScope.toLocaleLowerCase()&&!1!==n.node.droppable&&l.addClass(v.current,"p-treenode-dragover")},Z=function(e){if(e.dataTransfer.types[1]===n.dragdropScope.toLocaleLowerCase()&&!1!==n.node.droppable){var t=e.currentTarget.getBoundingClientRect();(e.nativeEvent.x>t.left+t.width||e.nativeEvent.x<t.left||e.nativeEvent.y>=Math.floor(t.top+t.height)||e.nativeEvent.y<t.top)&&l.removeClass(v.current,"p-treenode-dragover")}},ee=function(e){e.dataTransfer.setData("text",n.dragdropScope),e.dataTransfer.setData(n.dragdropScope,n.dragdropScope),n.onDragStart&&n.onDragStart({originalEvent:e,path:n.path,index:n.index})},ne=function(e){n.onDragEnd&&n.onDragEnd({originalEvent:e})},te=function(){var t=o({className:"p-treenode-label"},E("label")),r=e.createElement("span",t,n.node.label);n.nodeTemplate&&(r=a.getJSXElement(n.nodeTemplate,n.node,{onTogglerClick:D,className:"p-treenode-label",element:r,props:n,expanded:x}));return r},oe=function(){if(H()&&!1!==n.node.selectable){var t=X(),l=!!n.selectionKeys&&n.selectionKeys[n.node.key]&&n.selectionKeys[n.node.key].partialChecked,a=r("p-checkbox-box",{"p-highlight":t,"p-indeterminate":l,"p-disabled":n.disabled}),c=o({className:"p-checkbox-icon p-c"},E("checkboxIcon")),d=i.getJSXIcon(t?n.checkboxIcon||e.createElement(u,c):l?n.checkboxIcon||e.createElement(g,c):null,U({},c),n),p=o({className:"p-checkbox p-component"},E("checkboxContainer")),s=o({className:a,role:"checkbox","aria-checked":t},E("checkbox"));return e.createElement("div",p,e.createElement("div",s,d))}return null},re=function(){var t=n.node.icon||(x?n.node.expandedIcon:n.node.collapsedIcon);if(t){var l=r("p-treenode-icon",t),a=o({className:l},E("nodeIcon"));return e.createElement("span",a)}return null},le=function(){var t=d(x?"collapseLabel":"expandLabel"),r=o({className:{className:"p-tree-toggler-icon","aria-hidden":!0}},E("togglerIcon")),l=i.getJSXIcon(x?n.collapseIcon||e.createElement(s,r):n.expandIcon||e.createElement(f,r),U({},r),{props:n,expanded:x}),c=o({type:"button",className:"p-tree-toggler p-link",tabIndex:-1,onClick:D,"aria-label":t},E("toggler")),p=e.createElement("button",c,l,e.createElement(m,null));n.togglerTemplate&&(p=a.getJSXElement(n.togglerTemplate,n.node,{onClick:D,containerClassName:"p-tree-toggler p-link",iconClassName:"p-tree-toggler-icon",element:p,props:n,expanded:x}));return p},ae=function(t){if(n.dragdropScope){var r=o({className:"p-treenode-droppoint",onDrop:function(e){return _(e,t)},onDragOver:Y,onDragEnter:q,onDragLeave:z},E("droppoint"));return e.createElement("li",r)}return null},ie=function(){var t=R(),l=X(),a=r("p-treenode-content",n.node.className,{"p-treenode-selectable":n.selectionMode&&!1!==n.node.selectable,"p-highlight":H()?l:t,"p-highlight-contextmenu":n.contextMenuSelectionKey&&n.contextMenuSelectionKey===n.node.key,"p-disabled":n.disabled}),i=le(),c=oe(),d=re(),p=te(),u=o({ref:v,className:a,style:n.node.style,onClick:P,onDoubleClick:j,onContextMenu:A,onTouchEnd:$,draggable:n.dragdropScope&&!1!==n.node.draggable&&!n.disabled,onDrop:G,onDragOver:Q,onDragEnter:W,onDragLeave:Z,onDragStart:ee,onDragEnd:ne,tabIndex:n.disabled?void 0:0,onKeyDown:N,role:"treeitem","aria-posinset":n.index+1,"aria-expanded":x,"aria-selected":l||t},E("content"));return e.createElement("div",u,i,c,d,p)},ce=(c=r("p-treenode",{"p-treenode-leaf":S},n.node.className),p=ie(),t=o({className:"p-treenode-children",role:"group"},E("subgroup")),y=a.isNotEmpty(n.node.children)&&x?e.createElement("ul",t,n.node.children.map((function(t,o){return e.createElement(L,{key:t.key||t.label,node:t,parent:n.node,index:o,last:o===n.node.children.length-1,path:n.path+"-"+o,disabled:n.disabled,selectionMode:n.selectionMode,selectionKeys:n.selectionKeys,onSelectionChange:n.onSelectionChange,metaKeySelection:n.metaKeySelection,propagateSelectionDown:n.propagateSelectionDown,propagateSelectionUp:n.propagateSelectionUp,contextMenuSelectionKey:n.contextMenuSelectionKey,onContextMenuSelectionChange:n.onContextMenuSelectionChange,onContextMenu:n.onContextMenu,onExpand:n.onExpand,onCollapse:n.onCollapse,onSelect:n.onSelect,onUnselect:n.onUnselect,onClick:n.onClick,onDoubleClick:n.onDoubleClick,expandedKeys:n.expandedKeys,onToggle:n.onToggle,onPropagateUp:J,nodeTemplate:n.nodeTemplate,togglerTemplate:n.togglerTemplate,isNodeLeaf:n.isNodeLeaf,dragdropScope:n.dragdropScope,onDragStart:n.onDragStart,onDragEnd:n.onDragEnd,onDrop:n.onDrop,onDropPoint:n.onDropPoint,ptm:n.ptm})}))):null,h=o({className:c,style:n.node.style},E("node")),e.createElement("li",h,p,y));if(n.dragdropScope&&!n.disabled){var de=ae(-1),pe=n.last?ae(1):null;return e.createElement(e.Fragment,null,de,ce,pe)}return ce}));function A(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function J(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?A(Object(t),!0).forEach((function(n){D(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):A(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function F(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=R(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,a=!0,i=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){i=!0,l=e},f:function(){try{a||null==t.return||t.return()}finally{if(i)throw l}}}}function R(e,n){if(e){if("string"==typeof e)return X(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?X(e,n):void 0}}function X(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,o=new Array(n);t<n;t++)o[t]=e[t];return o}L.displayName="UITreeNode";var V=e.memo(e.forwardRef((function(c,d){var u=e.useContext(p),s=I.getProps(c,u),f=K(e.useState(""),2),g=f[0],m=f[1],h=K(e.useState(s.expandedKeys),2),E=h[0],C=h[1],k=e.useRef(null),D=e.useRef([]),O=e.useRef(null),N=e.useRef(!1),w=s.onFilterValueChange?s.filterValue:g,T=s.onToggle?s.expandedKeys:E,M=I.setMetaData({props:s,state:{filterValue:w,expandedKeys:T}}).ptm,P={filter:function(e){return z(e)},reset:function(){return ee()}},j=function(e){s.onToggle?s.onToggle(e):C(e.value)},U=function(e){O.current={path:e.path,index:e.index}},A=function(){O.current=null},R=function(e){if(B(O.current.path,e.path)){var n=JSON.parse(JSON.stringify(s.value)),t=O.current.path.split("-");t.pop();var o=_(n,t),r=o?o.children[O.current.index]:n[O.current.index],l=_(n,e.path.split("-"));l.children?l.children.push(r):l.children=[r],o?o.children.splice(O.current.index,1):n.splice(O.current.index,1),s.onDragDrop&&s.onDragDrop({originalEvent:e.originalEvent,value:n,dragNode:r,dropNode:l,dropIndex:e.index})}},X=function(e){if(H(e)){var n=JSON.parse(JSON.stringify(s.value)),t=O.current.path.split("-");t.pop();var o=e.path.split("-");o.pop();var r=_(n,t),l=_(n,o),a=r?r.children[O.current.index]:n[O.current.index],i=$(O.current.path,e.path);if(r?r.children.splice(O.current.index,1):n.splice(O.current.index,1),e.position<0){var c=i?O.current.index>e.index?e.index:e.index-1:e.index;l?l.children.splice(c,0,a):n.splice(c,0,a)}else l?l.children.push(a):n.push(a);s.onDragDrop&&s.onDragDrop({originalEvent:e.originalEvent,value:n,dragNode:a,dropNode:l,dropIndex:e.index})}},V=function(e,n){return!!e&&(e!==n&&0!==n.indexOf(e))},B=function(e,n){return!!V(e,n)&&!(e.indexOf("-")>0&&e.substring(0,e.lastIndexOf("-"))===n)},H=function(e){return!!V(O.current.path,e.path)&&(-1!==e.position||!$(O.current.path,e.path)||O.current.index+1!==e.index)},$=function(e,n){return 1===e.length&&1===n.length||e.substring(0,e.lastIndexOf("-"))===n.substring(0,n.lastIndexOf("-"))},_=function e(n,t){if(0===t.length)return null;var o=parseInt(t[0],10),r=n.children?n.children[o]:n[o];return 1===t.length?r:(t.shift(),e(r,t))},Y=function(e){return!1!==e.leaf&&!(e.children&&e.children.length)},q=function(e){13===e.which&&e.preventDefault()},z=function(e){N.current=!0;var n=e.target.value;s.onFilterValueChange?s.onFilterValueChange({originalEvent:e,value:n}):m(n)},G=function(e){m(a.isNotEmpty(e)?e:""),Q()},Q=function(){if(N.current){if(a.isEmpty(w))D.current=s.value;else{D.current=[];var e,n=s.filterBy.split(","),t=w.toLocaleLowerCase(s.filterLocale),o="strict"===s.filterMode,r=F(s.value);try{for(r.s();!(e=r.n()).done;){var l=J({},e.value),i={searchFields:n,filterText:t,isStrictMode:o};(o&&(W(l,i)||Z(l,i))||!o&&(Z(l,i)||W(l,i)))&&D.current.push(l)}}catch(e){r.e(e)}finally{r.f()}}N.current=!1}},W=function(e,n){if(e){var t=!1;if(e.children){var o=v(i=e.children)||b(i)||S(i)||x();e.children=[];var r,l=F(o);try{for(l.s();!(r=l.n()).done;){var a=J({},r.value);Z(a,n)&&(t=!0,e.children.push(a))}}catch(e){l.e(e)}finally{l.f()}}if(t)return e.expanded=!0,!0}var i},Z=function(e,n){var t,o=n.searchFields,r=n.filterText,l=n.isStrictMode,i=!1,c=F(o);try{for(c.s();!(t=c.n()).done;){String(a.resolveFieldData(e,t.value)).toLocaleLowerCase(s.filterLocale).indexOf(r)>-1&&(i=!0)}}catch(e){c.e(e)}finally{c.f()}return(!i||l&&!Y(e))&&(i=W(e,{searchFields:o,filterText:r,isStrictMode:l})||i),i},ee=function(){m("")};e.useImperativeHandle(d,(function(){return{props:s,filter:G,getElement:function(){return k.current}}}));var ne=function(n,t,o){return e.createElement(L,{key:n.key||n.label,node:n,index:t,last:o,path:String(t),checkboxIcon:s.checkboxIcon,expandIcon:s.expandIcon,collapseIcon:s.collapseIcon,disabled:s.disabled,selectionMode:s.selectionMode,selectionKeys:s.selectionKeys,onSelectionChange:s.onSelectionChange,metaKeySelection:s.metaKeySelection,contextMenuSelectionKey:s.contextMenuSelectionKey,onContextMenuSelectionChange:s.onContextMenuSelectionChange,onContextMenu:s.onContextMenu,propagateSelectionDown:s.propagateSelectionDown,propagateSelectionUp:s.propagateSelectionUp,onExpand:s.onExpand,onCollapse:s.onCollapse,onSelect:s.onSelect,onUnselect:s.onUnselect,expandedKeys:T,onToggle:j,nodeTemplate:s.nodeTemplate,togglerTemplate:s.togglerTemplate,isNodeLeaf:Y,dragdropScope:s.dragdropScope,onDragStart:U,onDragEnd:A,onDrop:R,onDropPoint:X,onClick:s.onNodeClick,onDoubleClick:s.onNodeDoubleClick,ptm:M})},te=function(){s.filter&&(N.current=!0,Q());var e=s.filter&&D.current?D.current:s.value;return e.map((function(n,t){return ne(n,t,t===e.length-1)}))},oe=function(){if(s.filter){var t=a.isNotEmpty(w)?w:"",r=o({className:"p-tree-filter-icon"},M("searchIcon")),l=i.getJSXIcon(s.filterIcon||e.createElement(n,r),J({},r),{props:s}),c=o({className:"p-tree-filter-container"},M("filterContainer")),d=o({type:"text",value:t,autoComplete:"off",className:"p-tree-filter p-inputtext p-component",placeholder:s.filterPlaceholder,onKeyDown:q,onChange:z,disabled:s.disabled},M("input")),p=e.createElement("div",c,e.createElement("input",d),l);if(s.filterTemplate)p=a.getJSXElement(s.filterTemplate,{className:"p-tree-filter-container",element:p,filterOptions:P,filterInputKeyDown:q,filterInputChange:z,filterIconClassName:"p-dropdown-filter-icon",props:s});return e.createElement(e.Fragment,null,p)}return null},re=I.getOtherProps(s),le=a.reduceKeys(re,l.ARIA_PROPS),ae=r("p-tree p-component",s.className,{"p-tree-selectable":s.selectionMode,"p-tree-loading":s.loading,"p-disabled":s.disabled}),ie=function(){if(s.loading){var n=o({className:"p-tree-loading-icon"},M("loadingIcon")),r=s.loadingIcon||e.createElement(t,y({},n,{spin:!0})),l=i.getJSXIcon(r,J({},n),{props:s}),a=o({className:"p-tree-loading-overlay p-component-overlay"},M("loadingOverlay"));return e.createElement("div",a,l)}return null}(),ce=function(){if(s.value){var n=te(),t=r("p-tree-container",s.contentClassName),l=o(J({className:t,role:"tree",style:s.contentStyle},le),M("container"));return e.createElement("ul",l,n)}return null}(),de=function(){if(s.showHeader){var n=oe(),t=n;if(s.header)t=a.getJSXElement(s.header,{filterContainerClassName:"p-tree-filter-container",filterIconClassName:"p-tree-filter-icon",filterInput:{className:"p-tree-filter p-inputtext p-component",onKeyDown:q,onChange:z},filterElement:n,element:t,props:s});var r=o({className:"p-tree-header"},M("header"));return e.createElement("div",r,t)}return null}(),pe=function(){var n=a.getJSXElement(s.footer,s),t=o({className:"p-tree-footer"},M("footer"));return e.createElement("div",t,n)}(),ue=o({ref:k,className:ae,style:s.style,id:s.id},I.getOtherProps(s),M("root"));return e.createElement("div",ue,ie,de,ce,pe)})));V.displayName="Tree";export{V as Tree};
