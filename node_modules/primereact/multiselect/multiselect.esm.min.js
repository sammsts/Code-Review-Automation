import*as e from"react";import t,{PrimeReactContext as n,localeOption as l,FilterService as r}from"primereact/api";import{useUpdateEffect as o,useMountEffect as i,useOverlayListener as a,useUnmountEffect as c}from"primereact/hooks";import{ChevronDownIcon as u}from"primereact/icons/chevrondown";import{TimesIcon as s}from"primereact/icons/times";import{TimesCircleIcon as p}from"primereact/icons/timescircle";import{OverlayService as f}from"primereact/overlayservice";import{Tooltip as m}from"primereact/tooltip";import{DomHandler as d,ObjectUtils as b,classNames as v,mergeProps as y,IconUtils as h,ZIndexUtils as g}from"primereact/utils";import{ComponentBase as O}from"primereact/componentbase";import{CSSTransition as E}from"primereact/csstransition";import{Portal as S}from"primereact/portal";import{VirtualScroller as k}from"primereact/virtualscroller";import{CheckIcon as I}from"primereact/icons/check";import{SearchIcon as x}from"primereact/icons/search";import{InputText as w}from"primereact/inputtext";import{Ripple as C}from"primereact/ripple";function j(){return j=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(e[l]=n[l])}return e},j.apply(this,arguments)}function P(e){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},P(e)}function D(e,t){if("object"!==P(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var l=n.call(e,t||"default");if("object"!==P(l))return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function N(e){var t=D(e,"string");return"symbol"===P(t)?t:String(t)}function F(e,t,n){return(t=N(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,l=new Array(t);n<t;n++)l[n]=e[n];return l}function A(e){if(Array.isArray(e))return L(e)}function T(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function R(e,t){if(e){if("string"==typeof e)return L(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?L(e,t):void 0}}function M(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function V(e){return A(e)||T(e)||R(e)||M()}function G(e){if(Array.isArray(e))return e}function K(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var l,r,o,i,a=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(l=o.call(n)).done)&&(a.push(l.value),a.length!==t);c=!0);}catch(e){u=!0,r=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw r}}return a}}function H(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function J(e,t){return G(e)||K(e,t)||R(e,t)||H()}var X=O.extend({defaultProps:{__TYPE:"MultiSelect",appendTo:null,ariaLabelledBy:null,className:null,closeIcon:null,checkboxIcon:null,dataKey:null,disabled:!1,display:"comma",dropdownIcon:null,emptyFilterMessage:null,filter:!1,filterBy:null,filterInputAutoFocus:!0,filterLocale:void 0,filterMatchMode:"contains",filterPlaceholder:null,filterTemplate:null,fixedPlaceholder:!1,flex:!1,id:null,itemCheckboxIcon:null,inline:!1,inputId:null,inputRef:null,itemClassName:null,itemTemplate:null,maxSelectedLabels:null,name:null,onClick:null,onBlur:null,onChange:null,onFilter:null,onFocus:null,onHide:null,onSelectAll:null,onShow:null,optionDisabled:null,optionGroupChildren:null,optionGroupLabel:null,optionGroupTemplate:null,optionLabel:null,optionValue:null,options:null,overlayVisible:!1,panelClassName:null,panelFooterTemplate:null,panelHeaderTemplate:null,panelStyle:null,placeholder:null,removeIcon:null,resetFilterOnHide:!1,scrollHeight:"200px",selectAll:!1,selectedItemTemplate:null,selectedItemsLabel:"{0} items selected",selectionLimit:null,showClear:!1,showSelectAll:!0,style:null,tabIndex:0,tooltip:null,tooltipOptions:null,transitionOptions:null,useOptionAsValue:!1,value:null,virtualScrollerOptions:null,children:void 0}}),q=O.extend({defaultProps:{__TYPE:"Checkbox",autoFocus:!1,checked:!1,className:null,disabled:!1,falseValue:!1,icon:null,id:null,inputId:null,inputRef:null,name:null,onChange:null,onClick:null,onContextMenu:null,onMouseDown:null,readOnly:!1,required:!1,style:null,tabIndex:null,tooltip:null,tooltipOptions:null,trueValue:!0,value:null,children:void 0}});function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,l)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach((function(t){F(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var z=e.memo(e.forwardRef((function(t,l){var r=e.useContext(n),a=q.getProps(t,r),c=J(e.useState(!1),2),u=c[0],s=c[1],p=q.setMetaData({props:a,state:{focused:u}}).ptm,f=e.useRef(null),g=e.useRef(a.inputRef),O=function(e){if(!a.disabled&&!a.readOnly&&(a.onChange||a.onClick)){var t=E(),n=e.target instanceof HTMLDivElement||e.target instanceof HTMLSpanElement||e.target instanceof Object;if(e.target===g.current||n&&e.target.checked!==t){var l=t?a.falseValue:a.trueValue,r={originalEvent:e,value:a.value,checked:l,stopPropagation:function(){e.stopPropagation()},preventDefault:function(){e.preventDefault()},target:{type:"checkbox",name:a.name,id:a.id,value:a.value,checked:l}};if(a.onClick&&a.onClick(r),e.defaultPrevented)return;a.onChange&&a.onChange(r)}d.focus(g.current),e.preventDefault()}},E=function(){return a.checked===a.trueValue};e.useImperativeHandle(l,(function(){return{props:a,focus:function(){return d.focus(g.current)},getElement:function(){return f.current},getInput:function(){return g.current}}})),e.useEffect((function(){b.combinedRefs(g,a.inputRef)}),[g,a.inputRef]),o((function(){g.current.checked=E()}),[a.checked,a.trueValue]),i((function(){a.autoFocus&&d.focus(g.current,a.autoFocus)}));var S=E(),k=b.isNotEmpty(a.tooltip),x=q.getOtherProps(a),w=b.reduceKeys(x,d.ARIA_PROPS),C=v("p-checkbox p-component",{"p-checkbox-checked":S,"p-checkbox-disabled":a.disabled,"p-checkbox-focused":u},a.className),P=v("p-checkbox-box",{"p-highlight":S,"p-disabled":a.disabled,"p-focus":u}),D=y({className:"p-checkbox-icon p-c"},p("icon")),N=h.getJSXIcon(S?a.icon||e.createElement(I,D):null,_({},D),{props:a,checked:S}),F=y({ref:f,id:a.id,className:C,style:a.style,onClick:function(e){return O(e)},onContextMenu:a.onContextMenu,onMouseDown:a.onMouseDown},x,p("root")),L=y({className:"p-hidden-accessible"},p("hiddenInputWrapper")),A=y(_({id:a.inputId,ref:g,type:"checkbox",name:a.name,tabIndex:a.tabIndex,defaultChecked:S,onFocus:function(e){s(!0)},onBlur:function(e){s(!1)},onKeyDown:function(e){var t;"Space"!==(t=e).code&&" "!==t.key||O(t)},disabled:a.disabled,readOnly:a.readOnly,required:a.required},w),p("hiddenInput")),T=y({className:P},p("input"));return e.createElement(e.Fragment,null,e.createElement("div",F,e.createElement("div",L,e.createElement("input",A)),e.createElement("div",T,N)),k&&e.createElement(m,j({target:f,content:a.tooltip},a.tooltipOptions,{pt:p("tooltip")})))})));function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,l)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(Object(n),!0).forEach((function(t){F(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}z.displayName="Checkbox";var Y=e.memo((function(t){var n={filter:function(e){return r(e)},reset:function(){return t.resetFilter()}},r=function(e){t.onFilter&&t.onFilter({originalEvent:e,query:e.target.value})},o=function(e){t.onSelectAll&&t.onSelectAll({originalEvent:e,checked:t.selectAll}),e.preventDefault()},i=function(){var l="p-multiselect-filter-icon",o=y({className:l},t.ptm("filterIcon")),i=h.getJSXIcon(t.filterIcon||e.createElement(x,o),W({},o),{props:t});if(t.filter){var a=v("p-multiselect-filter-container"),c=y({className:a},t.ptm("filterContainer")),u=e.createElement("div",c,e.createElement(w,{ref:t.filterRef,type:"text",role:"textbox",value:t.filterValue,onChange:r,className:"p-multiselect-filter",placeholder:t.filterPlaceholder,pt:t.ptm("filterInput")}),i);if(t.filterTemplate)u=b.getJSXElement(t.filterTemplate,{className:a,element:u,filterOptions:n,onFilter:r,filterIconClassName:l,props:t});return e.createElement(e.Fragment,null,u)}return null}(),a=y({className:"p-checkbox-icon p-c"},t.ptm("headerCheckbox")),c=h.getJSXIcon(t.itemCheckboxIcon||e.createElement(I,a),W({},a),{selected:t.selected}),u=t.showSelectAll?e.createElement(z,{checked:t.selectAll,onChange:o,role:"checkbox","aria-checked":t.selectAll,icon:c}):null,p=y({className:"p-multiselect-close-icon","aria-hidden":!0},t.ptm("closeIcon")),f=h.getJSXIcon(t.closeIcon||e.createElement(s,p),W({},p),{props:t}),m=y({className:"p-multiselect-header"},t.ptm("header")),d=y({type:"button",className:"p-multiselect-close p-link","aria-label":l("close"),onClick:t.onClose},t.ptm("closeButton")),g=e.createElement("button",d,f,e.createElement(C,null)),O=e.createElement("div",m,u,i,g);return t.template?b.getJSXElement(t.template,{className:"p-multiselect-header",checkboxElement:u,checked:t.selectAll,onChange:o,filterElement:i,closeElement:g,closeElementClassName:"p-multiselect-close p-link",closeIconClassName:"p-multiselect-close-icon",onCloseClick:t.onClose,element:O,itemCheckboxIcon:c,props:t}):O}));function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,l)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(n),!0).forEach((function(t){F(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}Y.displayName="MultiSelectHeader";var Q=e.memo((function(t){var n=function(e){return t.ptm(e,{context:{selected:t.selected}})},l=v("p-multiselect-item",{"p-highlight":t.selected,"p-disabled":t.disabled},t.className,t.option.className),r=v("p-checkbox-box",{"p-highlight":t.selected}),o=y({className:"p-checkbox-icon p-c"},n("checkboxIcon")),i=t.selected?h.getJSXIcon(t.checkboxIcon||e.createElement(I,o),$({},o),{selected:t.selected}):null,a=t.template?b.getJSXElement(t.template,t.option):t.label,c=t.disabled?null:t.tabIndex||0,u=y({className:"p-checkbox p-component"},n("checkboxContainer")),s=y({className:r},n("checkbox")),p=y({className:l,style:t.style,onClick:function(e){t.onClick&&t.onClick({originalEvent:e,option:t.option}),e.preventDefault()},tabIndex:c,onKeyDown:function(e){t.onKeyDown&&t.onKeyDown({originalEvent:e,option:t.option})},role:"option","aria-selected":t.selected},n("item"));return e.createElement("li",p,e.createElement("div",u,e.createElement("div",s,i)),e.createElement("span",null,a),e.createElement(C,null))}));function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,l)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(n),!0).forEach((function(t){F(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}Q.displayName="MultiSelectItem";var ne=e.memo(e.forwardRef((function(r,o){var i,a,c,u,s,p,f=e.useRef(null),m=e.useRef(null),h=e.useContext(n),g=function(){r.onEnter((function(){if(f.current){var e=r.getSelectedOptionIndex();-1!==e&&setTimeout((function(){return f.current.scrollToIndex(e)}),0)}}))},O=function(){r.onEntered((function(){r.filter&&r.filterInputAutoFocus&&m.current&&d.focus(m.current,!1)}))},I=function(e){f.current&&f.current.scrollToIndex(0),r.onFilterInputChange&&r.onFilterInputChange(e)},x=function(){if(r.panelFooterTemplate){var t=b.getJSXElement(r.panelFooterTemplate,r,r.onOverlayHide);return e.createElement("div",{className:"p-multiselect-footer"},t)}return null},w=function(t,n){return r.getOptionGroupChildren(t).map((function(t,l){var o=r.getOptionLabel(t),i=l+"_"+r.getOptionRenderKey(t),a=r.isOptionDisabled(t),c=a?null:r.tabIndex||0,u=r.isSelected(t);return e.createElement(Q,{key:i,label:o,option:t,style:n,template:r.itemTemplate,selected:u,onClick:r.onOptionSelect,onKeyDown:r.onOptionKeyDown,tabIndex:c,disabled:a,className:r.itemClassName,checkboxIcon:r.checkboxIcon,ptm:r.ptm})}))},C=function(){var t=b.getJSXElement(r.emptyFilterMessage,r)||l("emptyFilterMessage"),n=y({className:"p-multiselect-empty-message"},r.ptm("emptyMessage"));return e.createElement("li",n,t)},P=function(t,n){var l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o={height:l.props?l.props.itemSize:void 0};if(r.optionGroupLabel){var i=r.optionGroupTemplate?b.getJSXElement(r.optionGroupTemplate,t,n):r.getOptionGroupLabel(t),a=w(t,o),c=n+"_"+r.getOptionGroupRenderKey(t),u=y({className:"p-multiselect-item-group",style:o},r.ptm("itemGroup"));return e.createElement(e.Fragment,{key:c},e.createElement("li",u,i),a)}var s=r.getOptionLabel(t),p=n+"_"+r.getOptionRenderKey(t),f=r.isOptionDisabled(t),m=f?null:r.tabIndex||0,d=r.isSelected(t);return e.createElement(Q,{key:p,label:s,option:t,style:o,template:r.itemTemplate,selected:d,onClick:r.onOptionSelect,onKeyDown:r.onOptionKeyDown,tabIndex:m,disabled:f,className:r.itemClassName,checkboxIcon:r.checkboxIcon,ptm:r.ptm})},D=function(){if(r.virtualScrollerOptions){var t=te(te({},r.virtualScrollerOptions),{style:te(te({},r.virtualScrollerOptions.style),{height:r.scrollHeight}),className:v("p-multiselect-items-wrapper",r.virtualScrollerOptions.className),items:r.visibleOptions,autoSize:!0,onLazyLoad:function(e){return r.virtualScrollerOptions.onLazyLoad(te(te({},e),{filter:r.filterValue}))},itemTemplate:function(e,t){return e&&P(e,t.index,t)},contentTemplate:function(t){var n=v("p-multiselect-items p-component",t.className),l=r.visibleOptions&&r.visibleOptions.length||!r.hasFilter?t.children:C(),o=y({ref:t.contentRef,style:t.style,className:n,role:"listbox","aria-multiselectable":!0},r.ptm("list"));return e.createElement("ul",o,l)}});return e.createElement(k,j({ref:f},t,{pt:r.ptm("virtualScroller")}))}var n=b.isNotEmpty(r.visibleOptions)?r.visibleOptions.map(P):r.hasFilter?C():null,l=y({className:"p-multiselect-items-wrapper",style:{maxHeight:r.scrollHeight}},r.ptm("wrapper")),o=y({className:"p-multiselect-items p-component",role:"listbox","aria-multiselectable":!0},r.ptm("list"));return e.createElement("div",l,e.createElement("ul",o,n))},N=(i=r.allowOptionSelect(),a=v("p-multiselect-panel p-component",{"p-multiselect-inline":r.inline,"p-multiselect-flex":r.flex,"p-multiselect-limited":!i,"p-input-filled":h&&"filled"===h.inputStyle||"filled"===t.inputStyle,"p-ripple-disabled":h&&!1===h.ripple||!1===t.ripple},r.panelClassName),c=e.createElement(Y,{filter:r.filter,filterRef:m,filterValue:r.filterValue,filterTemplate:r.filterTemplate,onFilter:I,filterPlaceholder:r.filterPlaceholder,onClose:r.onCloseClick,showSelectAll:r.showSelectAll,selectAll:r.isAllSelected(),onSelectAll:r.onSelectAll,template:r.panelHeaderTemplate,resetFilter:r.resetFilter,closeIcon:r.closeIcon,filterIcon:r.filterIcon,itemCheckboxIcon:r.itemCheckboxIcon,ptm:r.ptm}),u=D(),s=x(),p=y({ref:o,className:a,style:r.panelStyle,onClick:r.onClick},r.ptm("panel")),r.inline?e.createElement("div",p,u,s):e.createElement(E,{nodeRef:o,classNames:"p-connected-overlay",in:r.in,timeout:{enter:120,exit:100},options:r.transitionOptions,unmountOnExit:!0,onEnter:g,onEntered:O,onExit:r.onExit,onExited:r.onExited},e.createElement("div",p,c,u,s)));return r.inline?N:e.createElement(S,{element:N,appendTo:r.appendTo})})));function le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,l)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?le(Object(n),!0).forEach((function(t){F(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function oe(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=ie(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var l=0,r=function(){};return{s:r,n:function(){return l>=e.length?{done:!0}:{done:!1,value:e[l++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){a=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(a)throw o}}}}function ie(e,t){if(e){if("string"==typeof e)return ae(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ae(e,t):void 0}}function ae(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,l=new Array(t);n<t;n++)l[n]=e[n];return l}ne.displayName="MultiSelectPanel";var ce=e.memo(e.forwardRef((function(l,i){var O=e.useContext(n),E=X.getProps(l,O),S=J(e.useState(""),2),k=S[0],I=S[1],x=J(e.useState(!1),2),w=x[0],C=x[1],P=J(e.useState(E.inline),2),D=P[0],N=P[1],L=e.useRef(null),A=e.useRef(E.inputRef),T=e.useRef(null),R=e.useRef(null),M=k&&k.trim().length>0,G=b.isEmpty(E.value),K=E.optionValue?null:E.dataKey,H=X.setMetaData({props:E,state:{filterState:k,focused:w,overlayVisible:D}}).ptm,q=J(a({target:L,overlay:R,listener:function(e,t){t.valid&&("outside"===t.type?!le(e)&&ee():ee())},when:D}),2),B=q[0],_=q[1],z=function(){return!E.selectionLimit||!E.value||E.value&&E.value.length<E.selectionLimit},U=function(e){var t=e.originalEvent,n=e.option;if(!E.disabled&&!de(n)){var l=fe(n),r=be(n),o=ce(n),i=z();o?Z(t,E.value.filter((function(e){return!b.equals(r?e:fe(e),l,K)})),n):i&&Z(t,[].concat(V(E.value||[]),[l]),n)}},W=function e(t){var n=t.nextElementSibling;return n?d.hasClass(n,"p-disabled")||d.hasClass(n,"p-multiselect-item-group")?e(n):n:null},Y=function e(t){var n=t.previousElementSibling;return n?d.hasClass(n,"p-disabled")||d.hasClass(n,"p-multiselect-item-group")?e(n):n:null},Z=function(e,t,n){E.onChange&&E.onChange({originalEvent:e,value:t,selectedOption:n,stopPropagation:function(){e.stopPropagation()},preventDefault:function(){e.preventDefault()},target:{name:E.name,id:E.id,value:t}})},$=function(){I(""),E.onFilter&&E.onFilter({filter:""})},Q=function(){N(!0)},ee=function(){N(!1)},te=function(){d.alignOverlay(R.current,T.current.parentElement,E.appendTo||O&&O.appendTo||t.appendTo)},le=function(e){return d.hasClass(e.target,"p-multiselect-clear-icon")},ie=function(e){return R.current&&R.current.contains(e.target)},ae=function(e,t){return t.findIndex((function(t){return e.some((function(e){return b.equals(e,fe(t),K)}))}))},ce=function(e){if(E.value){var t=fe(e),n=be(e);return E.value.some((function(e){return b.equals(n?e:fe(e),t,K)}))}return!1},ue=function(e){var t;if(E.options)if(E.optionGroupLabel){var n,l=oe(E.options);try{for(l.s();!(n=l.n()).done;){if(t=se(e,me(n.value)))break}}catch(e){l.e(e)}finally{l.f()}}else t=se(e,E.options);return t?pe(t):null},se=function(e,t){return t.find((function(t){return b.equals(fe(t),e,K)}))},pe=function(e){return E.optionLabel?b.resolveFieldData(e,E.optionLabel):e&&void 0!==e.label?e.label:e},fe=function(e){if(E.useOptionAsValue)return e;if(E.optionValue){var t=b.resolveFieldData(e,E.optionValue);return null!==t?t:e}return e&&void 0!==e.value?e.value:e},me=function(e){return b.resolveFieldData(e,E.optionGroupChildren)},de=function(e){return E.optionDisabled?b.isFunction(E.optionDisabled)?E.optionDisabled(e):b.resolveFieldData(e,E.optionDisabled):!(!e||void 0===e.disabled)&&e.disabled},be=function(e){return!E.useOptionAsValue&&E.optionValue||e&&void 0!==e.value},ve=function(e,t){var n=E.value.filter((function(e){return!b.equals(e,t,K)}));Z(e,n,t)},ye=function(){var e=/{(.*?)}/;return e.test(E.selectedItemsLabel)?E.selectedItemsLabel.replace(E.selectedItemsLabel.match(e)[0],E.value.length+""):E.selectedItemsLabel},he=function(){if(!G&&!E.fixedPlaceholder)return b.isNotEmpty(E.maxSelectedLabels)&&E.value.length>E.maxSelectedLabels?ye():E.value.reduce((function(e,t,n){return e+(0!==n?",":"")+ue(t)}),"")};e.useImperativeHandle(i,(function(){return{props:E,show:Q,hide:ee,focus:function(){return d.focus(A.current)},getElement:function(){return L.current},getOverlay:function(){return R.current},getInput:function(){return A.current}}})),e.useEffect((function(){b.combinedRefs(A,E.inputRef)}),[A,E.inputRef]),e.useEffect((function(){setTimeout((function(){E.overlayVisible?Q():ee()}),100)}),[E.overlayVisible]),o((function(){D&&M&&te()}),[D,M]),c((function(){g.clear(R.current)}));var ge=function(){if(M){var e=k.trim().toLocaleLowerCase(E.filterLocale),t=E.filterBy?E.filterBy.split(","):[E.optionLabel||"label"];if(E.optionGroupLabel){var n,l=[],o=oe(E.options);try{for(o.s();!(n=o.n()).done;){var i=n.value,a=r.filter(me(i),t,e,E.filterMatchMode,E.filterLocale);a&&a.length&&l.push(re(re({},i),F({},E.optionGroupChildren,a)))}}catch(e){o.e(e)}finally{o.f()}return l}return r.filter(E.options,t,e,E.filterMatchMode,E.filterLocale)}return E.options}(),Oe=b.isNotEmpty(E.tooltip),Ee=X.getOtherProps(E),Se=b.reduceKeys(Ee,d.ARIA_PROPS),ke=v("p-multiselect p-component p-inputwrapper",{"p-multiselect-chip":"chip"===E.display,"p-disabled":E.disabled,"p-multiselect-clearable":E.showClear&&!E.disabled,"p-focus":w,"p-inputwrapper-filled":b.isNotEmpty(E.value),"p-inputwrapper-focus":w||D},E.className),Ie=y({className:"p-multiselect-trigger-icon p-c"},H("triggerIcon")),xe=y({className:"p-multiselect-trigger"},H("trigger")),we=e.createElement("div",xe,E.dropdownIcon?h.getJSXIcon(E.dropdownIcon,re({},Ie),{props:E}):e.createElement(u,Ie)),Ce=!E.inline&&function(){var t=E.selectedItemTemplate?G?b.getJSXElement(E.selectedItemTemplate):b.isNotEmpty(E.maxSelectedLabels)&&E.value.length>E.maxSelectedLabels?ye():E.value.map((function(t,n){var l=b.getJSXElement(E.selectedItemTemplate,t);return e.createElement(e.Fragment,{key:n},l)})):"chip"!==E.display||G?he():E.value.slice(0,E.maxSelectedLabels||E.value.length).map((function(t,n){var l=ue(t),r=y({key:n,className:"p-multiselect-token-icon",onClick:function(e){return ve(e,t)}},H("removeTokenIcon")),o=!E.disabled&&(E.removeIcon?h.getJSXIcon(E.removeIcon,re({},r),{props:E}):e.createElement(p,r)),i=y({className:"p-multiselect-token"},H("token")),a=y({key:l+n,className:"p-multiselect-token-label"},H("tokenLabel"));return e.createElement("div",j({},i,{key:l}),e.createElement("span",a,l),o)})),n=v("p-multiselect-label",{"p-placeholder":G&&E.placeholder,"p-multiselect-label-empty":G&&!E.placeholder&&!E.selectedItemTemplate,"p-multiselect-items-label":!G&&"chip"!==E.display&&E.value.length>E.maxSelectedLabels}),l=y({ref:T,className:"p-multiselect-label-container"},H("labelContainer")),r=y({className:n},H("label"));return e.createElement("div",l,e.createElement("div",r,t||E.placeholder||"empty"))}(),je=!E.inline&&function(){var t=y({className:"p-multiselect-clear-icon",onClick:function(e){return Z(e,null,null)}},H("clearIcon")),n=h.getJSXIcon(E.clearIcon||e.createElement(s,t),re({},t),{props:E});return G||!E.showClear||E.disabled?null:n}(),Pe=y(re(re({ref:L,id:E.id,style:E.style,className:ke},Ee),{},{onClick:function(e){E.inline||E.disabled||ie(e)||d.hasClass(e.target,"p-multiselect-token-icon")||le(e)||(D?ee():Q(),d.focus(A.current),e.preventDefault())}}),X.getOtherProps(E),H("root")),De=y({className:"p-hidden-accessible"},H("hiddenInputWrapper")),Ne=y(re({ref:A,id:E.inputId,name:E.name,type:"text",onFocus:function(e){C(!0),E.onFocus&&E.onFocus(e)},onBlur:function(e){C(!1),E.onBlur&&E.onBlur(e)},onKeyDown:function(e){switch(e.which){case 40:if(E.inline)break;!D&&e.altKey&&(Q(),e.preventDefault());break;case 32:if(E.inline)break;D?ee():Q(),e.preventDefault();break;case 27:if(E.inline)break;ee();break;case 9:if(D){var t=d.getFirstFocusableElement(R.current);t&&(t.focus(),e.preventDefault())}}},role:"listbox","aria-expanded":D,disabled:E.disabled,tabIndex:E.tabIndex},Se),H("input"));return e.createElement(e.Fragment,null,e.createElement("div",Pe,e.createElement("div",De,e.createElement("input",j({},Ne,{readOnly:!0}))),!E.inline&&e.createElement(e.Fragment,null,Ce,je,we),e.createElement(ne,j({ref:R,visibleOptions:ge},E,{onClick:function(e){f.emit("overlay-click",{originalEvent:e,target:L.current})},onOverlayHide:ee,filterValue:k,hasFilter:M,onFilterInputChange:function(e){var t=e.query;I(t),E.onFilter&&E.onFilter({originalEvent:e,filter:t})},resetFilter:$,onCloseClick:function(e){ee(),d.focus(A.current),e.preventDefault(),e.stopPropagation()},onSelectAll:function(e){if(E.onSelectAll)E.onSelectAll(e);else{var t=null;if(e.checked){if(t=[],ge){var n=ge.filter((function(e){return de(e)&&ce(e)}));t=n.map((function(e){return fe(e)}))}}else if(ge){var l=ge.filter((function(e){return!de(e)}));E.optionGroupLabel?(t=[],l.forEach((function(e){return t=[].concat(V(t),V(me(e).filter((function(e){return!de(e)})).map((function(e){return fe(e)}))))}))):t=l.map((function(e){return fe(e)}))}Z(e.originalEvent,t,t)}},getOptionLabel:pe,getOptionRenderKey:function(e){return E.dataKey?b.resolveFieldData(e,E.dataKey):pe(e)},isOptionDisabled:de,getOptionGroupChildren:me,getOptionGroupLabel:function(e){return b.resolveFieldData(e,E.optionGroupLabel)},getOptionGroupRenderKey:function(e){return b.resolveFieldData(e,E.optionGroupLabel)},isSelected:ce,getSelectedOptionIndex:function(){if(null!=E.value&&E.options){if(E.optionGroupLabel){var e=0,t=E.options.findIndex((function(t,n){return(e=n)&&-1!==ae(E.value,me(t))}));return-1!==t?{group:e,option:t}:-1}return ae(E.value,E.options)}return-1},isAllSelected:function(){if(E.onSelectAll)return E.selectAll;if(b.isEmpty(ge))return!1;var e=ge.filter((function(e){return!de(e)}));if(E.optionGroupLabel){var t,n=!0,l=oe(e);try{for(l.s();!(t=l.n()).done;){!0===me(t.value).filter((function(e){return!de(e)})).some((function(e){return!ce(e)}))&&(n=!1)}}catch(e){l.e(e)}finally{l.f()}return n}return!e.some((function(e){return!ce(e)}))},onOptionSelect:U,allowOptionSelect:z,onOptionKeyDown:function(e){var t=e.originalEvent,n=t.currentTarget;switch(t.which){case 40:var l=W(n);l&&l.focus(),t.preventDefault();break;case 38:var r=Y(n);r&&r.focus(),t.preventDefault();break;case 13:case 32:U(e),t.preventDefault();break;case 27:ee(),d.focus(A.current)}},in:D,onEnter:function(e){var n;g.set("overlay",R.current,O&&O.autoZIndex||t.autoZIndex,O&&O.zIndex.overlay||t.zIndex.overlay),te(),(n=d.findSingle(R.current,"li.p-highlight"))&&n.scrollIntoView&&n.scrollIntoView({block:"nearest",inline:"nearest"}),e&&e()},onEntered:function(e){e&&e(),B(),E.onShow&&E.onShow()},onExit:function(){_()},onExited:function(){E.filter&&E.resetFilterOnHide&&$(),g.clear(R.current),E.onHide&&E.onHide()},ptm:H}))),Oe&&e.createElement(m,j({target:L,content:E.tooltip},E.tooltipOptions,{pt:H("tooltip")})))})));ce.displayName="MultiSelect";export{ce as MultiSelect};
