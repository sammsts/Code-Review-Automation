import*as e from"react";import{useMountEffect as t,useUpdateEffect as n}from"primereact/hooks";import{DomHandler as r,classNames as l,mergeProps as o}from"primereact/utils";import{ComponentBase as a}from"primereact/componentbase";import{PrimeReactContext as u}from"primereact/api";function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function i(e,t){if("object"!==c(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function s(e){var t=i(e,"string");return"symbol"===c(t)?t:String(t)}function m(e,t,n){return(t=s(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p=a.extend({defaultProps:{__TYPE:"Editor",id:null,value:null,style:null,className:null,placeholder:null,readOnly:!1,modules:null,formats:null,theme:"snow",showHeader:!0,headerTemplate:null,onTextChange:null,onSelectionChange:null,onLoad:null,maxLength:null,children:void 0}});function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var d=function(){try{return Quill}catch(e){return null}}(),v=e.memo(e.forwardRef((function(a,c){var i=e.useContext(u),s=p.getProps(a,i),m=p.setMetaData({props:s}).ptm,b=e.useRef(null),v=e.useRef(null),y=e.useRef(null),E=e.useRef(null),g=e.useRef(!1);t((function(){if(!g.current){var e={modules:f({toolbar:!!s.showHeader&&y.current},s.modules),placeholder:s.placeholder,readOnly:s.readOnly,theme:s.theme,formats:s.formats};d?(E.current=new Quill(v.current,e),h(),E.current&&E.current.getModule("toolbar")&&s.onLoad&&s.onLoad(E.current)):import("quill").then((function(t){t&&r.isExist(v.current)&&(E.current=t.default?new t.default(v.current,e):new t(v.current,e),h())})).then((function(){E.current&&E.current.getModule("toolbar")&&s.onLoad&&s.onLoad(E.current)})),g.current=!0}}));var h=function(){s.value&&E.current.setContents(E.current.clipboard.convert(s.value)),E.current.on("text-change",(function(e,t,n){var l=v.current.children[0],o=l?l.innerHTML:null,a=E.current.getText();if("<p><br></p>"===o&&(o=null),"api"===n){var u=v.current.children[0],c=document.createElement("div");if(c.innerHTML=s.value||"",r.isEqualElement(u,c))return}if(s.maxLength){var i=E.current.getLength();i>s.maxLength&&E.current.deleteText(s.maxLength,i)}s.onTextChange&&s.onTextChange({htmlValue:o,textValue:a,delta:e,source:n})})),E.current.on("selection-change",(function(e,t,n){s.onSelectionChange&&s.onSelectionChange({range:e,oldRange:t,source:n})}))};n((function(){E.current&&!E.current.hasFocus()&&(s.value?E.current.setContents(E.current.clipboard.convert(s.value)):E.current.setText(""))}),[s.value]),e.useImperativeHandle(c,(function(){return{props:s,getQuill:function(){return E.current},getElement:function(){return b.current},getContent:function(){return v.current},getToolbar:function(){return y.current}}}));var N=l("p-component p-editor-container",s.className),O=function(){var t=o({ref:y,className:"p-editor-toolbar"},m("toolbar"));if(!1===s.showHeader)return null;if(s.headerTemplate)return e.createElement("div",t,s.headerTemplate);var n=function(e,t){return o(e&&f({},e),m(t))},r=o({className:"ql-formats"},m("formats"));return e.createElement("div",t,e.createElement("span",r,e.createElement("select",n({className:"ql-header",defaultValue:"0"},"select"),e.createElement("option",n({value:"1"},"option"),"Heading"),e.createElement("option",n({value:"2"},"option"),"Subheading"),e.createElement("option",n({value:"0"},"option"),"Normal")),e.createElement("select",n({className:"ql-font"},"select"),e.createElement("option",n(void 0,"option")),e.createElement("option",n({value:"serif"},"option")),e.createElement("option",n({value:"monospace"},"option")))),e.createElement("span",r,e.createElement("button",n({type:"button",className:"ql-bold","aria-label":"Bold"},"button")),e.createElement("button",n({type:"button",className:"ql-italic","aria-label":"Italic"},"button")),e.createElement("button",n({type:"button",className:"ql-underline","aria-label":"Underline"},"button"))),e.createElement("span",r,e.createElement("select",n({className:"ql-color"},"select")),e.createElement("select",n({className:"ql-background"},"select"))),e.createElement("span",r,e.createElement("button",n({type:"button",className:"ql-list",value:"ordered","aria-label":"Ordered List"},"button")),e.createElement("button",n({type:"button",className:"ql-list",value:"bullet","aria-label":"Unordered List"},"button")),e.createElement("select",n({className:"ql-align"},"select"),e.createElement("option",n({defaultValue:!0},"option")),e.createElement("option",n({value:"center"},"option")),e.createElement("option",n({value:"right"},"option")),e.createElement("option",n({value:"justify"},"option")))),e.createElement("span",r,e.createElement("button",n({type:"button",className:"ql-link","aria-label":"Insert Link"},"button")),e.createElement("button",n({type:"button",className:"ql-image","aria-label":"Insert Image"},"button")),e.createElement("button",n({type:"button",className:"ql-code-block","aria-label":"Insert Code Block"},"button"))),e.createElement("span",r,e.createElement("button",n({type:"button",className:"ql-clean","aria-label":"Remove Styles"},"button"))))}(),q=o({ref:v,className:"p-editor-content",style:s.style},m("content")),w=e.createElement("div",q),x=o({id:s.id,ref:b,className:N},p.getOtherProps(s),m("root"));return e.createElement("div",x,O,w)})));v.displayName="Editor";export{v as Editor};
