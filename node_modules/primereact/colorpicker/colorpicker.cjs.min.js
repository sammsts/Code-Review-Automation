"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),t=require("primereact/api"),n=require("primereact/hooks"),r=require("primereact/overlayservice"),o=require("primereact/tooltip"),l=require("primereact/utils"),u=require("primereact/componentbase"),i=require("primereact/csstransition"),a=require("primereact/portal");function c(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function s(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var p=s(e),f=c(t);function d(){return d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},d.apply(this,arguments)}function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function b(e,t){if("object"!==m(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==m(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function g(e){var t=b(e,"string");return"symbol"===m(t)?t:String(t)}function h(e,t,n){return(t=g(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e){if(Array.isArray(e))return e}function y(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,l,u,i=[],a=!0,c=!1;try{if(l=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;a=!1}else for(;!(a=(r=l.call(n)).done)&&(i.push(r.value),i.length!==t);a=!0);}catch(e){c=!0,o=e}finally{try{if(!a&&null!=n.return&&(u=n.return(),Object(u)!==u))return}finally{if(c)throw o}}return i}}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function E(e,t){if(e){if("string"==typeof e)return O(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?O(e,t):void 0}}function x(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function P(e,t){return v(e)||y(e,t)||E(e,t)||x()}var M=u.ComponentBase.extend({defaultProps:{__TYPE:"ColorPicker",appendTo:null,autoFocus:!1,children:void 0,className:null,defaultColor:"ff0000",disabled:!1,format:"hex",id:null,inline:!1,inputClassName:null,inputId:null,inputRef:null,inputStyle:null,onChange:null,onHide:null,onShow:null,panelClassName:null,panelStyle:null,style:null,tabIndex:null,tooltip:null,tooltipOptions:null,transitionOptions:null,value:null}}),S=p.forwardRef((function(e,n){var r,o,u=p.useContext(t.PrimeReactContext),c=(r=l.classNames("p-colorpicker-panel",e.panelClassName,{"p-colorpicker-overlay-panel":!e.inline,"p-disabled":e.disabled,"p-input-filled":u&&"filled"===u.inputStyle||"filled"===f.default.inputStyle,"p-ripple-disabled":u&&!1===u.ripple||!1===f.default.ripple}),o=l.mergeProps({ref:n,className:r,style:e.panelStyle,onClick:e.onClick},e.ptm("panel")),p.createElement(i.CSSTransition,{nodeRef:n,classNames:"p-connected-overlay",in:e.in,timeout:{enter:120,exit:100},options:e.transitionOptions,unmountOnExit:!0,onEnter:e.onEnter,onEntered:e.onEntered,onExit:e.onExit,onExited:e.onExited},p.createElement("div",o,e.children)));return e.inline?c:p.createElement(a.Portal,{element:c,appendTo:e.appendTo})}));function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}S.displayName="ColorPickerPanel";var C=p.memo(p.forwardRef((function(e,u){var i=p.useContext(t.PrimeReactContext),a=M.getProps(e,i),c=P(p.useState(!1),2),s=c[0],m=c[1],b=M.setMetaData({props:a,state:{overlayVisible:s}}).ptm,g=p.useRef(null),h=p.useRef(null),v=p.useRef(a.inputRef),y=p.useRef(null),O=p.useRef(null),E=p.useRef(null),x=p.useRef(null),k=p.useRef(!1),C=p.useRef(null),j=p.useRef(!1),T=P(n.useOverlayListener({target:g,overlay:h,listener:function(e,t){t.valid&&ne()},when:s}),2),N=T[0],R=T[1],D=P(n.useEventListener({type:"mousemove",listener:function(e){j.current&&X(e),k.current&&_(e)}}),2),I=D[0],H=D[1],q=P(n.useEventListener({type:"mouseup",listener:function(){j.current=k.current=!1,l.DomHandler.removeClass(g.current,"p-colorpicker-dragging"),H(),Y()}}),2),U=q[0],Y=q[1],A=function(e){a.disabled||(k.current=!0,_(e),l.DomHandler.addClass(g.current,"p-colorpicker-dragging"))},_=function(e){var t=x.current.getBoundingClientRect().top+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0);C.current=ue({h:Math.floor(360*(150-Math.max(0,Math.min(150,(e.pageY||e.changedTouches[0].pageY)-t)))/150),s:100,b:100}),J(),W(),K()},Z=function(e){a.disabled||(j.current=!0,X(e),l.DomHandler.addClass(g.current,"p-colorpicker-dragging"),e.preventDefault())},F=function(e){j.current&&(X(e),e.preventDefault()),k.current&&(_(e),e.preventDefault())},L=function(){j.current=!1,k.current=!1,l.DomHandler.removeClass(g.current,"p-colorpicker-dragging"),B()},z=function(){I(),U()},B=function(){H(),Y()},X=function(e){var t=y.current.getBoundingClientRect(),n=t.top+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0),r=t.left+document.body.scrollLeft,o=Math.floor(100*Math.max(0,Math.min(150,(e.pageX||e.changedTouches[0].pageX)-r))/150),l=Math.floor(100*(150-Math.max(0,Math.min(150,(e.pageY||e.changedTouches[0].pageY)-n)))/150);C.current=ue({h:C.current.h,s:o,b:l}),Q(),ee(),K()},K=function(){switch(a.format){case"hex":G(fe(C.current));break;case"rgb":G(se(C.current));break;case"hsb":G(C.current)}},V=function(e){var t;if(e)switch(a.format){case"hex":t=ae(e);break;case"rgb":t=ce(e);break;case"hsb":t=e}else t=ae(a.defaultColor);return t},$=function(e){C.current=V(e)},G=function(e){a.onChange&&a.onChange({value:e,stopPropagation:function(){},preventDefault:function(){},target:{name:a.name,id:a.id,value:e}})},J=function(){if(y.current){var e=ue({h:C.current.h,s:100,b:100});y.current.style.backgroundColor="#"+fe(e)}},Q=function(){O.current&&(O.current.style.left=Math.floor(150*C.current.s/100)+"px",O.current.style.top=Math.floor(150*(100-C.current.b)/100)+"px")},W=function(){E.current&&(E.current.style.top=Math.floor(150-150*C.current.h/360)+"px")},ee=function(){v.current&&(v.current.style.backgroundColor="#"+fe(C.current))},te=function(){m(!0)},ne=function(){m(!1)},re=function(){oe()},oe=function(){s?ne():te()},le=function(e){switch(e.which){case 32:oe(),e.preventDefault();break;case 27:case 9:ne()}},ue=function(e){return{h:Math.min(360,Math.max(0,e.h)),s:Math.min(100,Math.max(0,e.s)),b:Math.min(100,Math.max(0,e.b))}},ie=function(e){var t=parseInt(e.indexOf("#")>-1?e.substring(1):e,16);return{r:t>>16,g:(65280&t)>>8,b:255&t}},ae=function(e){return ce(ie(e))},ce=function(e){var t={h:0,s:0,b:0},n=Math.min(e.r,e.g,e.b),r=Math.max(e.r,e.g,e.b),o=r-n;return t.b=r,t.s=0!==r?255*o/r:0,t.h=0!==t.s?e.r===r?(e.g-e.b)/o:e.g===r?2+(e.b-e.r)/o:4+(e.r-e.g)/o:-1,t.h*=60,t.h<0&&(t.h+=360),t.s*=100/255,t.b*=100/255,t},se=function(e){var t={r:null,g:null,b:null},n=Math.round(e.h),r=Math.round(255*e.s/100),o=Math.round(255*e.b/100);if(0===r)t={r:o,g:o,b:o};else{var l=o,u=(255-r)*o/255,i=n%60*(l-u)/60;360===n&&(n=0),n<60?(t.r=l,t.b=u,t.g=u+i):n<120?(t.g=l,t.b=u,t.r=l-i):n<180?(t.g=l,t.r=u,t.b=u+i):n<240?(t.b=l,t.r=u,t.g=l-i):n<300?(t.b=l,t.g=u,t.r=u+i):n<360?(t.r=l,t.g=u,t.b=l-i):(t.r=0,t.g=0,t.b=0)}return{r:Math.round(t.r),g:Math.round(t.g),b:Math.round(t.b)}},pe=function(e){var t=[e.r.toString(16),e.g.toString(16),e.b.toString(16)];for(var n in t)1===t[n].length&&(t[n]="0"+t[n]);return t.join("")},fe=function(e){return pe(se(e))},de=function(){W(),Q(),ee(),J()},me=function(){v.current&&l.DomHandler.alignOverlay(h.current,v.current.parentElement,a.appendTo||i&&i.appendTo||f.default.appendTo)};p.useImperativeHandle(u,(function(){return{props:a,show:te,hide:ne,focus:function(){return l.DomHandler.focus(v.current)},getElement:function(){return g.current},getOverlay:function(){return h.current},getInput:function(){return v.current}}})),p.useEffect((function(){l.ObjectUtils.combinedRefs(v,a.inputRef)}),[v,a.inputRef]),n.useMountEffect((function(){$(a.value),de(),a.autoFocus&&l.DomHandler.focus(v.current,a.autoFocus)})),n.useUpdateEffect((function(){j.current||k.current||$(a.value)}),[a.value]),n.useUpdateEffect((function(){de()})),n.useUnmountEffect((function(){l.ZIndexUtils.clear(h.current)}));var be,ge,he,ve,ye,Oe,Ee,xe,Pe=l.ObjectUtils.isNotEmpty(a.tooltip),Me=l.classNames("p-colorpicker p-component",{"p-colorpicker-overlay":!a.inline},a.className),Se=(be=l.mergeProps({ref:y,className:"p-colorpicker-color-selector",onMouseDown:function(e){return t=e,void(a.disabled||(z(),Z(t)));var t},onTouchStart:function(e){return Z(e)},onTouchMove:function(e){return F(e)},onTouchEnd:L},b("selector")),ge=l.mergeProps({className:"p-colorpicker-color"},b("color")),he=l.mergeProps({ref:O,className:"p-colorpicker-color-handle"},b("colorHandler")),Oe=p.createElement("div",be,p.createElement("div",ge,p.createElement("div",he))),ve=l.mergeProps({ref:x,className:"p-colorpicker-hue",onMouseDown:function(e){return t=e,void(a.disabled||(z(),A(t)));var t},onTouchStart:function(e){return A(e)},onTouchMove:function(e){return F(e)},onTouchEnd:L},b("hue")),ye=l.mergeProps({ref:E,className:"p-colorpicker-hue-handle"},b("hueHandler")),Ee=p.createElement("div",ve,p.createElement("div",ye)),xe=l.mergeProps({className:"p-colorpicker-content"},b("content")),p.createElement("div",xe,Oe,Ee)),ke=function(){if(!a.inline){var e=l.classNames("p-colorpicker-preview p-inputtext",a.inputClassName,{"p-disabled":a.disabled}),t=M.getOtherProps(a),n=l.mergeProps(w({ref:v,type:"text",readOnly:!0,className:e,style:a.inputStyle,id:a.inputId,tabIndex:a.tabIndex,disabled:a.disabled,onClick:re,onKeyDown:le},t),b("input"));return p.createElement("input",n)}return null}(),we=l.mergeProps({id:a.id,ref:g,style:a.style,className:Me},M.getOtherProps(a),b("root"));return p.createElement(p.Fragment,null,p.createElement("div",we,ke,p.createElement(S,{ref:h,appendTo:a.appendTo,inline:a.inline,disabled:a.disabled,panelStyle:a.panelStyle,panelClassName:a.panelClassName,onClick:function(e){a.inline||r.OverlayService.emit("overlay-click",{originalEvent:e,target:g.current})},in:a.inline||s,onEnter:function(){l.ZIndexUtils.set("overlay",h.current,i&&i.autoZIndex||f.default.autoZIndex,i&&i.zIndex.overlay||f.default.zIndex.overlay),me()},onEntered:function(){N(),a.onShow&&a.onShow()},onExit:function(){R()},onExited:function(){l.ZIndexUtils.clear(h.current),a.onHide&&a.onHide()},transitionOptions:a.transitionOptions,ptm:b},Se)),Pe&&p.createElement(o.Tooltip,d({target:g,content:a.tooltip},a.tooltipOptions,{pt:b("tooltip")})))})));C.displayName="ColorPicker",exports.ColorPicker=C;
