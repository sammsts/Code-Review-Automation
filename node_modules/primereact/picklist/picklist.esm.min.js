import*as e from"react";import t,{PrimeReactContext as n,FilterService as r}from"primereact/api";import{useMatchMedia as o,useMountEffect as l,useUpdateEffect as i}from"primereact/hooks";import{classNames as a,mergeProps as c,ObjectUtils as u,IconUtils as s,DomHandler as m,UniqueComponentId as p}from"primereact/utils";import{ComponentBase as v}from"primereact/componentbase";import{Button as f}from"primereact/button";import{AngleDoubleDownIcon as g}from"primereact/icons/angledoubledown";import{AngleDoubleUpIcon as d}from"primereact/icons/angledoubleup";import{AngleDownIcon as y}from"primereact/icons/angledown";import{AngleUpIcon as T}from"primereact/icons/angleup";import{SearchIcon as b}from"primereact/icons/search";import{Ripple as h}from"primereact/ripple";import{AngleDoubleLeftIcon as S}from"primereact/icons/angledoubleleft";import{AngleDoubleRightIcon as I}from"primereact/icons/angledoubleright";import{AngleLeftIcon as E}from"primereact/icons/angleleft";import{AngleRightIcon as k}from"primereact/icons/angleright";function w(e){if(Array.isArray(e))return e}function C(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,l,i,a=[],c=!0,u=!1;try{if(l=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=l.call(n)).done)&&(a.push(r.value),a.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return a}}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function F(e,t){if(e){if("string"==typeof e)return N(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?N(e,t):void 0}}function L(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function K(e,t){return w(e)||C(e,t)||F(e,t)||L()}var x=v.extend({defaultProps:{__TYPE:"PickList",id:null,source:null,target:null,sourceHeader:null,targetHeader:null,style:null,className:null,sourceStyle:null,targetStyle:null,sourceSelection:null,targetSelection:null,showSourceControls:!0,showTargetControls:!0,metaKeySelection:!0,filter:!1,filterBy:null,filterMatchMode:"contains",targetFilterIcon:null,sourceFilterIcon:null,moveAllToSourceIcon:null,moveToSourceIcon:null,moveAllToTargetIcon:null,moveToTargetIcon:null,moveBottomIcon:null,moveUpIcon:null,moveTopIcon:null,moveDownIcon:null,filterLocale:void 0,sourceFilterValue:null,targetFilterValue:null,showSourceFilter:!0,showTargetFilter:!0,sourceFilterPlaceholder:null,targetFilterPlaceholder:null,sourceFilterTemplate:null,targetFilterTemplate:null,tabIndex:0,dataKey:null,breakpoint:"960px",itemTemplate:null,sourceItemTemplate:null,targetItemTemplate:null,onChange:null,onMoveToSource:null,onMoveAllToSource:null,onMoveToTarget:null,onMoveAllToTarget:null,onSourceSelectionChange:null,onTargetSelectionChange:null,onSourceFilterChange:null,onTargetFilterChange:null,children:void 0}});function A(e){if(Array.isArray(e))return N(e)}function P(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function O(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function D(e){return A(e)||P(e)||F(e)||O()}var R=e.memo((function(t){var n=t.moveUpIcon||e.createElement(T,null),r=t.moveTopIcon||e.createElement(d,null),o=t.moveDownIcon||e.createElement(y,null),l=t.moveBottomIcon||e.createElement(g,null),i=!t.selection||!t.selection.length,s=a("p-picklist-buttons",t.className),m=c({className:s},t.ptm("controls"));return e.createElement("div",m,e.createElement(f,{disabled:i,type:"button",icon:n,onClick:function(e){var n=t.selection;if(n&&n.length){for(var r=D(t.list),o=0;o<n.length;o++){var l=u.findIndexInList(n[o],r,t.dataKey);if(0===l)break;var i=r[l-1];r[l-1]=r[l],r[l]=i}t.onReorder&&t.onReorder({originalEvent:e,value:r,direction:"up"})}},pt:t.ptm("moveUpButton")}),e.createElement(f,{disabled:i,type:"button",icon:r,onClick:function(e){var n=t.selection;if(n&&n.length){for(var r=D(t.list),o=0;o<n.length;o++){var l=u.findIndexInList(n[o],r,t.dataKey);if(0===l)break;var i=r.splice(l,1)[0];r.unshift(i)}t.onReorder&&t.onReorder({originalEvent:e,value:r,direction:"top"})}},pt:t.ptm("moveTopButton")}),e.createElement(f,{disabled:i,type:"button",icon:o,onClick:function(e){var n=t.selection;if(n&&n.length){for(var r=D(t.list),o=n.length-1;o>=0;o--){var l=u.findIndexInList(n[o],r,t.dataKey);if(l===r.length-1)break;var i=r[l+1];r[l+1]=r[l],r[l]=i}t.onReorder&&t.onReorder({originalEvent:e,value:r,direction:"down"})}},pt:t.ptm("moveDownButton")}),e.createElement(f,{disabled:i,type:"button",icon:l,onClick:function(e){var n=t.selection;if(n&&n.length){for(var r=D(t.list),o=n.length-1;o>=0;o--){var l=u.findIndexInList(n[o],r,t.dataKey);if(l===r.length-1)break;var i=r.splice(l,1)[0];r.push(i)}t.onReorder&&t.onReorder({originalEvent:e,value:r,direction:"bottom"})}},pt:t.ptm("moveBottomButton")}))}));function j(e){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},j(e)}function B(e,t){if("object"!==j(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==j(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function M(e){var t=B(e,"string");return"symbol"===j(t)?t:String(t)}function V(e,t,n){return(t=M(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}R.displayName="PickListControls";var H=e.memo((function(t){var n=t.template?t.template(t.value):t.value,r=a("p-picklist-item",{"p-highlight":t.selected},t.className),o=c({className:r,onClick:function(e){t.onClick&&t.onClick({originalEvent:e,value:t.value})},onKeyDown:function(e){t.onKeyDown&&t.onKeyDown({originalEvent:e,value:t.value})},tabIndex:t.tabIndex,role:"option","aria-selected":t.selected},t.ptm("item",{context:{selected:t.selected}}));return e.createElement("li",o,n,e.createElement(h,null))}));function J(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J(Object(n),!0).forEach((function(t){V(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}H.displayName="PickListItem";var X=e.memo(e.forwardRef((function(t,n){var r=e.useRef(null),o=function(e){var n=e.originalEvent,r=e.value,o=D(t.selection),l=u.findIndexInList(r,o,t.dataKey),i=-1!==l;if(t.metaKeySelection){var a=n.metaKey||n.ctrlKey;i&&a?o.splice(l,1):(a||(o.length=0),o.push(r))}else i?o.splice(l,1):o.push(r);t.onSelectionChange&&t.onSelectionChange({event:n,value:o})},l=function(e){var t=e.originalEvent,n=t.currentTarget;switch(t.which){case 40:var r=i(n);r&&r.focus(),t.preventDefault();break;case 38:var l=p(n);l&&l.focus(),t.preventDefault();break;case 13:o(e),t.preventDefault()}},i=function e(t){var n=t.nextElementSibling;return n?m.hasClass(n,"p-picklist-item")?n:e(n):null},p=function e(t){var n=t.previousElementSibling;return n?m.hasClass(n,"p-picklist-item")?n:e(n):null},v=function(e){return-1!==u.findIndexInList(e,t.selection,t.dataKey)},f=function(e){t.onFilter&&t.onFilter({originalEvent:e,value:e.target.value,type:t.type})},g=function(e){13===e.which&&e.preventDefault()};e.useImperativeHandle(n,(function(){return{listElementRef:r}}));var d,y=a("p-picklist-list-wrapper",t.className),T=(d=c({className:"p-picklist-header"},t.ptm("header")),t.header?e.createElement("div",d,u.getJSXElement(t.header,t)):null),h=function(){var n="p-picklist-filter-icon",r=c({className:n},t.ptm("filterIcon")),o=s.getJSXIcon("source"===t.type?t.sourceFilterIcon||e.createElement(b,r):t.targetFilterIcon||e.createElement(b,r),U({},r),{props:t});if(t.showFilter){var l=c({className:"p-picklist-filter"},t.ptm("filter")),i=c({type:"text",value:t.filterValue,onChange:f,onKeyDown:g,placeholder:t.placeholder,className:"p-picklist-filter-input p-inputtext p-component"},t.ptm("filterInput")),a=e.createElement("div",l,e.createElement("input",i),e.createElement("span",null," ",o," "));if(t.filterTemplate)a=u.getJSXElement(t.filterTemplate,{className:"p-picklist-filter",inputProps:{className:"p-picklist-filter-input p-inputtext p-component",onChange:f,onKeyDown:g},iconClassName:n,element:a,props:t});var m=c({className:"p-picklist-filter-container"},t.ptm("filterContainer"));return e.createElement("div",m,a)}return null}(),S=function(){var n=t.list?t.list.map((function(n){var r=JSON.stringify(n),i=v(n);return e.createElement(H,{key:r,value:n,template:t.itemTemplate,selected:i,onClick:o,onKeyDown:l,tabIndex:t.tabIndex,ptm:t.ptm})})):null,r=a("p-picklist-list",t.listClassName),i=c({className:r,role:"listbox","aria-multiselectable":!0,style:t.style},t.ptm("list"));return e.createElement("ul",i,n)}(),I=c({className:y,ref:r},t.ptm("listWrapper"));return e.createElement("div",I,T,h,S)})));X.displayName="PickListSubList";var _=e.memo((function(t){var n=o("(max-width: ".concat(t.breakpoint,")"),t.breakpoint);function r(r){switch(r){case"moveToTargetIcon":return e.createElement(t.moveToTargetIcon||n?y:k,null);case"moveAllToTargetIcon":return e.createElement(t.moveAllToTargetIcon||n?g:I,null);case"moveToSourceIcon":return e.createElement(t.moveToSourceIcon||n?T:E,null);case"moveAllToSourceIcon":return e.createElement(t.moveAllToSourceIcon||n?d:S,null);default:return null}}var l=s.getJSXIcon(r("moveToTargetIcon"),void 0,{props:t,viewChanged:n}),i=s.getJSXIcon(r("moveAllToTargetIcon"),void 0,{props:t,viewChanged:n}),m=s.getJSXIcon(r("moveToSourceIcon"),void 0,{props:t,viewChanged:n}),p=s.getJSXIcon(r("moveAllToSourceIcon"),void 0,{props:t,viewChanged:n}),v=u.isEmpty(t.sourceSelection)||u.isEmpty(t.visibleSourceList),b=u.isEmpty(t.targetSelection)||u.isEmpty(t.visibleTargetList),h=u.isEmpty(t.visibleSourceList),w=u.isEmpty(t.visibleTargetList),C=a("p-picklist-buttons p-picklist-transfer-buttons",t.className),N=c({className:C},t.ptm("buttons"));return e.createElement("div",N,e.createElement(f,{disabled:v,type:"button",icon:l,onClick:function(e){var n=t.sourceSelection;if(u.isNotEmpty(n)){for(var r=D(t.target),o=D(t.source),l=0;l<n.length;l++){var i=n[l];-1===u.findIndexInList(i,r,t.dataKey)&&r.push(o.splice(u.findIndexInList(i,o,t.dataKey),1)[0])}t.onTransfer&&t.onTransfer({originalEvent:e,source:o,target:r,direction:"toTarget"})}},pt:t.ptm("moveToTargetButton")}),e.createElement(f,{disabled:h,type:"button",icon:i,onClick:function(e){if(t.source){var n=[].concat(D(t.target),D(t.visibleSourceList)),r=t.source.filter((function(e){return!t.visibleSourceList.some((function(t){return t===e}))}));t.onTransfer&&t.onTransfer({originalEvent:e,source:r,target:n,direction:"allToTarget"})}},pt:t.ptm("moveAllToTargetButton")}),e.createElement(f,{disabled:b,type:"button",icon:m,onClick:function(e){var n=t.targetSelection;if(u.isNotEmpty(n)){for(var r=D(t.target),o=D(t.source),l=0;l<n.length;l++){var i=n[l];-1===u.findIndexInList(i,o,t.dataKey)&&o.push(r.splice(u.findIndexInList(i,r,t.dataKey),1)[0])}t.onTransfer&&t.onTransfer({originalEvent:e,source:o,target:r,direction:"toSource"})}},pt:t.ptm("moveToSourceButton")}),e.createElement(f,{disabled:w,type:"button",icon:p,onClick:function(e){if(t.source){var n=[].concat(D(t.source),D(t.visibleTargetList)),r=t.target.filter((function(e){return!t.visibleTargetList.some((function(t){return t===e}))}));t.onTransfer&&t.onTransfer({originalEvent:e,source:n,target:r,direction:"allToSource"})}},pt:t.ptm("moveAllToSourceButton")}))}));_.displayName="PickListTransferControls";var W=e.memo(e.forwardRef((function(o,s){var v=e.useContext(n),f=x.getProps(o,v),g=K(e.useState([]),2),d=g[0],y=g[1],T=K(e.useState([]),2),b=T[0],h=T[1],S=K(e.useState(""),2),I=S[0],E=S[1],k=K(e.useState(""),2),w=k[0],C=k[1],N=K(e.useState(null),2),F=N[0],L=N[1],A=x.setMetaData({props:f,state:{sourceSelection:d,targetSelection:b,sourceFilterValue:I,targetFilterValue:w,attributeSelector:F}}).ptm,P=e.useRef(null),O=e.useRef(null),D=e.useRef(null),j=e.useRef(null),B=e.useRef(null),M=e.useRef(null),V=f.sourceSelection?f.sourceSelection:d,H=f.targetSelection?f.targetSelection:b,J=f.onSourceFilterChange?f.sourceFilterValue:I,U=f.onTargetFilterChange?f.targetFilterValue:w,W=u.isNotEmpty(f.filterBy),Y=W&&f.showSourceFilter,$=W&&f.showTargetFilter,q=function(e,t){if(e){var n=m.findSingle(e,".p-picklist-list");switch(t){case"up":G(n,-1);break;case"top":n.scrollTop=0;break;case"down":G(n,1);break;case"bottom":setTimeout((function(){return n.scrollTop=n.scrollHeight}),100)}}},z=function(e,t,n){f.onChange&&f.onChange({originalEvent:e.originalEvent,source:t,target:n})},G=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=e.getElementsByClassName("p-highlight");u.isNotEmpty(n)&&m.scrollInView(e,-1===t?n[0]:n[n.length-1])},Q=function(e,t,n){"sourceSelection"===t?y(e.value):h(e.value),n&&n(e),u.isNotEmpty(V)&&"targetSelection"===t?y([]):u.isNotEmpty(H)&&"sourceSelection"===t&&h([])},Z=function(e){var t=e.originalEvent,n=e.value,r=K("source"===e.type?[E,f.onSourceFilterChange]:[C,f.onTargetFilterChange],2),o=r[0],l=r[1];l?l({originalEvent:t,value:n}):o(n)},ee=function(e,t){var n=K("source"===t?[J,te]:[U,ne],2),r=n[0],o=n[1];return W&&u.isNotEmpty(r)?o(r):e},te=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").trim().toLocaleLowerCase(f.filterLocale);return re(f.source,e)},ne=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").trim().toLocaleLowerCase(f.filterLocale);return re(f.target,e)},re=function(e,t){var n=W?f.filterBy.split(","):[];return r.filter(e,n,t,f.filterMatchMode,f.filterLocale)},oe=function(){if(!M.current){M.current=m.createInlineStyle(v&&v.nonce||t.nonce);var e="\n@media screen and (max-width: ".concat(f.breakpoint,") {\n    .p-picklist[").concat(F,"] {\n        flex-direction: column;\n    }\n\n    .p-picklist[").concat(F,"] .p-picklist-buttons {\n        padding: var(--content-padding);\n        flex-direction: row;\n    }\n\n    .p-picklist[").concat(F,"] .p-picklist-buttons .p-button {\n        margin-right: var(--inline-spacing);\n        margin-bottom: 0;\n    }\n\n    .p-picklist[").concat(F,"] .p-picklist-buttons .p-button:last-child {\n        margin-right: 0;\n    }\n}\n");M.current.innerHTML=e}};e.useImperativeHandle(s,(function(){return{props:f,getElement:function(){return P.current}}})),l((function(){!F&&L(p())})),i((function(){return F&&(P.current.setAttribute(F,""),oe()),function(){M.current=m.removeInlineStyle(M.current)}}),[F,f.breakpoint]),i((function(){j.current&&(q(j.current,B.current),j.current=null,B.current=null)}));var le=a("p-picklist p-component",f.className),ie=f.sourceItemTemplate?f.sourceItemTemplate:f.itemTemplate,ae=f.targetItemTemplate?f.targetItemTemplate:f.itemTemplate,ce=ee(f.source,"source"),ue=ee(f.target,"target"),se=c({id:f.id,ref:P,className:le,style:f.style},x.getOtherProps(f),A("root"));return e.createElement("div",se,f.showSourceControls&&e.createElement(R,{list:f.source,selection:V,onReorder:function(e){z(e,e.value,f.target),j.current=O.current.listElementRef.current,B.current=e.direction},className:"p-picklist-source-controls",dataKey:f.dataKey,moveUpIcon:f.moveUpIcon,moveTopIcon:f.moveTopIcon,moveDownIcon:f.moveDownIcon,moveBottomIcon:f.moveBottomIcon,ptm:A}),e.createElement(X,{ref:O,type:"source",list:ce,selection:V,onSelectionChange:function(e){return Q(e,"sourceSelection",f.onSourceSelectionChange)},itemTemplate:ie,header:f.sourceHeader,style:f.sourceStyle,className:"p-picklist-source-wrapper",listClassName:"p-picklist-source",metaKeySelection:f.metaKeySelection,tabIndex:f.tabIndex,dataKey:f.dataKey,filterValue:J,onFilter:Z,showFilter:Y,placeholder:f.sourceFilterPlaceholder,filterTemplate:f.sourceFilterTemplate,sourceFilterIcon:f.sourceFilterIcon,ptm:A}),e.createElement(_,{onTransfer:function(e){var t=e.originalEvent,n=e.source,r=e.target,o=[];switch(e.direction){case"toTarget":o=V,f.onMoveToTarget&&f.onMoveToTarget({originalEvent:t,value:o});break;case"allToTarget":o=f.source,f.onMoveAllToTarget&&f.onMoveAllToTarget({originalEvent:t,value:o}),o=[];break;case"toSource":o=H,f.onMoveToSource&&f.onMoveToSource({originalEvent:t,value:o});break;case"allToSource":o=f.target,f.onMoveAllToSource&&f.onMoveAllToSource({originalEvent:t,value:o}),o=[]}Q({originalEvent:t,value:o},"sourceSelection",f.onSourceSelectionChange),Q({originalEvent:t,value:o},"targetSelection",f.onTargetSelectionChange),z(e,n,r)},source:f.source,visibleSourceList:ce,target:f.target,breakpoint:f.breakpoint,visibleTargetList:ue,sourceSelection:V,targetSelection:H,dataKey:f.dataKey,moveToTargetIcon:f.moveToTargetIcon,moveAllToTargetIcon:f.moveAllToTargetIcon,moveToSourceIcon:f.moveToSourceIcon,moveAllToSourceIcon:f.moveAllToSourceIcon,ptm:A}),e.createElement(X,{ref:D,type:"target",list:ue,selection:H,onSelectionChange:function(e){return Q(e,"targetSelection",f.onTargetSelectionChange)},itemTemplate:ae,header:f.targetHeader,style:f.targetStyle,className:"p-picklist-target-wrapper",listClassName:"p-picklist-target",metaKeySelection:f.metaKeySelection,tabIndex:f.tabIndex,dataKey:f.dataKey,filterValue:U,onFilter:Z,showFilter:$,placeholder:f.targetFilterPlaceholder,filterTemplate:f.targetFilterTemplate,targetFilterIcon:f.targetFilterIcon,ptm:A}),f.showTargetControls&&e.createElement(R,{list:f.target,selection:H,onReorder:function(e){z(e,f.source,e.value),j.current=D.current.listElementRef.current,B.current=e.direction},className:"p-picklist-target-controls",dataKey:f.dataKey,moveUpIcon:f.moveUpIcon,moveTopIcon:f.moveTopIcon,moveDownIcon:f.moveDownIcon,moveBottomIcon:f.moveBottomIcon,ptm:A}))})));W.displayName="PickList";export{W as PickList};
